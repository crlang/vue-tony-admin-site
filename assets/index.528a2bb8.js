var he=Object.defineProperty,ye=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var ne=(e,s,l)=>s in e?he(e,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[s]=l,$=(e,s)=>{for(var l in s||(s={}))Ce.call(s,l)&&ne(e,l,s[l]);if(oe)for(var l of oe(s))ve.call(s,l)&&ne(e,l,s[l]);return e},A=(e,s)=>ye(e,be(s));var U=(e,s,l)=>new Promise((u,d)=>{var i=t=>{try{n(l.next(t))}catch(r){d(r)}},a=t=>{try{n(l.throw(t))}catch(r){d(r)}},n=t=>t.done?u(t.value):Promise.resolve(t.value).then(i,a);n((l=l.apply(e,s)).next())});import{C as le,d as W,bc as $e,D as te,bf as ke,c as B,dB as Me,o as y,f as H,g as V,I as C,n as M,b as o,t as J,h as _,i as m,j as T,K as we,$ as Be,k as S,J as se,bJ as _e,dC as Te,a9 as Fe,a4 as Ee,F as He,r as v,M as Re,dD as De,s as ae,v as Ve,bY as Se,bZ as Ie,bd as re,as as Pe,b_ as Ae,L as Oe,bS as Le,_ as X,e as E,am as Y,m as G,bG as je,bH as qe,aA as x,w as ie,R as L,bT as ze,y as We,U as ee,cA as Ne,l as Ue,aB as z,q as de,cC as Z,ab as Ke,cD as Je,bl as K,az as Ye,aC as Ge}from"./index.b263d89e.js";import{c as Ze}from"./index.1c7c0cd7.js";import{B as Qe}from"./index.b8d50620.js";import{E as Xe}from"./index.ee4e75a5.js";import{u as xe}from"./useWindowSizeFn.159736d7.js";import{S as eo}from"./index.b816e23f.js";import{E as oo}from"./index.53cddd5b.js";import{c as no,e as to,b as lo,f as so}from"./drawer.95bcb9ff.js";import{c as ao}from"./refs.63e616a9.js";import{u as ro}from"./use-dialog.adf6f7df.js";import{i as io}from"./isEqual.2e3b6ef4.js";const ce=Symbol("dialogInjectionKey"),co=["aria-label"],uo=["id"],fo={name:"ElDialogContent"},po=W(A($({},fo),{props:no,emits:to,setup(e){const s=e,{t:l}=$e(),{Close:u}=Te,{dialogRef:d,headerRef:i,bodyId:a,ns:n,style:t}=te(ce),{focusTrapRef:r}=te(ke),g=ao(r,d),f=B(()=>s.draggable);return Me(d,i,f),(p,k)=>(y(),H("div",{ref:o(g),class:M([o(n).b(),o(n).is("fullscreen",p.fullscreen),o(n).is("draggable",o(f)),{[o(n).m("center")]:p.center},p.customClass]),style:se(o(t)),tabindex:"-1",onClick:k[1]||(k[1]=_e(()=>{},["stop"]))},[V("header",{ref_key:"headerRef",ref:i,class:M(o(n).e("header"))},[C(p.$slots,"header",{},()=>[V("span",{role:"heading",class:M(o(n).e("title"))},J(p.title),3)]),p.showClose?(y(),H("button",{key:0,"aria-label":o(l)("el.dialog.close"),class:M(o(n).e("headerbtn")),type:"button",onClick:k[0]||(k[0]=R=>p.$emit("close"))},[_(o(Be),{class:M(o(n).e("close"))},{default:m(()=>[(y(),T(we(p.closeIcon||o(u))))]),_:1},8,["class"])],10,co)):S("v-if",!0)],2),V("div",{id:o(a),class:M(o(n).e("body"))},[C(p.$slots,"default")],10,uo),p.$slots.footer?(y(),H("footer",{key:0,class:M(o(n).e("footer"))},[C(p.$slots,"footer")],2)):S("v-if",!0)],6))}}));var mo=le(po,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const go=["aria-label","aria-labelledby","aria-describedby"],ho={name:"ElDialog"},yo=W(A($({},ho),{props:lo,emits:so,setup(e,{expose:s}){const l=e,u=Fe();Ee({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},B(()=>!!u.title));const d=He("dialog"),i=v(),a=v(),n=v(),{visible:t,titleId:r,bodyId:g,style:f,rendered:p,zIndex:k,afterEnter:R,afterLeave:F,beforeLeave:j,handleClose:I,onModalClick:c,onOpenAutoFocus:h,onCloseAutoFocus:w,onCloseRequested:N}=ro(l,i);Re(ce,{dialogRef:i,headerRef:a,bodyId:g,ns:d,rendered:p,style:f});const D=De(c),ge=B(()=>l.draggable&&!l.fullscreen);return s({visible:t,dialogContentRef:n}),(b,P)=>(y(),T(Ae,{to:"body",disabled:!b.appendToBody},[_(Pe,{name:"dialog-fade",onAfterEnter:o(R),onAfterLeave:o(F),onBeforeLeave:o(j),persisted:""},{default:m(()=>[ae(_(o(Se),{"custom-mask-event":"",mask:b.modal,"overlay-class":b.modalClass,"z-index":o(k)},{default:m(()=>[V("div",{role:"dialog","aria-modal":"true","aria-label":b.title||void 0,"aria-labelledby":b.title?void 0:o(r),"aria-describedby":o(g),class:M(`${o(d).namespace.value}-overlay-dialog`),onClick:P[0]||(P[0]=(...q)=>o(D).onClick&&o(D).onClick(...q)),onMousedown:P[1]||(P[1]=(...q)=>o(D).onMousedown&&o(D).onMousedown(...q)),onMouseup:P[2]||(P[2]=(...q)=>o(D).onMouseup&&o(D).onMouseup(...q))},[_(o(Ie),{loop:"",trapped:o(t),"focus-start-el":"container",onFocusAfterTrapped:o(h),onFocusAfterReleased:o(w),onReleaseRequested:o(N)},{default:m(()=>[o(p)?(y(),T(mo,{key:0,ref_key:"dialogContentRef",ref:n,"custom-class":b.customClass,center:b.center,"close-icon":b.closeIcon,draggable:o(ge),fullscreen:b.fullscreen,"show-close":b.showClose,title:b.title,onClose:o(I)},re({header:m(()=>[b.$slots.title?C(b.$slots,"title",{key:1}):C(b.$slots,"header",{key:0,close:o(I),titleId:o(r),titleClass:o(d).e("title")})]),default:m(()=>[C(b.$slots,"default")]),_:2},[b.$slots.footer?{name:"footer",fn:m(()=>[C(b.$slots,"footer")])}:void 0]),1032,["custom-class","center","close-icon","draggable","fullscreen","show-close","title","onClose"])):S("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onReleaseRequested"])],42,go)]),_:3},8,["mask","overlay-class","z-index"]),[[Ve,o(t)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}}));var bo=le(yo,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const Co=Oe(bo),ue={showClose:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},helpMessage:{type:[String,Array],default:""}},fe={dyncHeight:{type:Boolean,default:!0},loading:Boolean,loadingText:{type:String,default:"\u52A0\u8F7D\u4E2D..."}},vo={showConfirmBtn:{type:Boolean,default:!0},confirmOptions:{type:Object,default:{btnText:"\u786E\u5B9A",type:"primary"}},showCancelBtn:{type:Boolean,default:!0},cancelOptions:{type:Object,default:{btnText:"\u53D6\u6D88",type:"default"}}},pe=A($($($({modelValue:Boolean},ue),fe),vo),{showFooter:{type:Boolean,default:!0},scrollTop:{type:Boolean,default:!0},closeFn:Function}),$o=A($($({},Ze),pe),{appendToBody:{type:Boolean,default:!0},onOpen:Function,onOpened:Function,onClose:Function,onClosed:Function}),ko=W({name:"BasicModalHeader",components:{ElTooltip:Xe,BasicTitle:Qe,SvgIcon:Le},inheritAttrs:!1,props:$({fullscreen:Boolean,prefixCls:String,title:String},ue),emits:["cancel","fullscreen"],setup(e,{emit:s}){function l(i){!e.showFullscreen||(i.stopPropagation(),d(i))}function u(i){s("cancel",i)}function d(i){i==null||i.stopPropagation(),i==null||i.preventDefault(),s("fullscreen")}return{handleCancel:u,handleFullscreen:d,handleTitleDbClick:l}}});function Mo(e,s,l,u,d,i){const a=E("BasicTitle"),n=E("SvgIcon"),t=E("ElTooltip");return y(),H("div",{class:M(e.prefixCls),onDblclick:s[0]||(s[0]=(...r)=>e.handleTitleDbClick&&e.handleTitleDbClick(...r))},[_(a,{helpMessage:e.helpMessage},{default:m(()=>[e.title?(y(),H(Y,{key:0},[G(J(e.title),1)],64)):C(e.$slots,"header",{key:1})]),_:3},8,["helpMessage"]),V("div",{class:M(`${e.prefixCls}__extra`)},[e.showFullscreen?(y(),H(Y,{key:0},[e.fullscreen?(y(),T(t,{key:0,content:"\u8FD8\u539F",placement:"bottom"},{default:m(()=>[_(n,{onClick:e.handleFullscreen,name:"fullscreen-exit"},null,8,["onClick"])]),_:1})):(y(),T(t,{key:1,content:"\u6700\u5927\u5316",placement:"bottom"},{default:m(()=>[_(n,{onClick:e.handleFullscreen,name:"fullscreen"},null,8,["onClick"])]),_:1}))],64)):S("",!0),e.showClose?(y(),T(t,{key:1,content:"\u5173\u95ED",placement:"bottom"},{default:m(()=>[_(n,{onClick:e.handleCancel,name:"close"},null,8,["onClick"])]),_:1})):S("",!0)],2)],34)}var wo=X(ko,[["render",Mo]]);const me=Symbol();function Bo(e){return je(e,me)}function Ko(){return qe(me)}const _o=W({name:"ModalWrapper",components:{ScrollContainer:eo},directives:{loading:oo.directive},inheritAttrs:!1,props:$({modelValue:Boolean,fullscreen:Boolean,prefixCls:String},fe),emits:["height-change"],setup(e,{emit:s}){const l=v(null),u=v(null),d=v(null),i=v(0),a=B(()=>{const{dyncHeight:r}=e;return r?{height:`${o(i)}px`}:{height:"auto",padding:"1rem"}});function n(){return U(this,null,function*(){L(()=>{var g;const r=o(l);!r||(g=r==null?void 0:r.scrollTo)==null||g.call(r,0)})})}function t(){return U(this,null,function*(){var k,R;if(!e.modelValue||!e.dyncHeight)return;const r=o(u);if(!r)return;yield L();const g=r.parentElement;if(!g)return;const f=o(d);if(!f)return;const p=(f==null?void 0:f.clientHeight)||0;yield L();try{const F=g.parentElement;if(!F)return;const j=((k=F.querySelector(".el-dialog__header"))==null?void 0:k.clientHeight)||0,I=((R=F.querySelector(".el-dialog__footer"))==null?void 0:R.clientHeight)||0,c=F.offsetTop;let h=window.innerHeight-c*2-I-j;p<h&&(h=p),i.value=h>100?h:100,s("height-change",o(i))}catch(F){}})}return xe(t.bind(null,!1)),Bo({redoModalHeight:t}),x(()=>{e.dyncHeight&&t()}),ie(()=>e.fullscreen,()=>{t()}),{wrapperRef:l,spinRef:u,innerRef:d,spinStyle:a,scrollTop:n,setModalHeight:t}}}),To=["element-loading-text"],Fo={ref:"innerRef"};function Eo(e,s,l,u,d,i){const a=E("ScrollContainer"),n=ze("loading");return ae((y(),H("div",{ref:"spinRef",style:se(e.spinStyle),"element-loading-text":e.loadingText},[e.dyncHeight?(y(),T(a,{key:0,ref:"wrapperRef",class:M(e.prefixCls)},{default:m(()=>[V("div",Fo,[C(e.$slots,"default")],512)]),_:3},8,["class"])):C(e.$slots,"default",{key:1})],12,To)),[[n,e.loading]])}var Ho=X(_o,[["render",Eo]]);const Ro=W({name:"BasicModal",components:{ElDialog:Co,ElButton:We,ModalWrapper:Ho,ModalHeader:wo},inheritAttrs:!1,props:$o,emits:["visible-change","height-change","cancel","confirm","register","update:modelValue"],setup(e,{emit:s}){const l=v(!1),u=v(null),d=v(null),{prefixCls:i}=Ue("basic-modal"),a=v(!1),n={setModalProps:k,emitVisible:void 0,redoModalHeight:()=>{L(()=>{o(d)&&o(d).setModalHeight()})}},t=ee();t&&s("register",n,t.uid);const r=B(()=>$($({},e),o(u))),g=B(()=>{const c=A($({},o(r)),{fullscreen:o(a)});c.customClass=`${i} ${(c==null?void 0:c.customClass)||""} ${i}-${t==null?void 0:t.uid}`;const h=Object.keys(pe);return Ne(c,h)}),f=B(()=>{const{showFullscreen:c,showClose:h,helpMessage:w,title:N}=o(r);return{title:N,showFullscreen:c,showClose:h,helpMessage:w,fullscreen:o(a),prefixCls:`${i}-header`}}),p=B(()=>{const{dyncHeight:c,loading:h,loadingText:w}=o(r);return{dyncHeight:c,loading:h,loadingText:w,fullscreen:o(a),modelValue:o(l),prefixCls:`${i}__body`}});function k(c){u.value=$($({},o(u)),c),Reflect.has(c,"modelValue")&&(l.value=!!c.modelValue),Reflect.has(c,"fullscreen")&&(a.value=!!c.fullscreen)}function R(c){return U(this,null,function*(){c==null||c.stopPropagation();const{closeFn:h}=o(r);if(typeof h=="function"){const w=yield h();l.value=!w;return}else l.value=!1;s("cancel",c)})}function F(c){s("confirm",c)}function j(c){s("height-change",c)}function I(){k({fullscreen:!o(a)})}return x(()=>{l.value=!!e.modelValue,a.value=!!e.fullscreen}),ie(()=>o(l),c=>{var h;s("visible-change",c),s("update:modelValue",c),t&&((h=n.emitVisible)==null||h.call(n,c,t.uid)),L(()=>{var w;(e==null?void 0:e.scrollTop)&&c&&o(d)&&((w=o(d))==null||w.scrollTop(0))})},{immediate:!1}),{prefixCls:i,getBindValues:g,getHeaderBindValues:f,getWrapperBindValue:p,visibleRef:l,fullscreenRef:a,getProps:r,modalWrapperRef:d,handleFullscreen:I,handleCancel:R,handleConfirm:F,handleHeightChange:j}}});function Do(e,s,l,u,d,i){const a=E("ModalHeader"),n=E("ModalWrapper"),t=E("ElButton"),r=E("ElDialog");return y(),T(r,z(e.getBindValues,{showClose:!1,modelValue:e.visibleRef,"onUpdate:modelValue":s[0]||(s[0]=g=>e.visibleRef=g)}),re({header:m(()=>[_(a,z(e.getHeaderBindValues,{onFullscreen:e.handleFullscreen,onCancel:e.handleCancel}),{header:m(()=>[C(e.$slots,"header")]),_:3},16,["onFullscreen","onCancel"])]),default:m(()=>[_(n,z({ref:"modalWrapperRef"},e.getWrapperBindValue,{onHeightChange:e.handleHeightChange}),{default:m(()=>[C(e.$slots,"default")]),_:3},16,["onHeightChange"])]),_:2},[e.showFooter?{name:"footer",fn:m(()=>{var g;return[V("div",{class:M(`${e.prefixCls}-footer`)},[e.$slots.footer?C(e.$slots,"footer",{key:0}):(y(),H(Y,{key:1},[C(e.$slots,"prependFooter"),e.showCancelBtn?(y(),T(t,z({key:0},e.cancelOptions,{onClick:e.handleCancel}),{default:m(()=>{var f;return[G(J(((f=e.cancelOptions)==null?void 0:f.btnText)||"Cancel"),1)]}),_:1},16,["onClick"])):S("",!0),C(e.$slots,"centerFooter"),e.showConfirmBtn?(y(),T(t,z({key:1},e.confirmOptions,{loading:(g=e.getProps.confirmOptions)==null?void 0:g.loading,onClick:e.handleConfirm}),{default:m(()=>{var f;return[G(J(((f=e.confirmOptions)==null?void 0:f.btnText)||"OK"),1)]}),_:1},16,["loading","onClick"])):S("",!0),C(e.$slots,"appendFooter")],64))],2)]})}:void 0]),1040,["modelValue"])}var Vo=X(Ro,[["render",Do]]);const O=de({}),Q=de({});function Jo(){const e=v(null),s=v(!1),l=v("");function u(a,n){ee()||Z("useModal() can only be used inside setup() or functional components!"),l.value=n,Ke(()=>{e.value=null,s.value=!1,O[o(l)]=null}),!(o(s)&&Je()&&a===o(e))&&(e.value=a,s.value=!0,a.emitVisible=(t,r)=>{Q[r]=t})}const d=()=>{const a=o(e);return a||Z("The modal instance has not been obtained, please make sure the instance is rendered when performing the instance operation!"),a},i={setModalProps:a=>{var n;(n=d())==null||n.setModalProps(a)},getVisible:B(()=>Q[~~o(l)]),redoModalHeight:()=>{var a,n;(n=(a=d())==null?void 0:a.redoModalHeight)==null||n.call(a)},openModal:(a=!0,n,t=!0)=>{var f;if((f=d())==null||f.setModalProps({modelValue:a}),!n)return;const r=o(l);if(t){O[r]=null,O[r]=K(n);return}io(K(O[r]),K(n))||(O[r]=K(n))},closeModal:()=>{var a;(a=d())==null||a.setModalProps({modelValue:!1})}};return[u,i]}const Yo=e=>{const s=v(null),l=ee(),u=v(""),d=()=>{const n=o(s);return n||Z("useModalInner instance is undefined!"),n},i=(n,t)=>{Ye(()=>{s.value=null}),u.value=t,s.value=n,l==null||l.emit("register",n,t)},a={changeLoading:(n=!0)=>{var t;(t=d())==null||t.setModalProps({loading:n})},getVisible:B(()=>Q[~~o(u)]),changeConfirmLoading:(n=!0)=>{var t;(t=d())==null||t.setModalProps({confirmButton:{loading:n}})},closeModal:()=>{var n;(n=d())==null||n.setModalProps({modelValue:!1})},setModalProps:n=>{var t;(t=d())==null||t.setModalProps(n)},redoModalHeight:()=>{var t;const n=(t=d())==null?void 0:t.redoModalHeight;n&&n()}};return x(()=>{const n=O[o(u)];!n||!e||typeof e!="function"||L(()=>{e(n)})}),[i,a]},Go=Ge(Vo);export{Go as B,Jo as a,Yo as b,Ko as u};
