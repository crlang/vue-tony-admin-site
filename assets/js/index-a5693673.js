var H=(n,t,p)=>new Promise((a,v)=>{var l=d=>{try{s(p.next(d))}catch(g){v(g)}},h=d=>{try{s(p.throw(d))}catch(g){v(g)}},s=d=>d.done?a(d.value):Promise.resolve(d.value).then(l,h);s((p=p.apply(n,t)).next())});import{y as U,z as k,A as M,K as i,R as f,u as e,Q as S,a as w,ab as P,x as Q,U as G,l as K,b as X,G as Z,H as V,I as F,L as m,J as O,F as Y,a3 as ee,X as ne,O as te,T as se,a1 as oe,Z as L}from"./ex-pkg-@vue-6f720869.js";import{e as R,I as j,j as ae,aS as le,D as re,u as ce,_ as ie}from"./index-94a7e7e0.js";import{g as ue,d as pe,C as de}from"./index-49301f6d.js";import{u as fe}from"./index-874009eb.js";import{cx as me,cq as he,dm as D,cU as W}from"./ex-pkg-vendor-69b4619e.js";import{G as ve,P as _e}from"./ex-pkg-element-plus-6a2cfc13.js";import"./ex-pkg-mockjs-abb76a9d.js";import"./index-b0a821ec.js";import"./useWindowSizeFn-414339e6.js";import"./propTypes-fbd6d81b.js";import"./useTimeout-dc9cc03d.js";import"./index-230bee16.js";import"./tsxHelper-f8a518c2.js";import"./lock-71d293c1.js";import"./index-55f6df6d.js";const ge=U({setup(n){const{t}=R();return(p,a)=>(k(),M("div",null,[i("div",null,[i("span",null,[f(e(j),{icon:"uil:enter"})]),i("span",null,S(e(t)("component.app.toSearch")),1)]),i("div",null,[i("span",null,[f(e(j),{icon:"ion:arrow-up-outline"})]),i("span",null,[f(e(j),{icon:"ion:arrow-down-outline"})]),i("span",null,S(e(t)("component.app.toNavigate")),1)]),i("div",null,[i("span",null,[f(e(j),{icon:"mdi:keyboard-esc"})]),i("span",null,S(e(t)("common.closeText")),1)])]))}});function xe(){const n=w([]);return P(()=>{n.value=[]}),[n,p=>a=>{n.value[p]=a}]}function we(n){return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(n)?`\\${n}`:n}function $e(n){const t=[...n].map(a=>we(a)),p=["",...t,""].join(".*");return new RegExp(p)}function ke(n,t,p){const a=w([]),v=w(""),l=w(-1);let h=[];const{t:s}=R(),d=ae(),g=me(B,200);Q(()=>H(this,null,function*(){const r=yield ue();h=he(r),le(h,c=>{c.name=s(c.name)})}));function B(r){if(v.value=r.trim(),!r){a.value=[];return}const c=$e(e(v)),u=re(h,o=>c.test(o.name)&&!o.hideMenu);a.value=E(u,c),l.value=0}function E(r,c,u){const o=[];return r.forEach(_=>{const{name:x,path:$,icon:q,children:b,hideMenu:J,meta:y}=_;!J&&c.test(x)&&(!(b==null?void 0:b.length)||(y==null?void 0:y.hideChildrenInMenu))&&o.push({name:(u==null?void 0:u.name)?`${u.name} > ${x}`:x,path:$,icon:q}),!(y==null?void 0:y.hideChildrenInMenu)&&Array.isArray(b)&&b.length&&o.push(...E(b,c,_))}),o}function C(r){const c=r.target.dataset.index;l.value=Number(c)}function N(){!a.value.length||(l.value--,l.value<0&&(l.value=a.value.length-1),T())}function z(){!a.value.length||(l.value++,l.value>a.value.length-1&&(l.value=0),T())}function T(){const r=e(n);if(!r||!Array.isArray(r)||r.length===0||!e(t))return;const c=e(l),u=r[c];if(!u)return;const o=e(t);if(!o)return;const _=u.offsetTop+u.offsetHeight,x=o.offsetHeight,{start:$}=fe({el:o,duration:100,to:_-x});$()}function I(){return H(this,null,function*(){if(!a.value.length)return;const r=e(a),c=e(l);if(r.length===0||c<0)return;const u=r[c];A(),yield G(),d(u.path)})}function A(){a.value=[],p("close")}return D("Enter",I),D("ArrowUp",N),D("ArrowDown",z),D("Escape",A),{handleSearch:g,searchResult:a,keyword:v,activeIndex:l,handleMouseenter:C,handleEnter:I}}const be=["data-index"],ye=U({props:{visible:{type:Boolean}},emits:["close"],setup(n,{emit:t}){const p=n,a=w(null),v=w(null),l=w(""),{t:h}=R(),{prefixCls:s}=ce("header-search-modal"),[d,g]=xe(),{getIsMobile:B}=pe(),{handleSearch:E,searchResult:C,keyword:N,activeIndex:z,handleEnter:T,handleMouseenter:I}=ke(d,a,t),A=K(()=>!N||e(C).length===0),r=K(()=>[s,{[`${s}--mobile`]:e(B)}]);X(()=>p.visible,u=>{u&&G(()=>{var o;l.value="",(o=e(v))==null||o.focus()})});function c(){C.value=[],t("close")}return(u,o)=>(k(),Z(oe,{to:"body"},[f(se,{name:"zoom-fade",mode:"out-in"},{default:V(()=>[n.visible?(k(),M("div",{key:0,class:m(e(r)),onClick:o[3]||(o[3]=ne(()=>{},["stop"]))},[F((k(),M("div",{class:m(`${e(s)}-content`)},[i("div",{class:m(`${e(s)}-input__wrapper`)},[f(e(ve),{class:m(`${e(s)}-input`),placeholder:e(h)("common.searchText"),ref_key:"inputRef",ref:v,clearable:"",modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=_=>l.value=_),onInput:e(E)},{prefix:V(()=>[f(e(W))]),_:1},8,["class","placeholder","modelValue","onInput"]),i("span",{class:m(`${e(s)}-cancel`),onClick:c},S(e(h)("common.cancelText")),3)],2),F(i("div",{class:m(`${e(s)}-nodata`)},S(e(h)("component.app.searchNotData")),3),[[O,e(A)]]),F(i("ul",{class:m(`${e(s)}-list`),ref_key:"scrollWrap",ref:a},[(k(!0),M(Y,null,ee(e(C),(_,x)=>(k(),M("li",{ref_for:!0,ref:e(g)(x),key:_.path,"data-index":x,onMouseenter:o[1]||(o[1]=(...$)=>e(I)&&e(I)(...$)),onClick:o[2]||(o[2]=(...$)=>e(T)&&e(T)(...$)),class:m([`${e(s)}-list__item`,{[`${e(s)}-list__item--active`]:e(z)===x}])},[i("div",{class:m(`${e(s)}-list__item-icon`)},[f(e(j),{icon:_.icon||"mdi:form-select",size:20},null,8,["icon"])],2),i("div",{class:m(`${e(s)}-list__item-text`)},S(_.name),3),i("div",{class:m(`${e(s)}-list__item-enter`)},[f(e(j),{icon:"uil:enter",size:20})],2)],42,be))),128))],2),[[O,!e(A)]]),f(ge,{class:m(`${e(s)}-footer`)},null,8,["class"])],2)),[[e(de),c]])],2)):te("",!0)]),_:1})]))}}),Me=U({name:"AppSearch",components:{ElTooltip:_e,AppSearchModal:ye,Search:W},setup(){const n=w(!1),{t}=R();return{t,showModal:n}}});function Se(n,t,p,a,v,l){const h=L("Search"),s=L("ElTooltip"),d=L("AppSearchModal");return k(),M("div",{onClick:t[1]||(t[1]=g=>n.showModal=!0)},[f(s,{effect:"dark",content:n.t("common.searchText"),placement:"bottom-end"},{default:V(()=>[i("span",null,[f(h)])]),_:1},8,["content"]),f(d,{onClose:t[0]||(t[0]=g=>n.showModal=!1),visible:n.showModal},null,8,["visible"])])}var Ge=ie(Me,[["render",Se]]);export{Ge as default};
