var H=(n,t,p)=>new Promise((a,v)=>{var l=d=>{try{s(p.next(d))}catch(g){v(g)}},h=d=>{try{s(p.throw(d))}catch(g){v(g)}},s=d=>d.done?a(d.value):Promise.resolve(d.value).then(l,h);s((p=p.apply(n,t)).next())});import{y as V,z as k,A as M,K as c,R as f,u as e,Q as S,a as w,ab as X,x as Z,U as G,l as K,b as q,G as P,H as F,I as U,L as m,J as O,F as Y,a3 as ee,X as ne,O as te,T as se,a1 as oe,Z as L}from"./ex-pkg-@vue-6f720869.js";import{e as R,I as j,j as ae,aT as le,D as re,u as ie,_ as ce}from"./index-034694ef.js";import{g as ue,d as pe,C as de}from"./index-5be1deb6.js";import{u as fe}from"./index-d0007c65.js";import{cN as me,cG as he,dF as D,d9 as W}from"./ex-pkg-vendor-a94c680b.js";import{C as ve,M as _e}from"./ex-pkg-element-plus-fdfdae45.js";import"./ex-pkg-mockjs-2c72399a.js";import"./index-a6c2e2aa.js";import"./useWindowSizeFn-f8d8829f.js";import"./propTypes-7bd4f998.js";import"./useTimeout-deb974d8.js";import"./index-4566a42e.js";import"./tsxHelper-97245be0.js";import"./lock-e97ff012.js";import"./index-c7b8aefc.js";const ge=V({setup(n){const{t}=R();return(p,a)=>(k(),M("div",null,[c("div",null,[c("span",null,[f(e(j),{icon:"uil:enter"})]),c("span",null,S(e(t)("component.app.toSearch")),1)]),c("div",null,[c("span",null,[f(e(j),{icon:"ion:arrow-up-outline"})]),c("span",null,[f(e(j),{icon:"ion:arrow-down-outline"})]),c("span",null,S(e(t)("component.app.toNavigate")),1)]),c("div",null,[c("span",null,[f(e(j),{icon:"mdi:keyboard-esc"})]),c("span",null,S(e(t)("common.closeText")),1)])]))}});function xe(){const n=w([]);return X(()=>{n.value=[]}),[n,p=>a=>{n.value[p]=a}]}function we(n){return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(n)?`\\${n}`:n}function $e(n){const t=[...n].map(a=>we(a)),p=["",...t,""].join(".*");return new RegExp(p)}function ke(n,t,p){const a=w([]),v=w(""),l=w(-1);let h=[];const{t:s}=R(),d=ae(),g=me(N,200);Z(()=>H(this,null,function*(){const r=yield ue();h=he(r),le(h,i=>{i.name=s(i.name)})}));function N(r){if(v.value=r.trim(),!r){a.value=[];return}const i=$e(e(v)),u=re(h,o=>i.test(o.name)&&!o.hideMenu);a.value=E(u,i),l.value=0}function E(r,i,u){const o=[];return r.forEach(_=>{const{name:x,path:$,icon:J,children:b,hideMenu:Q,meta:y}=_;!Q&&i.test(x)&&(!(b==null?void 0:b.length)||(y==null?void 0:y.hideChildrenInMenu))&&o.push({name:(u==null?void 0:u.name)?`${u.name} > ${x}`:x,path:$,icon:J}),!(y==null?void 0:y.hideChildrenInMenu)&&Array.isArray(b)&&b.length&&o.push(...E(b,i,_))}),o}function C(r){const i=r.target.dataset.index;l.value=Number(i)}function B(){!a.value.length||(l.value--,l.value<0&&(l.value=a.value.length-1),T())}function z(){!a.value.length||(l.value++,l.value>a.value.length-1&&(l.value=0),T())}function T(){const r=e(n);if(!r||!Array.isArray(r)||r.length===0||!e(t))return;const i=e(l),u=r[i];if(!u)return;const o=e(t);if(!o)return;const _=u.offsetTop+u.offsetHeight,x=o.offsetHeight,{start:$}=fe({el:o,duration:100,to:_-x});$()}function I(){return H(this,null,function*(){if(!a.value.length)return;const r=e(a),i=e(l);if(r.length===0||i<0)return;const u=r[i];A(),yield G(),d(u.path)})}function A(){a.value=[],p("close")}return D("Enter",I),D("ArrowUp",B),D("ArrowDown",z),D("Escape",A),{handleSearch:g,searchResult:a,keyword:v,activeIndex:l,handleMouseenter:C,handleEnter:I}}const be=["data-index"],ye=V({props:{visible:{type:Boolean}},emits:["close"],setup(n,{emit:t}){const p=n,a=w(null),v=w(null),l=w(""),{t:h}=R(),{prefixCls:s}=ie("header-search-modal"),[d,g]=xe(),{getIsMobile:N}=pe(),{handleSearch:E,searchResult:C,keyword:B,activeIndex:z,handleEnter:T,handleMouseenter:I}=ke(d,a,t),A=K(()=>!B||e(C).length===0),r=K(()=>[s,{[`${s}--mobile`]:e(N)}]);q(()=>p.visible,u=>{u&&G(()=>{var o;l.value="",(o=e(v))==null||o.focus()})});function i(){C.value=[],t("close")}return(u,o)=>(k(),P(oe,{to:"body"},[f(se,{name:"zoom-fade",mode:"out-in"},{default:F(()=>[n.visible?(k(),M("div",{key:0,class:m(e(r)),onClick:o[3]||(o[3]=ne(()=>{},["stop"]))},[U((k(),M("div",{class:m(`${e(s)}-content`)},[c("div",{class:m(`${e(s)}-input__wrapper`)},[f(e(ve),{class:m(`${e(s)}-input`),placeholder:e(h)("common.searchText"),ref_key:"inputRef",ref:v,clearable:"",modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=_=>l.value=_),onInput:e(E)},{prefix:F(()=>[f(e(W))]),_:1},8,["class","placeholder","modelValue","onInput"]),c("span",{class:m(`${e(s)}-cancel`),onClick:i},S(e(h)("common.cancelText")),3)],2),U(c("div",{class:m(`${e(s)}-nodata`)},S(e(h)("component.app.searchNotData")),3),[[O,e(A)]]),U(c("ul",{class:m(`${e(s)}-list`),ref_key:"scrollWrap",ref:a},[(k(!0),M(Y,null,ee(e(C),(_,x)=>(k(),M("li",{ref_for:!0,ref:e(g)(x),key:_.path,"data-index":x,onMouseenter:o[1]||(o[1]=(...$)=>e(I)&&e(I)(...$)),onClick:o[2]||(o[2]=(...$)=>e(T)&&e(T)(...$)),class:m([`${e(s)}-list__item`,{[`${e(s)}-list__item--active`]:e(z)===x}])},[c("div",{class:m(`${e(s)}-list__item-icon`)},[f(e(j),{icon:_.icon||"mdi:form-select",size:20},null,8,["icon"])],2),c("div",{class:m(`${e(s)}-list__item-text`)},S(_.name),3),c("div",{class:m(`${e(s)}-list__item-enter`)},[f(e(j),{icon:"uil:enter",size:20})],2)],42,be))),128))],2),[[O,!e(A)]]),f(ge,{class:m(`${e(s)}-footer`)},null,8,["class"])],2)),[[e(de),i]])],2)):te("",!0)]),_:1})]))}}),Me=V({name:"AppSearch",components:{ElTooltip:_e,AppSearchModal:ye,Search:W},setup(){const n=w(!1),{t}=R();return{t,showModal:n}}});function Se(n,t,p,a,v,l){const h=L("Search"),s=L("ElTooltip"),d=L("AppSearchModal");return k(),M("div",{onClick:t[1]||(t[1]=g=>n.showModal=!0)},[f(s,{effect:"dark",content:n.t("common.searchText"),placement:"bottom-end"},{default:F(()=>[c("span",null,[f(h)])]),_:1},8,["content"]),f(d,{onClose:t[0]||(t[0]=g=>n.showModal=!1),visible:n.showModal},null,8,["visible"])])}var Ge=ce(Me,[["render",Se]]);export{Ge as default};
