var B=(n,i,d)=>new Promise((o,m)=>{var a=p=>{try{_(d.next(p))}catch(g){m(g)}},t=p=>{try{_(d.throw(p))}catch(g){m(g)}},_=p=>p.done?o(p.value):Promise.resolve(p.value).then(a,t);_((d=d.apply(n,i)).next())});import{y as z,z as $,A as C,K as r,R as f,u as e,a as x,ab as W,x as q,U,l as F,b as J,G as Q,H,I as V,L as h,J as K,F as X,a3 as Z,Q as P,X as Y,O as ee,T as ne,a1 as se,Z as N}from"./ex-pkg-@vue-feb543c0.js";import{I as M,e as te,y as oe,u as ae,_ as le}from"./index-26bedde3.js";import{g as re,d as ie,C as ue}from"./index-6bc13ea8.js";import{u as ce}from"./index-93f62e3c.js";import{cw as de,cq as pe,dl as I,cT as L}from"./ex-pkg-vendor-bb3f8859.js";import{A as fe,K as he}from"./ex-pkg-element-plus-f609432a.js";import"./ex-pkg-mockjs-ec7a233b.js";import"./index-e2dbd5ff.js";import"./useWindowSizeFn-3a4b39e4.js";import"./propTypes-605b60b6.js";import"./useTimeout-998fb248.js";import"./index-8ceb82bc.js";import"./tsxHelper-ab68d96a.js";import"./lock-e44984cc.js";import"./index-8a4d5146.js";const me=r("span",null,"\u786E\u8BA4",-1),ve=r("span",null,"\u5207\u6362",-1),_e=r("span",null,"\u5173\u95ED",-1),ge=z({setup(n){return(i,d)=>($(),C("div",null,[r("div",null,[r("span",null,[f(e(M),{icon:"uil:enter"})]),me]),r("div",null,[r("span",null,[f(e(M),{icon:"ion:arrow-up-outline"})]),r("span",null,[f(e(M),{icon:"ion:arrow-down-outline"})]),ve]),r("div",null,[r("span",null,[f(e(M),{icon:"mdi:keyboard-esc"})]),_e])]))}});function be(){const n=x([]);return W(()=>{n.value=[]}),[n,d=>o=>{n.value[d]=o}]}function xe(n){return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(n)?`\\${n}`:n}function we(n){const i=[...n].map(o=>xe(o)),d=["",...i,""].join(".*");return new RegExp(d)}function $e(n,i,d){const o=x([]),m=x(""),a=x(-1);let t=[];const _=te(),p=de(g,200);q(()=>B(this,null,function*(){const l=yield re();t=pe(l)}));function g(l){if(m.value=l.trim(),!l){o.value=[];return}const u=we(e(m)),c=oe(t,s=>u.test(s.name)&&!s.hideMenu);o.value=D(c,u),a.value=0}function D(l,u,c){const s=[];return l.forEach(v=>{const{name:b,path:w,icon:G,children:k,hideMenu:O,meta:y}=v;!O&&u.test(b)&&(!(k==null?void 0:k.length)||(y==null?void 0:y.hideChildrenInMenu))&&s.push({name:(c==null?void 0:c.name)?`${c.name} > ${b}`:b,path:w,icon:G}),!(y==null?void 0:y.hideChildrenInMenu)&&Array.isArray(k)&&k.length&&s.push(...D(k,u,v))}),s}function S(l){const u=l.target.dataset.index;a.value=Number(u)}function R(){!o.value.length||(a.value--,a.value<0&&(a.value=o.value.length-1),j())}function T(){!o.value.length||(a.value++,a.value>o.value.length-1&&(a.value=0),j())}function j(){const l=e(n);if(!l||!Array.isArray(l)||l.length===0||!e(i))return;const u=e(a),c=l[u];if(!c)return;const s=e(i);if(!s)return;const v=c.offsetTop+c.offsetHeight,b=s.offsetHeight,{start:w}=ce({el:s,duration:100,to:v-b});w()}function E(){return B(this,null,function*(){if(!o.value.length)return;const l=e(o),u=e(a);if(l.length===0||u<0)return;const c=l[u];A(),yield U(),_(c.path)})}function A(){o.value=[],d("close")}return I("Enter",E),I("ArrowUp",R),I("ArrowDown",T),I("Escape",A),{handleSearch:p,searchResult:o,keyword:m,activeIndex:a,handleMouseenter:S,handleEnter:E}}const ke=["data-index"],ye=z({props:{visible:{type:Boolean}},emits:["close"],setup(n,{emit:i}){const d=n,o=x(null),m=x(null),a=x(""),{prefixCls:t}=ae("header-search-modal"),[_,p]=be(),{getIsMobile:g}=ie(),{handleSearch:D,searchResult:S,keyword:R,activeIndex:T,handleEnter:j,handleMouseenter:E}=$e(_,o,i),A=F(()=>!R||e(S).length===0),l=F(()=>[t,{[`${t}--mobile`]:e(g)}]);J(()=>d.visible,c=>{c&&U(()=>{var s;a.value="",(s=e(m))==null||s.focus()})});function u(){S.value=[],i("close")}return(c,s)=>($(),Q(se,{to:"body"},[f(ne,{name:"zoom-fade",mode:"out-in"},{default:H(()=>[n.visible?($(),C("div",{key:0,class:h(e(l)),onClick:s[3]||(s[3]=Y(()=>{},["stop"]))},[V(($(),C("div",{class:h(`${e(t)}-content`)},[r("div",{class:h(`${e(t)}-input__wrapper`)},[f(e(fe),{class:h(`${e(t)}-input`),placeholder:"\u641C\u7D22",ref_key:"inputRef",ref:m,clearable:"",modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=v=>a.value=v),onInput:e(D)},{prefix:H(()=>[f(e(L))]),_:1},8,["class","modelValue","onInput"]),r("span",{class:h(`${e(t)}-cancel`),onClick:u}," \u53D6\u6D88 ",2)],2),V(r("div",{class:h(`${e(t)}-nodata`)}," \u6682\u65E0\u641C\u7D22\u7ED3\u679C ",2),[[K,e(A)]]),V(r("ul",{class:h(`${e(t)}-list`),ref_key:"scrollWrap",ref:o},[($(!0),C(X,null,Z(e(S),(v,b)=>($(),C("li",{ref_for:!0,ref:e(p)(b),key:v.path,"data-index":b,onMouseenter:s[1]||(s[1]=(...w)=>e(E)&&e(E)(...w)),onClick:s[2]||(s[2]=(...w)=>e(j)&&e(j)(...w)),class:h([`${e(t)}-list__item`,{[`${e(t)}-list__item--active`]:e(T)===b}])},[r("div",{class:h(`${e(t)}-list__item-icon`)},[f(e(M),{icon:v.icon||"mdi:form-select",size:20},null,8,["icon"])],2),r("div",{class:h(`${e(t)}-list__item-text`)},P(v.name),3),r("div",{class:h(`${e(t)}-list__item-enter`)},[f(e(M),{icon:"uil:enter",size:20})],2)],42,ke))),128))],2),[[K,!e(A)]]),f(ge,{class:h(`${e(t)}-footer`)},null,8,["class"])],2)),[[e(ue),u]])],2)):ee("",!0)]),_:1})]))}}),Ce=z({name:"AppSearch",components:{ElTooltip:he,AppSearchModal:ye,Search:L},setup(){return{showModal:x(!1)}}});function Me(n,i,d,o,m,a){const t=N("Search"),_=N("ElTooltip"),p=N("AppSearchModal");return $(),C("div",{onClick:i[1]||(i[1]=g=>n.showModal=!0)},[f(_,{effect:"dark",content:"\u641C\u7D22",placement:"bottom-end"},{default:H(()=>[r("span",null,[f(t)])]),_:1}),f(p,{onClose:i[0]||(i[0]=g=>n.showModal=!1),visible:n.showModal},null,8,["visible"])])}var Le=le(Ce,[["render",Me]]);export{Le as default};
