var L=Object.defineProperty,$=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var _=(e,t,s)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,g=(e,t)=>{for(var s in t||(t={}))D.call(t,s)&&_(e,s,t[s]);if(b)for(var s of b(t))S.call(t,s)&&_(e,s,t[s]);return e},C=(e,t)=>$(e,O(t));import{I as H,as as N}from"./index-26bedde3.js";import{I as P,a3 as R,H as q,J as A}from"./ex-pkg-element-plus-f609432a.js";import{y as F,a as E,l as U,q as V,U as W,an as I,u as v,R as c,F as B,k as J,ar as T,m as X}from"./ex-pkg-@vue-feb543c0.js";function Y(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!J(e)}const y="context-menu",z={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},M=e=>{const{item:t}=e;return c("div",{class:`${y}__text`,onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&c(H,{class:"mr-2",icon:t.icon},null),c("span",null,[t.label])])};var G=F({name:"ContextMenu",props:z,setup(e){const t=E(null),s=E(!1),u=U(()=>{const{axis:o,items:n,styles:r,width:l}=e,{x:a,y:m}=o||{x:0,y:0},p=(n||[]).length*40,x=l,h=document.body,j=h.clientWidth<a+x?a-x:a,k=h.clientHeight<m+p?m-p:m;return C(g({},r),{width:`${l}px`,left:`${j+1}px`,top:`${k+1}px`})});V(()=>{W(()=>s.value=!0)}),I(()=>{const o=v(t);o&&document.body.removeChild(o)});function f(o,n){const{handler:r,disabled:l}=o;l||(s.value=!1,n==null||n.stopPropagation(),n==null||n.preventDefault(),r==null||r())}function i(o){return o.map(n=>{const{disabled:r,label:l,children:a,divider:m=!1}=n,p={item:n,handler:f,showIcon:e.showIcon};return!a||a.length===0?c(B,null,[c(P,{disabled:r,class:`${y}__item`,index:l},{default:()=>[c(M,p,null)]}),m?c(R,{key:`d-${l}`},null):null]):v(s)?c(q,{index:l,disabled:r,"popper-class":`${y}__popup`},{title:()=>c(M,p,null),default:()=>i(a)}):null})}return()=>{let o;if(!v(s))return null;const{items:n}=e;return c(A,{"default-active":"12",mode:"vertical",collapse:!0,"unique-opened":!0,"menu-trigger":"hover",class:y,ref:t,style:v(u)},Y(o=i(n))?o:{default:()=>[o]})}}});const d={domList:[],resolve:()=>{}},K=function(e){const{event:t}=e||{};if(t&&(t==null||t.preventDefault()),!!N)return new Promise(s=>{const u=document.body,f=document.createElement("div"),i={};e.styles&&(i.styles=e.styles),e.items&&(i.items=e.items),e.event&&(i.customEvent=t,i.axis={x:t.clientX,y:t.clientY});const o=c(G,i);T(o,f);const n=function(){d.resolve("")};d.domList.push(f);const r=function(){d.domList.forEach(l=>{try{l&&u.removeChild(l)}catch(a){}}),u.removeEventListener("click",n),u.removeEventListener("scroll",n)};d.resolve=function(l){r(),s(l)},r(),u.appendChild(f),u.addEventListener("click",n),u.addEventListener("scroll",n)})},w=function(){d&&(d.resolve(""),d.domList=[])};function ne(e=!0){return X()&&e&&I(()=>{w()}),[K,w]}export{ne as u};
