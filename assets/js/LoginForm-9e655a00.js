var v=(k,s,n)=>new Promise((c,p)=>{var f=o=>{try{u(n.next(o))}catch(i){p(i)}},g=o=>{try{u(n.throw(o))}catch(i){p(i)}},u=o=>o.done?c(o.value):Promise.resolve(o.value).then(f,g);u((n=n.apply(k,s)).next())});import{y as j,a as y,_ as C,l as I,u as e,I as F,J as B,z as D,G as N,H as t,R as a,a9 as M,P as w,Q as x,ak as T}from"./ex-pkg-@vue-6f720869.js";import{e as U,f as G,h as K}from"./index-91eee367.js";import{u as P,a as $,L as V,b as z}from"./useLogin-85a4ceff.js";import{G as _,H as S,C as b,I as H,x as R,B as J,J as O}from"./ex-pkg-element-plus-6a2cfc13.js";import"./ex-pkg-vendor-69b4619e.js";import"./ex-pkg-mockjs-abb76a9d.js";const ee=j({setup(k){const{t:s}=U(),{notification:n}=G(),c=K(),{setLoginState:p,getLoginState:f}=P(),{getFormRules:g}=$(),u=y(),o=y(!1),i=y(!1),r=C({account:"",password:""}),{validForm:L}=z(u),h=I(()=>e(f)===V.LOGIN);function E(){return v(this,null,function*(){yield L();try{o.value=!0;const d=yield c.login(T({password:r.password,username:r.account,mode:"none"}));d&&n.success({title:s("sys.login.loginSuccessTitle"),message:`${s("sys.login.loginSuccessDesc")}: ${d.realName}`,duration:3e3})}catch(d){n.error({title:s("sys.api.errorTip"),message:d.message||s("sys.api.networkExceptionMsg")})}finally{o.value=!1}})}return(d,l)=>F((D(),N(e(O),{model:e(r),rules:e(g),ref_key:"formRef",ref:u},{default:t(()=>[a(e(S),{prop:"account"},{default:t(()=>[a(e(_),{modelValue:e(r).account,"onUpdate:modelValue":l[0]||(l[0]=m=>e(r).account=m),placeholder:e(s)("sys.login.userNameEg")},null,8,["modelValue","placeholder"])]),_:1}),a(e(S),{prop:"password",class:"mb-1"},{default:t(()=>[a(e(_),{modelValue:e(r).password,"onUpdate:modelValue":l[1]||(l[1]=m=>e(r).password=m),placeholder:e(s)("sys.login.passwordEg"),onKeypress:M(E,["enter"])},null,8,["modelValue","placeholder","onKeypress"])]),_:1}),a(e(J),{class:"mt-3"},{default:t(()=>[a(e(b),{span:12},{default:t(()=>[a(e(H),{modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=m=>i.value=m),size:"small"},{default:t(()=>[w(x(e(s)("sys.login.rememberMe")),1)]),_:1},8,["modelValue"])]),_:1}),a(e(b),{span:12,class:"text-right"},{default:t(()=>[a(e(R),{type:"text",onClick:l[3]||(l[3]=m=>e(p)(e(V).RESET_PASSWORD))},{default:t(()=>[w(x(e(s)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1}),a(e(S),null,{default:t(()=>[a(e(R),{type:"primary",class:"login--submit",loading:o.value,onClick:E},{default:t(()=>[w(x(e(s)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])),[[B,e(h)]])}});export{ee as default};
