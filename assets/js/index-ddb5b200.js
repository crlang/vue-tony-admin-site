var fe=Object.defineProperty,me=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var x=(e,o,l)=>o in e?fe(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,p=(e,o)=>{for(var l in o||(o={}))pe.call(o,l)&&x(e,l,o[l]);if(J)for(var l of J(o))he.call(o,l)&&x(e,l,o[l]);return e},V=(e,o)=>me(e,ge(o));var q=(e,o,l)=>new Promise((c,a)=>{var i=r=>{try{n(l.next(r))}catch(u){a(u)}},t=r=>{try{n(l.throw(r))}catch(u){a(u)}},n=r=>r.done?c(r.value):Promise.resolve(r.value).then(i,t);n((l=l.apply(e,o)).next())});import{ah as ye,_ as j,B as Ce,C as be,N as ve,u as Be,i as ee,ae as Me,a5 as He,a7 as te,w as $e}from"./index-26bedde3.js";import{u as Fe}from"./useAttrs-972c2e18.js";import{ad as Ve,u as Te,K as ke}from"./ex-pkg-element-plus-f609432a.js";import{cm as oe,d0 as we,m as De,cF as Se}from"./ex-pkg-vendor-bb3f8859.js";import{y as L,a as h,l as B,w as I,Z as v,z as y,G as $,H as g,B as C,D as T,u as s,b as ne,q as Ee,an as le,U as k,a2 as Re,I as Pe,A as z,Y as Oe,L as U,P as K,Q as G,O as N,a7 as We,R as w,K as Y,F as Ae,m as Q,af as ae,a3 as je,ag as Le,ah as Ie,_ as se,ak as X}from"./ex-pkg-@vue-feb543c0.js";import{u as Ne}from"./useWindowSizeFn-3a4b39e4.js";import{S as _e}from"./index-93f62e3c.js";import{a as qe}from"./index-8a4d5146.js";import{u as ze}from"./useTimeout-998fb248.js";const re={showClose:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},helpMessage:{type:[String,Array],default:""}},ie={useWrapper:{type:Boolean,default:!0},footerOffset:{type:Number,default:0},loading:{type:Boolean,default:!1},loadingTip:{type:String,default:"\u52A0\u8F7D\u4E2D..."},modalHeaderHeight:{type:Number,default:56},modalFooterHeight:{type:Number,default:70}},ue={showFooter:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},cancelText:{type:String,default:"\u53D6\u6D88"},cancelButton:{type:Object},showConfirm:{type:Boolean,default:!0},confirmText:{type:String,default:"\u786E\u8BA4"},confirmButton:{type:Object}},ce=V(p(p(p(p({},ye),re),ie),ue),{modelValue:{type:Boolean},draggable:{type:Boolean,default:!0},scrollTop:{type:Boolean,default:!0},closeFunc:Function,onOpen:Function,onOpened:Function,onClose:Function,onClosed:Function}),Ue=L({name:"BasicDialog",components:{ElDialog:Ve},inheritAttrs:!1,props:ce,setup(e){const o=h(!1),l=Fe(),c=B(()=>{const a=p(p({},s(l)),e),i=oe(a,["showFullscreen","helpMessage","useWrapper","footerOffset","loading","scrollTop","loadingTip","modalHeaderHeight","modalFooterHeight","showFooter","showCancel","cancelText","showConfirm","confirmText","closeFunc","draggable","confirmButton","cancelButton"]);return i.showClose=!1,i});return I(()=>{o.value=!!e.modelValue}),{visibleRef:o,getBindValue:c}}});function Ye(e,o,l,c,a,i){const t=v("ElDialog");return y(),$(t,T(e.getBindValue,{modelValue:e.visibleRef,"onUpdate:modelValue":o[0]||(o[0]=n=>e.visibleRef=n)}),{title:g(()=>[C(e.$slots,"title")]),footer:g(()=>[C(e.$slots,"footer")]),default:g(()=>[C(e.$slots,"default")]),_:3},16,["modelValue"])}var Xe=j(Ue,[["render",Ye]]);const de=Symbol();function Ke(e){return Ce(e,de)}function bt(){return be(de)}const Ge=L({name:"ModalWrapper",components:{ScrollContainer:_e},inheritAttrs:!1,props:p({modelValue:{type:Boolean},fullscreen:{type:Boolean},customClass:{type:String}},ie),emits:["height-change","ext-height"],setup(e,{emit:o}){const l=h(null),c=h(null),a=h(0),i=h(0);let t=0;Ne(u.bind(null,!1)),we(c,()=>{u()},{attributes:!0,subtree:!0}),Ke({redoModalHeight:u});const n=B(()=>({[e.fullscreen?"height":"maxHeight"]:`${s(a)}px`}));I(()=>{e.useWrapper&&u()}),ne(()=>e.fullscreen,f=>{u(),f?i.value=a.value:a.value=i.value}),Ee(()=>{const{modalHeaderHeight:f,modalFooterHeight:m}=e;o("ext-height",f+m)}),le(()=>{});function r(){return q(this,null,function*(){k(()=>{var m;const f=s(l);!f||(m=f==null?void 0:f.scrollTo)==null||m.call(f,0)})})}function u(){return q(this,null,function*(){if(!e.modelValue)return;const f=s(l);if(!f)return;const m=f.$el.parentElement;if(!!m){yield k();try{const M=m.parentElement;if(!M)return;const D=M.offsetTop;let H=window.innerHeight-D*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;D<40&&(H-=26),yield k();const F=s(c);if(!F)return;yield k(),t=F.scrollHeight,e.fullscreen?a.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:a.value=t>H?H:t,o("height-change",s(a))}catch(M){console.error(M)}}})}return{wrapperRef:l,spinRef:c,spinStyle:n,scrollTop:r,setModalHeight:u}}}),Qe=["element-loading-text"];function Ze(e,o,l,c,a,i){const t=v("ScrollContainer"),n=Re("loading");return y(),$(t,{ref:"wrapperRef",class:U(e.customClass)},{default:g(()=>[Pe((y(),z("div",{ref:"spinRef",style:Oe(e.spinStyle),"element-loading-text":e.loadingTip},[C(e.$slots,"default")],12,Qe)),[[n,e.loading]])]),_:3},8,["class"])}var Je=j(Ge,[["render",Ze]]);const xe=L({name:"BasicModalFooter",components:{ElButton:Te},inheritAttrs:!1,props:V(p({},ue),{customClass:{type:String}}),emits:["ok","cancel"],setup(e,{emit:o}){function l(a){o("ok",a)}function c(a){o("cancel",a)}return{handleOk:l,handleCancel:c}}});function et(e,o,l,c,a,i){var n,r;const t=v("ElButton");return e.showFooter?(y(),z("div",{key:0,class:U(e.customClass)},[C(e.$slots,"insertFooter"),e.showCancel?(y(),$(t,T({key:0},e.cancelButton,{type:((n=e.cancelButton)==null?void 0:n.type)||"default",onClick:e.handleCancel}),{default:g(()=>[K(G(e.cancelText),1)]),_:1},16,["type","onClick"])):N("",!0),C(e.$slots,"centerFooter"),e.showConfirm?(y(),$(t,T({key:1},e.confirmButton,{type:((r=e.confirmButton)==null?void 0:r.type)||"primary",onClick:e.handleOk}),{default:g(()=>[K(G(e.confirmText),1)]),_:1},16,["type","onClick"])):N("",!0),C(e.$slots,"appendFooter")],2)):N("",!0)}var tt=j(xe,[["render",et]]);function ot(e){const o=(a,i)=>getComputedStyle(a)[i],l=a=>{if(!a)return;a.setAttribute("data-drag",s(e.draggable));const i=a.querySelector(".el-dialog__header"),t=a.querySelector(".el-dialog");!i||!t||!s(e.draggable)||(i.style.cursor="move",i.classList.add("is-drag"),i.onmousedown=n=>{if(!n)return;const r=n.clientX,u=n.clientY,f=document.body.clientWidth,m=document.documentElement.clientHeight,M=t.offsetWidth,D=t.offsetHeight,H=t.offsetLeft,F=f-t.offsetLeft-M,_=t.offsetTop,R=m-t.offsetTop-D,S=o(t,"left"),P=o(t,"top");let O=+S,W=+P;S.includes("%")?(O=+document.body.clientWidth*(+S.replace(/%/g,"")/100),W=+document.body.clientHeight*(+P.replace(/%/g,"")/100)):(O=+S.replace(/px/g,""),W=+P.replace(/px/g,"")),document.onmousemove=function(d){let b=d.clientX-r,A=d.clientY-u;-b>H?b=-H:b>F&&(b=F),-A>_?A=-_:A>R&&(A=R),t.style.cssText+=`;left:${b+O}px;top:${A+W}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},c=()=>{const a=document.querySelectorAll(".el-overlay");for(const i of Array.from(a)){if(!i)continue;const t=o(i,"display"),n=i.getAttribute("data-drag");t!=="none"&&(n===null||s(e.destroyOnClose))&&l(i)}};I(()=>{!s(e.modelValue)||!s(e.draggable)||ze(()=>{c()},30)})}const nt=L({name:"BasicModalHeader",components:{ElTooltip:ke,BasicTitle:qe,SvgIcon:ve},inheritAttrs:!1,props:p({modelValue:{type:Boolean},destroyOnClose:{type:Boolean},fullscreen:{type:Boolean},draggable:{type:Boolean},customClass:{type:String},customTitle:{type:String}},re),emits:["cancel","fullscreen"],setup(e,{emit:o}){const{modelValue:l,draggable:c,destroyOnClose:a}=We(e);ot({modelValue:l,destroyOnClose:a,draggable:c});function i(r){!e.showFullscreen||(r.stopPropagation(),n(r))}function t(r){o("cancel",r)}function n(r){r==null||r.stopPropagation(),r==null||r.preventDefault(),o("fullscreen")}return{handleCancel:t,handleFullscreen:n,handleTitleDbClick:i}}});function lt(e,o,l,c,a,i){const t=v("BasicTitle"),n=v("SvgIcon"),r=v("ElTooltip");return y(),z("div",{class:U(e.customClass),onDblclick:o[3]||(o[3]=(...u)=>e.handleTitleDbClick&&e.handleTitleDbClick(...u))},[w(t,{helpMessage:e.helpMessage},{default:g(()=>[K(G(e.customTitle),1)]),_:1},8,["helpMessage"]),Y("div",{class:U(`${e.customClass}__extra`)},[e.showFullscreen?(y(),z(Ae,{key:0},[e.fullscreen?(y(),$(r,{key:0,content:"\u8FD8\u539F",placement:"bottom"},{default:g(()=>[Y("span",{onClick:o[0]||(o[0]=(...u)=>e.handleFullscreen&&e.handleFullscreen(...u))},[w(n,{name:"fullscreen-exit"})])]),_:1})):(y(),$(r,{key:1,content:"\u6700\u5927\u5316",placement:"bottom"},{default:g(()=>[Y("span",{onClick:o[1]||(o[1]=(...u)=>e.handleFullscreen&&e.handleFullscreen(...u))},[w(n,{name:"fullscreen"})])]),_:1}))],64)):N("",!0),e.showClose?(y(),$(r,{key:1,content:"\u5173\u95ED",placement:"bottom"},{default:g(()=>[Y("span",{onClick:o[2]||(o[2]=(...u)=>e.handleCancel&&e.handleCancel(...u))},[w(n,{name:"close"})])]),_:1})):N("",!0)],2)],34)}var at=j(nt,[["render",lt]]);const st=L({name:"BasicModal",components:{Modal:Xe,ModalWrapper:Je,ModalFooter:tt,ModalHeader:at},inheritAttrs:!1,props:ce,emits:["visible-change","height-change","cancel","ok","register","update:modelValue"],setup(e,{emit:o}){const l=h(!1),c=h(null),a=h(null),{prefixCls:i}=Be("basic-modal"),t=h(!1),n=h(!1),r=h(0),u={setModalProps:R,emitVisible:void 0,redoModalHeight:()=>{k(()=>{s(a)&&s(a).setModalHeight()})}},f=Q();f&&o("register",u,f.uid);const m=B(()=>p(p({},e),s(c))),M=B(()=>V(p({},s(m)),{fullscreen:s(t),draggable:s(n),customClass:i})),D=B(()=>V(p({},s(m)),{fullscreen:s(t),modelValue:s(l),draggable:s(n),customClass:`${i}__header`,customTitle:s(m).title})),H=B(()=>V(p({},s(m)),{fullscreen:s(t),modelValue:s(l),customClass:`${i}__body`})),F=B(()=>V(p({},s(m)),{customClass:`${i}__footer`}));I(()=>{l.value=!!e.modelValue,t.value=!!e.fullscreen,n.value=!!e.draggable}),ne(()=>s(l),d=>{var b;o("visible-change",d),o("update:modelValue",d),f&&((b=u.emitVisible)==null||b.call(u,d,f.uid)),k(()=>{(e==null?void 0:e.scrollTop)&&d&&s(a)&&s(a).scrollTop()})},{immediate:!1});function _(d){return q(this,null,function*(){if(d==null||d.stopPropagation(),e.closeFunc&&ee(e.closeFunc)){const b=yield e.closeFunc();l.value=!b;return}l.value=!1,o("cancel",d)})}function R(d){c.value=Me(s(c)||{},d),Reflect.has(d,"modelValue")&&(l.value=!!d.modelValue),Reflect.has(d,"fullscreen")&&(t.value=!!d.fullscreen)}function S(d){o("ok",d)}function P(d){o("height-change",d)}function O(d){r.value=d}function W(){R({fullscreen:!s(t)})}return{prefixCls:i,handleCancel:_,getBaiscBindValue:M,getHeaderBindValue:D,getWrapperBindValue:H,getFooterBindValue:F,handleFullscreen:W,fullscreenRef:t,getMergeProps:m,handleOk:S,visibleRef:l,draggableRef:n,omit:oe,modalWrapperRef:a,handleExtHeight:O,handleHeightChange:P}}});function rt(e,o,l,c,a,i){const t=v("ModalHeader"),n=v("ModalFooter"),r=v("ModalWrapper"),u=v("Modal");return y(),$(u,T(e.getBaiscBindValue,{modelValue:e.visibleRef,"onUpdate:modelValue":o[0]||(o[0]=f=>e.visibleRef=f)}),ae({default:g(()=>[w(r,T({ref:"modalWrapperRef"},e.getWrapperBindValue,{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:g(()=>[C(e.$slots,"default")]),_:3},16,["onExtHeight","onHeightChange"])]),_:2},[e.$slots.title?{name:"title",fn:g(()=>[C(e.$slots,"title")])}:{name:"title",fn:g(()=>[w(t,T(e.getHeaderBindValue,{onFullscreen:e.handleFullscreen,onCancel:e.handleCancel}),null,16,["onFullscreen","onCancel"])])},e.$slots.footer?{name:"footer",fn:g(()=>[C(e.$slots,"footer")])}:{name:"footer",fn:g(()=>[w(n,T(e.getFooterBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),ae({_:2},[je(Object.keys(e.$slots),f=>({name:f,fn:g(m=>[C(e.$slots,f,Le(Ie(m||{})))])}))]),1040,["onOk","onCancel"])])}]),1040,["modelValue"])}var it=j(st,[["render",rt]]);const E=se({}),Z=se({});function vt(){const e=h(null),o=h(!1),l=h("");function c(t,n){if(!Q())throw new Error("useModal() can only be used inside setup() or functional components!");l.value=n,le(()=>{e.value=null,o.value=!1,E[s(l)]=null}),!(s(o)&&He()&&t===s(e))&&(e.value=t,o.value=!0,t.emitVisible=(r,u)=>{Z[u]=r})}const a=()=>{const t=s(e);return t||te("useModal instance is undefined!"),t},i={setModalProps:t=>{var n;(n=a())==null||n.setModalProps(t)},getVisible:B(()=>Z[~~s(l)]),redoModalHeight:()=>{var t,n;(n=(t=a())==null?void 0:t.redoModalHeight)==null||n.call(t)},openModal:(t=!0,n,r=!0)=>{var m;if((m=a())==null||m.setModalProps({modelValue:t}),!n)return;const u=s(l);if(r){E[u]=null,E[u]=X(n);return}De(X(E[u]),X(n))||(E[u]=X(n))},closeModal:()=>{var t;(t=a())==null||t.setModalProps({modelValue:!1})}};return[c,i]}const Bt=e=>{const o=h(null),l=Q(),c=h(""),a=()=>{const t=s(o);return t||te("useModalInner instance is undefined!"),t},i=(t,n)=>{Se(()=>{o.value=null}),c.value=n,o.value=t,l==null||l.emit("register",t,n)};return I(()=>{const t=E[s(c)];!t||!e||!ee(e)||k(()=>{e(t)})}),[i,{changeLoading:(t=!0)=>{var n;(n=a())==null||n.setModalProps({loading:t})},getVisible:B(()=>Z[~~s(c)]),changeConfirmLoading:(t=!0)=>{var n;(n=a())==null||n.setModalProps({confirmButton:{loading:t}})},closeModal:()=>{var t;(t=a())==null||t.setModalProps({modelValue:!1})},setModalProps:t=>{var n;(n=a())==null||n.setModalProps(t)},redoModalHeight:()=>{var n;const t=(n=a())==null?void 0:n.redoModalHeight;t&&t()}}]},Mt=$e(it);export{Mt as B,Bt as a,vt as b,bt as u};
