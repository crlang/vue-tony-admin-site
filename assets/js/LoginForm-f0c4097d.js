var x=(S,o,n)=>new Promise((p,m)=>{var c=a=>{try{u(n.next(a))}catch(i){m(i)}},f=a=>{try{u(n.throw(a))}catch(i){m(i)}},u=a=>a.done?p(a.value):Promise.resolve(a.value).then(c,f);u((n=n.apply(S,o)).next())});import{y as j,a as g,_ as C,l as F,u as e,I as D,J as I,z as N,G as B,H as l,R as t,a9 as M,P as y,Q as w,ak as T}from"./ex-pkg-@vue-6f720869.js";import{e as U,f as z,h as G}from"./index-034694ef.js";import{u as K,a as P,L as E,b as $}from"./useLogin-22db80bc.js";import{C as V,D as v,z as _,F as O,u as b,y as A,G as H}from"./ex-pkg-element-plus-fdfdae45.js";import"./ex-pkg-vendor-a94c680b.js";import"./ex-pkg-mockjs-2c72399a.js";const ee=j({setup(S){const{t:o}=U(),{notification:n}=z(),p=G(),{setLoginState:m,getLoginState:c}=K(),{getFormRules:f}=P(),u=g(),a=g(!1),i=g(!1),r=C({account:"",password:""}),{validForm:R}=$(u),L=F(()=>e(c)===E.LOGIN);function k(){return x(this,null,function*(){if(!!(yield R()))try{a.value=!0;const s=yield p.login(T({password:r.password,username:r.account,mode:"none"}));s&&n.success({title:o("sys.login.loginSuccessTitle"),message:`${o("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3e3})}catch(s){n.error({title:o("sys.api.errorTip"),message:s.message||o("sys.api.networkExceptionMsg")})}finally{a.value=!1}})}return(h,s)=>D((N(),B(e(H),{model:e(r),rules:e(f),ref_key:"formRef",ref:u},{default:l(()=>[t(e(v),{prop:"account"},{default:l(()=>[t(e(V),{modelValue:e(r).account,"onUpdate:modelValue":s[0]||(s[0]=d=>e(r).account=d),placeholder:e(o)("sys.login.userNameEg")},null,8,["modelValue","placeholder"])]),_:1}),t(e(v),{prop:"password",class:"mb-1"},{default:l(()=>[t(e(V),{modelValue:e(r).password,"onUpdate:modelValue":s[1]||(s[1]=d=>e(r).password=d),placeholder:e(o)("sys.login.passwordEg"),onKeypress:M(k,["enter"])},null,8,["modelValue","placeholder","onKeypress"])]),_:1}),t(e(A),{class:"mt-3"},{default:l(()=>[t(e(_),{span:12},{default:l(()=>[t(e(O),{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=d=>i.value=d),size:"small"},{default:l(()=>[y(w(e(o)("sys.login.rememberMe")),1)]),_:1},8,["modelValue"])]),_:1}),t(e(_),{span:12,class:"text-right"},{default:l(()=>[t(e(b),{type:"text",onClick:s[3]||(s[3]=d=>e(m)(e(E).RESET_PASSWORD))},{default:l(()=>[y(w(e(o)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1}),t(e(v),null,{default:l(()=>[t(e(b),{type:"primary",class:"login--submit",loading:a.value,onClick:k},{default:l(()=>[y(w(e(o)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])),[[I,e(L)]])}});export{ee as default};
