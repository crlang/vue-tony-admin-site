var K=Object.defineProperty,Q=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var L=(t,r,d)=>r in t?K(t,r,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[r]=d,x=(t,r)=>{for(var d in r||(r={}))Y.call(r,d)&&L(t,d,r[d]);if(F)for(var d of F(r))ee.call(r,d)&&L(t,d,r[d]);return t},k=(t,r)=>Q(t,U(r));import{u as A,a8 as te,au as j,w as V}from"./index-26bedde3.js";import{u as X}from"./useTimeout-998fb248.js";import{g as Z}from"./tsxHelper-ab68d96a.js";import{cS as se,d8 as ne}from"./ex-pkg-vendor-bb3f8859.js";import{y as H,_ as q,a as E,l as $,b as z,w as ae,R as h,u as f,D as ie}from"./ex-pkg-@vue-feb543c0.js";const G={value:{type:Boolean,default:!1},isSlot:{type:Boolean,default:!1},text:{type:String,default:"	\u8BF7\u6309\u4F4F\u6ED1\u5757\u62D6\u52A8"},successText:{type:String,default:"\u9A8C\u8BC1\u901A\u8FC7"},height:{type:[Number,String],default:40},width:{type:[Number,String],default:220},circle:{type:Boolean,default:!1},wrapStyle:{type:Object,default:{}},contentStyle:{type:Object,default:{}},barStyle:{type:Object,default:{}},actionStyle:{type:Object,default:{}}},oe=k(x({},G),{src:{type:String},imgWidth:{type:Number,default:260},imgWrapStyle:{type:Object,default:{}},minDegree:{type:Number,default:90},maxDegree:{type:Number,default:270},diffDegree:{type:Number,default:20}});var J=H({name:"BaseDargVerify",props:G,emits:["success","update:value","change","start","move","end"],setup(t,{emit:r,slots:d,expose:C}){const s=q({isMoving:!1,isPassing:!1,moveDistance:0,toLeft:!1,startTime:0,endTime:0}),n=E(null),y=E(null),R=E(null),b=E(null),{prefixCls:S}=A("basic-drag-verify");te({el:document,name:"mouseup",listener:()=>{s.isMoving&&p()}});const O=$(()=>{const{height:e,actionStyle:o}=t,c=`${parseInt(e)}px`;return x({left:0,width:c,height:c},o)}),I=$(()=>{const{height:e,width:o,circle:c,wrapStyle:a}=t,l=parseInt(e),m=`${parseInt(o)}px`;return x({width:m,height:`${l}px`,lineHeight:`${l}px`,borderRadius:c?l/2+"px":0},a)}),B=$(()=>{const{height:e,circle:o,barStyle:c}=t,a=parseInt(e);return x({height:`${a}px`,borderRadius:o?a/2+"px 0 0 "+a/2+"px":0},c)}),P=$(()=>{const{height:e,width:o,contentStyle:c}=t,a=`${parseInt(e)}px`,l=`${parseInt(o)}px`;return x({height:a,width:l},c)});z(()=>s.isPassing,e=>{if(e){const{startTime:o,endTime:c}=s,a=(c-o)/1e3;r("success",{isPassing:e,time:a.toFixed(1)}),r("update:value",e),r("change",e)}}),ae(()=>{s.isPassing=!!t.value});function T(e){return e.pageX||e.touches[0].pageX}function i(e){if(s.isPassing)return;const o=f(b);!o||(r("start",e),s.moveDistance=T(e)-parseInt(o.style.left.replace("px",""),10),s.startTime=new Date().getTime(),s.isMoving=!0)}function u(e){const o=parseInt(e.style.width),{width:c}=t,a=parseInt(c);return{offset:a-o-6,widthNum:a,actionWidth:o}}function g(e){const{isMoving:o,moveDistance:c}=s;if(o){const a=f(b),l=f(y);if(!a||!l)return;const{offset:m,widthNum:_,actionWidth:M}=u(a),w=T(e)-c;r("move",{event:e,moveDistance:c,moveX:w}),w>0&&w<=m?(a.style.left=`${w}px`,l.style.width=`${w+M/2}px`):w>m&&(a.style.left=`${_-M}px`,l.style.width=`${_-M/2}px`,t.isSlot||D())}}function v(e){const{isMoving:o,isPassing:c,moveDistance:a}=s;if(o&&!c){r("end",e);const l=f(b),m=f(y);if(!l||!m)return;const _=T(e)-a,{offset:M,widthNum:w,actionWidth:N}=u(l);_<M?t.isSlot?setTimeout(()=>{if(!t.value)p();else{const W=f(R);W&&(W.style.width=`${parseInt(m.style.width)}px`)}},0):p():(l.style.left=`${w-N}px`,m.style.width=`${w-N/2}px`,D()),s.isMoving=!1}}function D(){if(t.isSlot){p();return}s.endTime=new Date().getTime(),s.isPassing=!0,s.isMoving=!1}function p(){s.isMoving=!1,s.isPassing=!1,s.moveDistance=0,s.toLeft=!1,s.startTime=0,s.endTime=0;const e=f(b),o=f(y),c=f(R);!e||!o||!c||(s.toLeft=!0,X(()=>{s.toLeft=!1,e.style.left="0",o.style.width="0"},300),c.style.width=f(P).width)}return C({resume:p}),()=>{const e=()=>{const a=[`${S}-bar`];return s.toLeft&&a.push("to-left"),h("div",{class:a,ref:y,style:f(B)},null)},o=()=>{const a=[`${S}-content`],{isPassing:l}=s,{text:m,successText:_}=t;return l&&a.push("success"),h("div",{class:a,ref:R,style:f(P)},[Z(d,"text",l)||(l?_:m)])},c=()=>{const a=[`${S}-action`],{toLeft:l,isPassing:m}=s;return l&&a.push("to-left"),h("div",{class:a,onMousedown:i,onTouchstart:i,style:f(O),ref:b},[Z(d,"actionIcon",m)||(m?h(se,{class:`${S}-action__icon`},null):h(ne,{class:`${S}-action__icon`},null))])};return h("div",{class:S,ref:n,style:f(I),onMousemove:g,onTouchmove:g,onMouseleave:v,onMouseup:v,onTouchend:v},[e(),o(),c()])}}});var re=H({name:"ImgRotateDragVerify",inheritAttrs:!1,props:oe,emits:["success","change","update:value"],setup(t,{emit:r,attrs:d,expose:C}){const s=E(null),n=q({showTip:!1,isPassing:!1,imgStyle:{},randomRotate:0,currentRotate:0,toOrigin:!1,startTime:0,endTime:0,draged:!1}),{prefixCls:y}=A("basic-img-verify");z(()=>n.isPassing,i=>{if(i){const{startTime:u,endTime:g}=n,v=(g-u)/1e3;r("success",{isPassing:i,time:v.toFixed(1)}),r("change",i),r("update:value",i)}});const R=$(()=>{const{imgWrapStyle:i,imgWidth:u}=t;return x({width:`${u}px`,height:`${u}px`},i)}),b=$(()=>{const{minDegree:i,maxDegree:u}=t;return i===u?Math.floor(1+Math.random()*1)/10+1:1});function S(){n.startTime=new Date().getTime()}function O(i){n.draged=!0;const{imgWidth:u,height:g,maxDegree:v}=t,{moveX:D}=i,p=Math.ceil(D/(u-parseInt(g))*v*f(b));n.currentRotate=p,n.imgStyle=j("transform",`rotateZ(${n.randomRotate-p}deg)`)}function I(){const{minDegree:i,maxDegree:u}=t,g=Math.floor(i+Math.random()*(u-i));n.randomRotate=g,n.imgStyle=j("transform",`rotateZ(${g}deg)`)}function B(){const{randomRotate:i,currentRotate:u}=n,{diffDegree:g}=t;Math.abs(i-u)>=(g||20)?(n.imgStyle=j("transform",`rotateZ(${i}deg)`),n.toOrigin=!0,X(()=>{n.toOrigin=!1,n.showTip=!0},300)):P(),n.showTip=!0}function P(){n.isPassing=!0,n.endTime=new Date().getTime()}function T(){n.showTip=!1;const i=f(s);!i||(n.isPassing=!1,i.resume(),I())}return C({resume:T}),()=>{const{src:i}=t,{toOrigin:u,isPassing:g,startTime:v,endTime:D}=n,p=[];u&&p.push("to-origin");const e=(D-v)/1e3;return h("div",{class:`${y}`},[h("div",{class:`${y}-img__wrap`,style:f(R)},[h("img",{src:i,onLoad:I,width:parseInt(t.width),class:p,style:n.imgStyle,onClick:()=>{T()},alt:"verify"},null),n.showTip&&h("span",{class:[`${y}-img__tip`,n.isPassing?"success":"error"]},[n.isPassing?`\u9A8C\u8BC1\u6821\u9A8C\u6210\u529F,\u8017\u65F6${e.toFixed(1)}\u79D2\uFF01`:"\u9A8C\u8BC1\u5931\u8D25\uFF01"]),!n.showTip&&!n.draged&&h("span",{class:[`${y}-img__tip`,"normal"]},["\u70B9\u51FB\u56FE\u7247\u53EF\u5237\u65B0"])]),h(J,ie({class:`${y}-drag__bar`,onMove:O,onEnd:B,onStart:S,ref:s},x(x({},d),t),{value:g,isSlot:!0}),null)])}}});const me=V(J),he=V(re);export{me as B,he as R};
