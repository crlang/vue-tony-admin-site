var z=(o,i,u)=>new Promise((n,f)=>{var r=m=>{try{v(u.next(m))}catch(_){f(_)}},a=m=>{try{v(u.throw(m))}catch(_){f(_)}},v=m=>m.done?n(m.value):Promise.resolve(m.value).then(r,a);v((u=u.apply(o,i)).next())});import{d as H,o as w,f as M,g as l,h,b as e,r as b,dr as O,aR as W,bN as q,bK as P,dh as Q,bD as X,R as K,ev as I,c as U,w as Y,j as Z,i as V,s as j,n as p,E as ee,v as F,am as oe,bm as te,t as ae,bJ as ne,k as re,as as se,b_ as le,l as ie,_ as ce,e as N}from"./index.b263d89e.js";import{I as C}from"./index.26dc116b.js";import{g as de,f as ue,C as me}from"./index.7b185c54.js";import{u as he}from"./index.b816e23f.js";import{S as L}from"./Search.2f3c9cde.js";import{E as pe}from"./index.ee4e75a5.js";import"./index.12ea0f65.js";import"./useWindowSizeFn.159736d7.js";import"./index.53cddd5b.js";import"./_baseIsEqual.0e612cfa.js";import"./_baseUniq.82ba82ab.js";import"./index.ac2e14a0.js";import"./index.7eeeac30.js";import"./useTimeout.f7502887.js";import"./index.ae873226.js";import"./dropdown.109c4d5b.js";import"./index.151e0821.js";import"./drawer.95bcb9ff.js";import"./use-dialog.adf6f7df.js";import"./index.7bce58f8.js";import"./refs.63e616a9.js";import"./index.80d0f5e3.js";import"./index.3d0d290c.js";import"./lock.c281e323.js";const fe=l("span",null,"\u786E\u8BA4",-1),ye=l("span",null,"\u5207\u6362",-1),ve=l("span",null,"\u5173\u95ED",-1),_e=H({__name:"AppSearchFooter",setup(o){return(i,u)=>(w(),M("div",null,[l("div",null,[l("span",null,[h(e(C),{name:"uil:enter"})]),fe]),l("div",null,[l("span",null,[h(e(C),{name:"ion:arrow-up-outline"})]),l("span",null,[h(e(C),{name:"ion:arrow-down-outline"})]),ye]),l("div",null,[l("span",null,[h(e(C),{name:"mdi:keyboard-esc"})]),ve])]))}});function ge(){const o=b([]);return O(()=>{o.value=[]}),[o,u=>n=>{o.value[u]=n}]}function be(o){return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(o)?`\\${o}`:o}function xe(o){const i=[...o].map(n=>be(n)),u=["",...i,""].join(".*");return new RegExp(u)}function we(o,i,u){const n=b([]),f=b(""),r=b(-1);let a=[];const v=W(),m=q(_,200);P(()=>z(this,null,function*(){const s=yield de();a=Q(s)}));function _(s){if(f.value=s.trim(),!s){n.value=[];return}const c=xe(e(f)),d=X(a,t=>c.test(t.name)&&!t.hideMenu);n.value=R(d,c),r.value=0}function R(s,c,d){const t=[];return s.forEach(y=>{const{name:g,path:x,icon:G,children:k,hideMenu:J,meta:$}=y;!J&&c.test(g)&&(!(k!=null&&k.length)||($==null?void 0:$.hideChildrenInMenu))&&t.push({name:d!=null&&d.name?`${d.name} > ${g}`:g,path:x,icon:G}),!($!=null&&$.hideChildrenInMenu)&&Array.isArray(k)&&k.length&&t.push(...R(k,c,y))}),t}function S(s){const c=s.target.dataset.index;r.value=Number(c)}function B(){!n.value.length||(r.value--,r.value<0&&(r.value=n.value.length-1),E())}function T(){!n.value.length||(r.value++,r.value>n.value.length-1&&(r.value=0),E())}function E(){const s=e(o);if(!s||!Array.isArray(s)||s.length===0||!e(i))return;const c=e(r),d=s[c];if(!d)return;const t=e(i);if(!t)return;const y=d.offsetTop+d.offsetHeight,g=t.offsetHeight,{start:x}=he({el:t,duration:100,to:y-g});x()}function D(){return z(this,null,function*(){if(!n.value.length)return;const s=e(n),c=e(r);if(s.length===0||c<0)return;const d=s[c];A(),yield K(),v(d.path)})}function A(){n.value=[],u("close")}return I("Enter",D),I("ArrowUp",B),I("ArrowDown",T),I("Escape",A),{handleSearch:m,searchResult:n,keyword:f,activeIndex:r,handleMouseenter:S,handleEnter:D}}const ke=["data-index"],$e=H({__name:"AppSearchModal",props:{visible:{type:Boolean}},emits:["close"],setup(o,{emit:i}){const u=o,n=b(null),f=b(null),r=b(""),{prefixCls:a}=ie("header-search-modal"),[v,m]=ge(),{getIsMobile:_}=ue(),{handleSearch:R,searchResult:S,keyword:B,activeIndex:T,handleEnter:E,handleMouseenter:D}=we(v,n,i),A=U(()=>!B||e(S).length===0),s=U(()=>[a,{[`${a}--mobile`]:e(_)}]);Y(()=>u.visible,d=>{d&&K(()=>{var t;r.value="",(t=e(f))==null||t.focus()})});function c(){S.value=[],i("close")}return(d,t)=>(w(),Z(le,{to:"body"},[h(se,{name:"zoom-fade",mode:"out-in"},{default:V(()=>[o.visible?(w(),M("div",{key:0,class:p(e(s)),onClick:t[3]||(t[3]=ne(()=>{},["stop"]))},[j((w(),M("div",{class:p(`${e(a)}-content`)},[l("div",{class:p(`${e(a)}-input__wrapper`)},[h(e(ee),{class:p(`${e(a)}-input`),placeholder:"\u641C\u7D22",ref_key:"inputRef",ref:f,clearable:"",modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=y=>r.value=y),onInput:e(R)},{prefix:V(()=>[h(e(L))]),_:1},8,["class","modelValue","onInput"]),l("span",{class:p(`${e(a)}-cancel`),onClick:c},"\u53D6\u6D88",2)],2),j(l("div",{class:p(`${e(a)}-nodata`)},"\u6682\u65E0\u641C\u7D22\u7ED3\u679C",2),[[F,e(A)]]),j(l("ul",{class:p(`${e(a)}-list`),ref_key:"scrollWrap",ref:n},[(w(!0),M(oe,null,te(e(S),(y,g)=>(w(),M("li",{ref_for:!0,ref:e(m)(g),key:y.path,"data-index":g,onMouseenter:t[1]||(t[1]=(...x)=>e(D)&&e(D)(...x)),onClick:t[2]||(t[2]=(...x)=>e(E)&&e(E)(...x)),class:p([`${e(a)}-list__item`,{[`${e(a)}-list__item--active`]:e(T)===g}])},[l("div",{class:p(`${e(a)}-list__item-icon`)},[h(e(C),{name:y.icon||"mdi:form-select",size:20},null,8,["name"])],2),l("div",{class:p(`${e(a)}-list__item-text`)},ae(y.name),3),l("div",{class:p(`${e(a)}-list__item-enter`)},[h(e(C),{name:"uil:enter",size:20})],2)],42,ke))),128))],2),[[F,!e(A)]]),h(_e,{class:p(`${e(a)}-footer`)},null,8,["class"])],2)),[[e(me),c]])],2)):re("",!0)]),_:1})]))}}),Me=H({name:"AppSearch",components:{ElTooltip:pe,AppSearchModal:$e,Search:L},setup(){return{showModal:b(!1)}}});function Ce(o,i,u,n,f,r){const a=N("Search"),v=N("ElTooltip"),m=N("AppSearchModal");return w(),M("div",{onClick:i[1]||(i[1]=_=>o.showModal=!0)},[h(v,{effect:"dark",content:"\u641C\u7D22",placement:"bottom-end"},{default:V(()=>[l("span",null,[h(a)])]),_:1}),h(m,{onClose:i[0]||(i[0]=_=>o.showModal=!1),visible:o.showModal},null,8,["visible"])])}var Ye=ce(Me,[["render",Ce]]);export{Ye as default};
