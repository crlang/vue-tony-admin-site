var ge=Object.defineProperty,me=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var te=(e,t,a)=>t in e?ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,y=(e,t)=>{for(var a in t||(t={}))ye.call(t,a)&&te(e,a,t[a]);if(oe)for(var a of oe(t))Ce.call(t,a)&&te(e,a,t[a]);return e},V=(e,t)=>me(e,he(t));var I=(e,t,a)=>new Promise((i,n)=>{var s=d=>{try{l(a.next(d))}catch(u){n(u)}},o=d=>{try{l(a.throw(d))}catch(u){n(u)}},l=d=>d.done?i(d.value):Promise.resolve(d.value).then(s,o);l((a=a.apply(e,t)).next())});import{as as Me,e as ne,v as ve,at as be,J as $e,K as Se,W as Be,_ as L,$ as Fe,ai as He,u as Te,i as le,aq as Pe,ac as ke,ad as ae,w as we}from"./index.c38c7de5.js";import{ak as N,u as r,x as D,R as Ve,o as _,a0 as $,bW as De,bk as Oe,M as m,bX as Re,y as H,O as se,W as We,ag as re,X as P,Y as b,bd as Ee,z as C,Z as k,a3 as g,B as Le,A as q,a4 as S,S as je,a7 as Ae,a8 as Ie,D as Y,aa as J,aI as Ne,ab as K,F as U,a1 as z,af as G,al as _e,ad as ie,G as ce,ao as ue,aJ as Z,aK as Q,I as de,t as X,aY as qe,aj as ze}from"./vendor.041d4bc7.js";import{u as Xe}from"./useAttrs.374c949f.js";import{u as Ye}from"./useWindowSizeFn.b4a2eb84.js";const{t:fe}=ne(),Je=V(y({},Me),{scrollTop:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},cancelText:{type:String,default:fe("common.cancelText")},confirmText:{type:String,default:fe("common.confirmText")},closeFunc:Function}),x=V(y({},Je),{modelValue:{type:Boolean},defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showConfirmBtn:{type:Boolean,default:!0},wrapperProps:Object,confirmLoading:{type:Boolean},keyboard:{type:Boolean,default:!0},confirmType:{type:String,default:"primary"},confirmButtonProps:Object,cancelButtonProps:Object});function Ke(e){const t=(n,s)=>getComputedStyle(n)[s],a=n=>{if(!n)return;n.setAttribute("data-drag",r(e.draggable));const s=n.querySelector(".el-dialog__header"),o=n.querySelector(".el-dialog");!s||!o||!r(e.draggable)||(s.style.cursor="move",s.classList.add("is-drag"),s.onmousedown=l=>{if(!l)return;const d=l.clientX,u=l.clientY,f=document.body.clientWidth,p=document.documentElement.clientHeight,h=o.offsetWidth,M=o.offsetHeight,B=o.offsetLeft,F=f-o.offsetLeft-h,T=o.offsetTop,j=p-o.offsetTop-M,w=t(o,"left"),R=t(o,"top");let W=+w,E=+R;w.includes("%")?(W=+document.body.clientWidth*(+w.replace(/%/g,"")/100),E=+document.body.clientHeight*(+R.replace(/%/g,"")/100)):(W=+w.replace(/px/g,""),E=+R.replace(/px/g,"")),document.onmousemove=function(A){let c=A.clientX-d,v=A.clientY-u;-c>B?c=-B:c>F&&(c=F),-v>T?v=-T:v>j&&(v=j),o.style.cssText+=`;left:${c+W}px;top:${v+E}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},i=()=>{const n=document.querySelectorAll(".el-overlay");for(const s of Array.from(n)){if(!s)continue;const o=t(s,"display"),l=s.getAttribute("data-drag");o!=="none"&&(l===null||r(e.destroyOnClose))&&a(s)}};N(()=>{!r(e.modelValue)||!r(e.draggable)||ve(()=>{i()},30)})}function Ue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Oe(e)}var Ge=D({name:"BasicDialog",inheritAttrs:!1,props:x,setup(e,{slots:t}){const{modelValue:a,draggable:i,destroyOnClose:n}=Ve(e),s=Xe();return Ke({modelValue:a,destroyOnClose:n,draggable:i}),()=>{let o;const l=y(y({},r(s)),e),d=_(l,["helpMessage","closeFunc","loadingTip","wrapperProps","footer","confirmButtonProps","cancelButtonProps","scrollTop","draggable","centered","cancelText","confirmText","defaultFullscreen","canFullscreen","wrapperFooterOffset","useWrapper","loading","showCancelBtn","showConfirmBtn","confirmLoading","keyboard","confirmType","userData"]);return d.showClose=!1,$(De,d,Ue(o=be(t))?o:{default:()=>[o]})}}});const pe=Symbol();function Ze(e){return $e(e,pe)}function $o(){return Se(pe)}const Qe={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},footerOffset:{type:Number,default:0},modelValue:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},xe=D({name:"ModalWrapper",components:{ScrollContainer:Be},inheritAttrs:!1,props:Qe,emits:["height-change","ext-height"],setup(e,{emit:t}){const a=m(null),i=m(null),n=m(0),s=m(0);let o=0;Ye(u.bind(null,!1)),Re(i,()=>{u()},{attributes:!0,subtree:!0}),Ze({redoModalHeight:u});const l=H(()=>({[e.fullScreen?"height":"maxHeight"]:`${r(n)}px`}));N(()=>{e.useWrapper&&u()}),se(()=>e.fullScreen,f=>{u(),f?s.value=n.value:n.value=s.value}),We(()=>{const{modalHeaderHeight:f,modalFooterHeight:p}=e;t("ext-height",f+p)}),re(()=>{});function d(){return I(this,null,function*(){P(()=>{var p;const f=r(a);!f||(p=f==null?void 0:f.scrollTo)==null||p.call(f,0)})})}function u(){return I(this,null,function*(){if(!e.modelValue)return;const f=r(a);if(!f)return;const p=f.$el.parentElement;if(!!p){p.style.padding="0",yield P();try{const h=p.parentElement&&p.parentElement.parentElement;if(!h)return;const M=getComputedStyle(h).top,B=Number.parseInt(M);let F=window.innerHeight-B*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;B<40&&(F-=26),yield P();const T=r(i);if(!T)return;yield P(),o=T.scrollHeight,e.fullScreen?n.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:n.value=o>F?F:o,t("height-change",r(n))}catch(h){console.log(h)}}})}return{wrapperRef:a,spinRef:i,spinStyle:l,scrollTop:d,setModalHeight:u}}}),eo=["element-loading-text"];function oo(e,t,a,i,n,s){const o=b("ScrollContainer"),l=Ee("loading");return C(),k(o,{ref:"wrapperRef"},{default:g(()=>[Le((C(),q("div",{ref:"spinRef",style:je(e.spinStyle),"element-loading-text":e.loadingTip},[S(e.$slots,"default")],12,eo)),[[l,e.loading]])]),_:3},512)}var to=L(xe,[["render",oo]]);const no=D({name:"ModalClose",components:{ElTooltip:Ae,SvgIcon:Fe},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:t}){const{t:a}=ne();function i(s){t("cancel",s)}function n(s){s==null||s.stopPropagation(),s==null||s.preventDefault(),t("fullscreen")}return{t:a,handleCancel:i,handleFullScreen:n}}});function lo(e,t,a,i,n,s){const o=b("SvgIcon"),l=b("ElTooltip");return C(),q("div",null,[e.canFullscreen?(C(),q(Ie,{key:0},[e.fullScreen?(C(),k(l,{key:0,content:e.t("component.modal.restore"),placement:"bottom"},{default:g(()=>[Y("span",null,[$(o,{name:"fullscreen-exit",onClick:e.handleFullScreen},null,8,["onClick"])])]),_:1},8,["content"])):(C(),k(l,{key:1,content:e.t("component.modal.maximize"),placement:"bottom"},{default:g(()=>[Y("span",null,[$(o,{name:"fullscreen",onClick:e.handleFullScreen},null,8,["onClick"])])]),_:1},8,["content"]))],64)):J("",!0),$(l,{content:e.t("component.modal.close"),placement:"bottom"},{default:g(()=>[Y("span",null,[$(o,{name:"close",onClick:e.handleCancel},null,8,["onClick"])])]),_:1},8,["content"])])}var ao=L(no,[["render",lo]]);const so=D({name:"BasicModalFooter",components:{ElButton:Ne},props:x,emits:["ok","cancel"],setup(e,{emit:t}){function a(n){t("ok",n)}function i(n){t("cancel",n)}return{handleOk:a,handleCancel:i}}});function ro(e,t,a,i,n,s){const o=b("ElButton");return C(),q("div",null,[S(e.$slots,"insertFooter"),e.showCancelBtn?(C(),k(o,z({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:g(()=>[K(U(e.cancelText),1)]),_:1},16,["onClick"])):J("",!0),S(e.$slots,"centerFooter"),e.showConfirmBtn?(C(),k(o,z({key:1,type:e.confirmType,onClick:e.handleOk,loading:e.confirmLoading},e.confirmButtonProps),{default:g(()=>[K(U(e.confirmText),1)]),_:1},16,["type","onClick","loading"])):J("",!0),S(e.$slots,"appendFooter")])}var io=L(so,[["render",ro]]);const co=D({name:"BasicModalHeader",components:{BasicTitle:He},props:{helpMessage:{type:[String,Array]},title:{type:String}}});function uo(e,t,a,i,n,s){const o=b("BasicTitle");return C(),k(o,{helpMessage:e.helpMessage},{default:g(()=>[K(U(e.title),1)]),_:1},8,["helpMessage"])}var fo=L(co,[["render",uo]]);function po(e){const t=m(!1),a=H(()=>{const n=r(e.customClass)||"";return r(t)?`fullscreen-modal ${n} `:r(n)});function i(n){n&&n.stopPropagation(),t.value=!r(t)}return{getCustomClass:a,handleFullScreen:i,fullScreenRef:t}}const go=D({name:"BasicModal",components:{Modal:Ge,ModalWrapper:to,ModalClose:ao,ModalFooter:io,ModalHeader:fo},inheritAttrs:!1,props:x,emits:["visible-change","height-change","cancel","ok","register","update:modelValue"],setup(e,{emit:t,attrs:a}){const i=m(!1),n=m(null),s=m(null),{prefixCls:o}=Te("basic-modal"),l=m(0),d={setModalProps:w,emitVisible:void 0,redoModalHeight:()=>{P(()=>{r(s)&&r(s).setModalHeight()})}},u=G();u&&t("register",d,u.uid);const f=H(()=>y(y({},e),r(n))),{handleFullScreen:p,getCustomClass:h,fullScreenRef:M}=po({modalWrapperRef:s,extHeightRef:l,customClass:_e(f.value,"customClass")}),B=H(()=>{const c=V(y({},r(f)),{modelValue:r(i),confirmButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return V(y({},c),{customClass:`${o} ${r(h)}`})}),F=H(()=>{const c=V(y(y({},a),r(f)),{modelValue:r(i),fullscreen:r(M),customClass:`${o} ${r(h)}`});return r(M)?_(c,["height","title"]):_(c,"title")}),T=H(()=>{if(!r(M))return r(B).height});N(()=>{i.value=!!e.modelValue,M.value=!!e.defaultFullscreen}),se(()=>r(i),c=>{var v;t("visible-change",c),t("update:modelValue",c),u&&((v=d.emitVisible)==null||v.call(d,c,u.uid)),P(()=>{e.scrollTop&&c&&r(s)&&r(s).scrollTop()})},{immediate:!1});function j(c){return I(this,null,function*(){if(c==null||c.stopPropagation(),e.closeFunc&&le(e.closeFunc)){const v=yield e.closeFunc();i.value=!v;return}i.value=!1,t("cancel",c)})}function w(c){n.value=Pe(r(n)||{},c),Reflect.has(c,"modelValue")&&(i.value=!!c.modelValue),Reflect.has(c,"defaultFullscreen")&&(M.value=!!c.defaultFullscreen)}function R(c){t("ok",c)}function W(c){t("height-change",c)}function E(c){l.value=c}function A(c){!e.canFullscreen||(c.stopPropagation(),p(c))}return{prefixCls:o,handleCancel:j,getBindValue:F,getProps:B,handleFullScreen:p,fullScreenRef:M,getMergeProps:f,handleOk:R,visibleRef:i,omit:_,modalWrapperRef:s,handleExtHeight:E,handleHeightChange:W,handleTitleDbClick:A,getWrapperHeight:T}}});function mo(e,t,a,i,n,s){const o=b("ModalHeader"),l=b("ModalClose"),d=b("ModalFooter"),u=b("ModalWrapper"),f=b("Modal");return C(),k(f,Z(Q(e.getBindValue)),ie({default:g(()=>[$(u,z({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,modelValue:e.visibleRef},e.omit(e.getProps.wrapperProps,"modelValue","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:g(()=>[S(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","modelValue","onExtHeight","onHeightChange"])]),_:2},[e.$slots.title?{name:"title",fn:g(()=>[S(e.$slots,"title")])}:e.title?{name:"title",fn:g(()=>[$(o,{helpMessage:e.getProps.helpMessage,class:ce(`${e.prefixCls}__title`),title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","class","title","onDblclick"]),$(l,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,class:ce(`${e.prefixCls}__close`),onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","class","onCancel","onFullscreen"])])}:void 0,e.$slots.footer?{name:"footer",fn:g(()=>[S(e.$slots,"footer")])}:e.showCancelBtn||e.showConfirmBtn||e.$slots.insertFooter||e.$slots.centerFooter||e.$slots.appendFooter?{name:"footer",fn:g(()=>[$(d,z(e.getBindValue,{class:`${e.prefixCls}__footer`,onOk:e.handleOk,onCancel:e.handleCancel}),ie({_:2},[ue(Object.keys(e.$slots),p=>({name:p,fn:g(h=>[S(e.$slots,p,Z(Q(h||{})))])}))]),1040,["class","onOk","onCancel"])])}:void 0,ue(Object.keys(e.omit(e.$slots,"default")),p=>({name:p,fn:g(h=>[S(e.$slots,p,Z(Q(h||{})))])}))]),1040)}var ho=L(go,[["render",mo]]);const O=de({}),ee=de({});function So(){const e=m(null),t=m(!1),a=m("");function i(o,l){if(!G())throw new Error("useModal() can only be used inside setup() or functional components!");a.value=l,re(()=>{e.value=null,t.value=!1,O[r(a)]=null}),!(r(t)&&ke()&&o===r(e))&&(e.value=o,t.value=!0,o.emitVisible=(d,u)=>{ee[u]=d})}const n=()=>{const o=r(e);return o||ae("useModal instance is undefined!"),o},s={setModalProps:o=>{var l;(l=n())==null||l.setModalProps(o)},getVisible:H(()=>ee[~~r(a)]),redoModalHeight:()=>{var o,l;(l=(o=n())==null?void 0:o.redoModalHeight)==null||l.call(o)},openModal:(o=!0,l,d=!0)=>{var p;if((p=n())==null||p.setModalProps({modelValue:o}),!l)return;const u=r(a);if(d){O[u]=null,O[u]=X(l);return}qe(X(O[u]),X(l))||(O[u]=X(l))},closeModal:()=>{var o;(o=n())==null||o.setModalProps({modelValue:!1})}};return[i,s]}const Bo=e=>{const t=m(null),a=G(),i=m(""),n=()=>{const o=r(t);return o||ae("useModalInner instance is undefined!"),o},s=(o,l)=>{ze(()=>{t.value=null}),i.value=l,t.value=o,a==null||a.emit("register",o,l)};return N(()=>{const o=O[r(i)];!o||!e||!le(e)||P(()=>{e(o)})}),[s,{changeLoading:(o=!0)=>{var l;(l=n())==null||l.setModalProps({loading:o})},getVisible:H(()=>ee[~~r(i)]),changeOkLoading:(o=!0)=>{var l;(l=n())==null||l.setModalProps({confirmLoading:o})},closeModal:()=>{var o;(o=n())==null||o.setModalProps({modelValue:!1})},setModalProps:o=>{var l;(l=n())==null||l.setModalProps(o)},redoModalHeight:()=>{var l;const o=(l=n())==null?void 0:l.redoModalHeight;o&&o()}}]},Fo=we(ho);export{Fo as B,So as a,Bo as b,$o as u};
