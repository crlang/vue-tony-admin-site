var V=(n,i,p)=>new Promise((o,h)=>{var a=d=>{try{_(p.next(d))}catch(g){h(g)}},s=d=>{try{_(p.throw(d))}catch(g){h(g)}},_=d=>d.done?o(d.value):Promise.resolve(d.value).then(a,s);_((p=p.apply(n,i)).next())});import{d as H,o as M,f as k,g as r,h as f,b as e,r as $,dz as J,aR as O,bG as W,dq as P,eC as I,bJ as Q,by as X,R as L,c as U,w as Y,j as Z,i as F,s as z,n as m,E as ee,di as G,v as j,am as ne,bk as te,t as se,bF as oe,k as ae,as as le,b_ as re,l as ie,_ as ue,e as N}from"./index.12e2b36d.js";import{I as S}from"./index.e7a25dd6.js";import{g as ce,f as pe,C as de}from"./index.994f713c.js";import{u as fe}from"./index.e79189fa.js";import{E as me}from"./index.77e99735.js";import"./index.651c0a69.js";import"./index.a21af5b0.js";import"./useTimeout.b1e16c0a.js";import"./_baseUniq.bcd65e0c.js";import"./_baseIsEqual.df6af5a3.js";import"./index.87f8f9e1.js";import"./dropdown.28433873.js";import"./index.a2058803.js";import"./useWindowSizeFn.5d430d85.js";import"./index.9cb3f094.js";import"./index.f06d033e.js";import"./drawer.06fffbf8.js";import"./use-dialog.24721d6a.js";import"./index.b028bbcd.js";import"./refs.b779a62e.js";import"./index.00e0b22a.js";import"./index.dbcaacfe.js";import"./lock.2e7e9a82.js";const he=r("span",null,"\u786E\u8BA4",-1),ve=r("span",null,"\u5207\u6362",-1),_e=r("span",null,"\u5173\u95ED",-1),ge=H({__name:"AppSearchFooter",setup(n){return(i,p)=>(M(),k("div",null,[r("div",null,[r("span",null,[f(e(S),{name:"uil:enter"})]),he]),r("div",null,[r("span",null,[f(e(S),{name:"ion:arrow-up-outline"})]),r("span",null,[f(e(S),{name:"ion:arrow-down-outline"})]),ve]),r("div",null,[r("span",null,[f(e(S),{name:"mdi:keyboard-esc"})]),_e])]))}});function we(){const n=$([]);return J(()=>{n.value=[]}),[n,p=>o=>{n.value[p]=o}]}function $e(n){return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(n)?`\\${n}`:n}function Ce(n){const i=[...n].map(o=>$e(o)),p=["",...i,""].join(".*");return new RegExp(p)}function Me(n,i,p){const o=$([]),h=$(""),a=$(-1);let s=[];const _=O(),d=Q(g,200);W(()=>V(this,null,function*(){const l=yield ce();s=P(l)}));function g(l){if(h.value=l.trim(),!l){o.value=[];return}const u=Ce(e(h)),c=X(s,t=>u.test(t.name)&&!t.hideMenu);o.value=R(c,u),a.value=0}function R(l,u,c){const t=[];return l.forEach(v=>{const{name:w,path:C,icon:K,children:y,hideMenu:q,meta:b}=v;!q&&u.test(w)&&(!(y!=null&&y.length)||(b==null?void 0:b.hideChildrenInMenu))&&t.push({name:c!=null&&c.name?`${c.name} > ${w}`:w,path:C,icon:K}),!(b!=null&&b.hideChildrenInMenu)&&Array.isArray(y)&&y.length&&t.push(...R(y,u,v))}),t}function E(l){const u=l.target.dataset.index;a.value=Number(u)}function B(){!o.value.length||(a.value--,a.value<0&&(a.value=o.value.length-1),x())}function T(){!o.value.length||(a.value++,a.value>o.value.length-1&&(a.value=0),x())}function x(){const l=e(n);if(!l||!Array.isArray(l)||l.length===0||!e(i))return;const u=e(a),c=l[u];if(!c)return;const t=e(i);if(!t)return;const v=c.offsetTop+c.offsetHeight,w=t.offsetHeight,{start:C}=fe({el:t,duration:100,to:v-w});C()}function A(){return V(this,null,function*(){if(!o.value.length)return;const l=e(o),u=e(a);if(l.length===0||u<0)return;const c=l[u];D(),yield L(),_(c.path)})}function D(){o.value=[],p("close")}return I("Enter",A),I("ArrowUp",B),I("ArrowDown",T),I("Escape",D),{handleSearch:d,searchResult:o,keyword:h,activeIndex:a,handleMouseenter:E,handleEnter:A}}const ye=["data-index"],be=H({__name:"AppSearchModal",props:{visible:{type:Boolean}},emits:["close"],setup(n,{emit:i}){const p=n,o=$(null),h=$(null),a=$(""),{prefixCls:s}=ie("header-search-modal"),[_,d]=we(),{getIsMobile:g}=pe(),{handleSearch:R,searchResult:E,keyword:B,activeIndex:T,handleEnter:x,handleMouseenter:A}=Me(_,o,i),D=U(()=>!B||e(E).length===0),l=U(()=>[s,{[`${s}--mobile`]:e(g)}]);Y(()=>p.visible,c=>{c&&L(()=>{var t;a.value="",(t=e(h))==null||t.focus()})});function u(){E.value=[],i("close")}return(c,t)=>(M(),Z(re,{to:"body"},[f(le,{name:"zoom-fade",mode:"out-in"},{default:F(()=>[n.visible?(M(),k("div",{key:0,class:m(e(l)),onClick:t[3]||(t[3]=oe(()=>{},["stop"]))},[z((M(),k("div",{class:m(`${e(s)}-content`)},[r("div",{class:m(`${e(s)}-input__wrapper`)},[f(e(ee),{class:m(`${e(s)}-input`),placeholder:"\u641C\u7D22",ref_key:"inputRef",ref:h,clearable:"",modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=v=>a.value=v),onInput:e(R)},{prefix:F(()=>[f(e(G))]),_:1},8,["class","modelValue","onInput"]),r("span",{class:m(`${e(s)}-cancel`),onClick:u}," \u53D6\u6D88 ",2)],2),z(r("div",{class:m(`${e(s)}-nodata`)}," \u6682\u65E0\u641C\u7D22\u7ED3\u679C ",2),[[j,e(D)]]),z(r("ul",{class:m(`${e(s)}-list`),ref_key:"scrollWrap",ref:o},[(M(!0),k(ne,null,te(e(E),(v,w)=>(M(),k("li",{ref_for:!0,ref:e(d)(w),key:v.path,"data-index":w,onMouseenter:t[1]||(t[1]=(...C)=>e(A)&&e(A)(...C)),onClick:t[2]||(t[2]=(...C)=>e(x)&&e(x)(...C)),class:m([`${e(s)}-list__item`,{[`${e(s)}-list__item--active`]:e(T)===w}])},[r("div",{class:m(`${e(s)}-list__item-icon`)},[f(e(S),{name:v.icon||"mdi:form-select",size:20},null,8,["name"])],2),r("div",{class:m(`${e(s)}-list__item-text`)},se(v.name),3),r("div",{class:m(`${e(s)}-list__item-enter`)},[f(e(S),{name:"uil:enter",size:20})],2)],42,ye))),128))],2),[[j,!e(D)]]),f(ge,{class:m(`${e(s)}-footer`)},null,8,["class"])],2)),[[e(de),u]])],2)):ae("",!0)]),_:1})]))}}),ke=H({name:"AppSearch",components:{ElTooltip:me,AppSearchModal:be,Search:G},setup(){return{showModal:$(!1)}}});function Se(n,i,p,o,h,a){const s=N("Search"),_=N("ElTooltip"),d=N("AppSearchModal");return M(),k("div",{onClick:i[1]||(i[1]=g=>n.showModal=!0)},[f(_,{effect:"dark",content:"\u641C\u7D22",placement:"bottom-end"},{default:F(()=>[r("span",null,[f(s)])]),_:1}),f(d,{onClose:i[0]||(i[0]=g=>n.showModal=!1),visible:n.showModal},null,8,["visible"])])}var Xe=ue(ke,[["render",Se]]);export{Xe as default};
