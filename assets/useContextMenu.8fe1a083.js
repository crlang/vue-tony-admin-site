var j=Object.defineProperty,k=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var g=(t,e,s)=>e in t?j(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,w=(t,e)=>{for(var s in e||(e={}))D.call(e,s)&&g(t,s,e[s]);if(_)for(var s of _(e))S.call(e,s)&&g(t,s,e[s]);return t},C=(t,e)=>k(t,O(e));import{d as A,r as I,c as N,Y as P,R,ab as M,b as h,h as u,cA as H,l as U,am as V,d_ as W,U as Y}from"./index.61be89a1.js";import{I as q}from"./index.ee8c97d5.js";import{b as B,a as F,E as T}from"./index.21f47639.js";function X(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!H(t)}var z=A({name:"ContextMenu",props:{items:{type:Array,default(){return[]}},width:{type:Number,default:156},event:{type:Object,default:null},styles:Object,showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}}},setup(t){const e=I(null),s=I(!1),{prefixCls:f}=U("context-menu"),y=N(()=>{const{axis:o,items:n,styles:l,width:r}=t,{x:c,y:i}=o||{x:0,y:0},m=(n||[]).length*44,b=r,x=document.body,L=x.clientWidth<c+b?c-b:c,$=x.clientHeight<i+m?i-m:i;return C(w({},l),{width:`${r}px`,left:`${L+1}px`,top:`${$+1}px`})}),p=o=>{const{item:n,handler:l,showIcon:r}=o;return u("div",{class:`${f}__text`,onClick:l.bind(null,n)},[r&&n.icon&&u(q,{class:"mr-2",name:n.icon},null),u("span",null,[n.label])])};function v(o,n){const{handler:l,disabled:r}=o;r||(s.value=!1,n==null||n.stopPropagation(),n==null||n.preventDefault(),l==null||l())}function a(o){return o.map(n=>{const{disabled:l,label:r,children:c,divider:i=!1}=n,m={item:n,handler:v,showIcon:t.showIcon};return!c||c.length===0?u(V,null,[u(F,{disabled:l,class:`${f}__item ${i?"is-divider":""}`,index:r},{default:()=>[u(p,m,null)]})]):h(s)?u(T,{index:r,disabled:l,"popper-class":`${f}__popup`},{title:()=>u(p,m,null),default:()=>a(c)}):null})}return P(()=>{R(()=>s.value=!0)}),M(()=>{const o=h(e);o&&document.body.removeChild(o)}),()=>{let o;if(!h(s))return null;const{items:n}=t;return u(B,{"default-active":"12",mode:"vertical",collapse:!0,"unique-opened":!0,"menu-trigger":"hover",class:f,ref:e,style:h(y)},X(o=a(n))?o:{default:()=>[o]})}}});const d={domList:[],resolve:()=>{}},G=function(t){const{event:e=null,showIcon:s=!0,styles:f={},items:y,width:p}=t||{};if(e&&(e==null||e.preventDefault()),typeof window!="undefined")return new Promise(v=>{const a=document.body,o=document.createElement("div"),n={event:e,styles:f,showIcon:s,items:y,width:p,axis:{x:(e==null?void 0:e.clientX)||0,y:(e==null?void 0:e.clientY)||0}},l=u(z,n);W(l,o);const r=function(){d.resolve("")};d.domList.push(o);const c=function(){d.domList.forEach(i=>{try{i&&a.removeChild(i)}catch(m){}}),a.removeEventListener("click",r),a.removeEventListener("scroll",r)};d.resolve=function(i){c(),v(i)},c(),a.appendChild(o),a.addEventListener("click",r),a.addEventListener("scroll",r)})},E=function(){d&&(d.resolve(""),d.domList=[])};function ee(t=!0){return Y()&&t&&M(()=>{E()}),[G,E]}export{ee as u};
