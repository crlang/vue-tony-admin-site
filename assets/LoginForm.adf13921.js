var V=(v,a,n)=>new Promise((c,m)=>{var p=o=>{try{u(n.next(o))}catch(i){m(i)}},f=o=>{try{u(n.throw(o))}catch(i){m(i)}},u=o=>o.done?c(o.value):Promise.resolve(o.value).then(p,f);u((n=n.apply(v,a)).next())});import{x as F,M as g,I as h,y as I,u as e,B,C as D,z as M,Y as N,a2 as l,$ as t,al as E,aV as y,aS as x,aW as T,aa as w,F as S,aJ as _,aR as U,aX as $,t as j}from"./vendor.1ced56aa.js";import{e as z,f as O,h as P}from"./index.b7d256c2.js";import{u as W,a as A,L as R,b as G}from"./useLogin.694314ea.js";const H=F({setup(v){const{t:a}=z(),{notification:n}=O(),c=P(),{setLoginState:m,getLoginState:p}=W(),{getFormRules:f}=A(),u=g(),o=g(!1),i=g(!1),r=h({account:"tony",password:"123456"}),{validForm:L}=G(u),b=I(()=>e(p)===R.LOGIN);function k(){return V(this,null,function*(){if(!!(yield L()))try{o.value=!0;const s=yield c.login(j({password:r.password,username:r.account,mode:"none"}));s&&n.success({title:a("sys.login.loginSuccessTitle"),message:`${a("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3e3})}catch(s){n.error({title:a("sys.api.errorTip"),message:s.message||a("sys.api.networkExceptionMsg")})}finally{o.value=!1}})}return(C,s)=>B((M(),N(e($),{model:e(r),rules:e(f),ref_key:"formRef",ref:u},{default:l(()=>[t(e(y),{prop:"account"},{default:l(()=>[t(e(E),{modelValue:e(r).account,"onUpdate:modelValue":s[0]||(s[0]=d=>e(r).account=d),placeholder:e(a)("sys.login.userName")},null,8,["modelValue","placeholder"])]),_:1}),t(e(y),{prop:"password",class:"mb-1"},{default:l(()=>[t(e(E),{modelValue:e(r).password,"onUpdate:modelValue":s[1]||(s[1]=d=>e(r).password=d),placeholder:e(a)("sys.login.password")},null,8,["modelValue","placeholder"])]),_:1}),t(e(U),{class:"mt-3"},{default:l(()=>[t(e(x),{span:12},{default:l(()=>[t(e(T),{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=d=>i.value=d),size:"small"},{default:l(()=>[w(S(e(a)("sys.login.rememberMe")),1)]),_:1},8,["modelValue"])]),_:1}),t(e(x),{span:12,class:"text-right"},{default:l(()=>[t(e(_),{type:"text",onClick:s[3]||(s[3]=d=>e(m)(e(R).RESET_PASSWORD))},{default:l(()=>[w(S(e(a)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1}),t(e(y),null,{default:l(()=>[t(e(_),{type:"primary",class:"login--submit",loading:o.value,onClick:k},{default:l(()=>[w(S(e(a)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])),[[D,e(b)]])}});export{H as default};
