var j=Object.defineProperty,k=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var g=(t,e,s)=>e in t?j(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,w=(t,e)=>{for(var s in e||(e={}))S.call(e,s)&&g(t,s,e[s]);if(_)for(var s of _(e))D.call(e,s)&&g(t,s,e[s]);return t},C=(t,e)=>k(t,O(e));import{E as N,r as I,f as P,o as R,n as A,a as M,u as h,S as u,z as H,R as V,at as W,g as q}from"./vue-d691a816.js";import{I as z}from"./index-a2d8523e.js";import{b as B}from"./index-795cdaa0.js";import{v as F,s as T,r as U}from"./elementui-66980f2a.js";function X(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!H(t)}const Y=N({name:"ContextMenu",props:{items:{type:Array,default(){return[]}},width:{type:Number,default:156},event:{type:Object,default:null},styles:Object,showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}}},setup(t){const e=I(null),s=I(!1),{prefixCls:f}=B("context-menu"),y=P(()=>{const{axis:o,items:n,styles:l,width:r}=t,{x:c,y:i}=o||{x:0,y:0},m=(n||[]).length*44,x=r,b=document.body,L=b.clientWidth<c+x?c-x:c,$=b.clientHeight<i+m?i-m:i;return C(w({},l),{width:`${r}px`,left:`${L+1}px`,top:`${$+1}px`})}),p=o=>{const{item:n,handler:l,showIcon:r}=o;return u("div",{class:`${f}__text`,onClick:l.bind(null,n)},[r&&n.icon&&u(z,{class:"mr-2",name:n.icon},null),u("span",null,[n.label])])};function v(o,n){const{handler:l,disabled:r}=o;r||(s.value=!1,n==null||n.stopPropagation(),n==null||n.preventDefault(),l==null||l())}function a(o){return o.map(n=>{const{disabled:l,label:r,children:c,divider:i=!1}=n,m={item:n,handler:v,showIcon:t.showIcon};return!c||c.length===0?u(V,null,[u(T,{disabled:l,class:`${f}__item ${i?"is-divider":""}`,index:r},{default:()=>[u(p,m,null)]})]):h(s)?u(U,{index:r,disabled:l,"popper-class":`${f}__popup`},{title:()=>u(p,m,null),default:()=>a(c)}):null})}return R(()=>{A(()=>s.value=!0)}),M(()=>{const o=h(e);o&&document.body.removeChild(o)}),()=>{let o;if(!h(s))return null;const{items:n}=t;return u(F,{"default-active":"12",mode:"vertical",collapse:!0,"unique-opened":!0,"menu-trigger":"hover",class:f,ref:e,style:h(y)},X(o=a(n))?o:{default:()=>[o]})}}});const d={domList:[],resolve:()=>{}},G=function(t){const{event:e=null,showIcon:s=!0,styles:f={},items:y,width:p}=t||{};if(e&&(e==null||e.preventDefault()),typeof window!="undefined")return new Promise(v=>{const a=document.body,o=document.createElement("div"),n={event:e,styles:f,showIcon:s,items:y,width:p,axis:{x:(e==null?void 0:e.clientX)||0,y:(e==null?void 0:e.clientY)||0}},l=u(Y,n);W(l,o);const r=function(){d.resolve("")};d.domList.push(o);const c=function(){d.domList.forEach(i=>{try{i&&a.removeChild(i)}catch(m){}}),a.removeEventListener("click",r),a.removeEventListener("scroll",r)};d.resolve=function(i){c(),v(i)},c(),a.appendChild(o),a.addEventListener("click",r),a.addEventListener("scroll",r)})},E=function(){d&&(d.resolve(""),d.domList=[])};function te(t=!0){return q()&&t&&M(()=>{E()}),[G,E]}export{te as u};
