var V=(v,a,n)=>new Promise((m,c)=>{var f=o=>{try{u(n.next(o))}catch(i){c(i)}},p=o=>{try{u(n.throw(o))}catch(i){c(i)}},u=o=>o.done?m(o.value):Promise.resolve(o.value).then(f,p);u((n=n.apply(v,a)).next())});import{x as F,M as g,I,y as h,u as e,B,C as D,z as M,Z as N,a3 as l,a0 as t,am as E,aU as y,aR as x,aV as U,ab as w,F as S,aI as _,aQ as T,aW as j,t as $}from"./vendor.041d4bc7.js";import{e as z,f as O,h as P}from"./index.c38c7de5.js";import{u as W,a as A,L as R,b as G}from"./useLogin.a30c7e7f.js";const J=F({setup(v){const{t:a}=z(),{notification:n}=O(),m=P(),{setLoginState:c,getLoginState:f}=W(),{getFormRules:p}=A(),u=g(),o=g(!1),i=g(!1),r=I({account:"tony",password:"123456"}),{validForm:b}=G(u),L=h(()=>e(f)===R.LOGIN);function k(){return V(this,null,function*(){if(!!(yield b()))try{o.value=!0;const s=yield m.login($({password:r.password,username:r.account,mode:"none"}));s&&n.success({title:a("sys.login.loginSuccessTitle"),message:`${a("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3e3})}catch(s){n.error({title:a("sys.api.errorTip"),message:s.message||a("sys.api.networkExceptionMsg")})}finally{o.value=!1}})}return(C,s)=>B((M(),N(e(j),{model:e(r),rules:e(p),ref_key:"formRef",ref:u},{default:l(()=>[t(e(y),{prop:"account"},{default:l(()=>[t(e(E),{modelValue:e(r).account,"onUpdate:modelValue":s[0]||(s[0]=d=>e(r).account=d),placeholder:e(a)("sys.login.userName")},null,8,["modelValue","placeholder"])]),_:1}),t(e(y),{prop:"password",class:"mb-1"},{default:l(()=>[t(e(E),{modelValue:e(r).password,"onUpdate:modelValue":s[1]||(s[1]=d=>e(r).password=d),placeholder:e(a)("sys.login.password")},null,8,["modelValue","placeholder"])]),_:1}),t(e(T),{class:"mt-3"},{default:l(()=>[t(e(x),{span:12},{default:l(()=>[t(e(U),{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=d=>i.value=d),size:"small"},{default:l(()=>[w(S(e(a)("sys.login.rememberMe")),1)]),_:1},8,["modelValue"])]),_:1}),t(e(x),{span:12,class:"text-right"},{default:l(()=>[t(e(_),{type:"text",onClick:s[3]||(s[3]=d=>e(c)(e(R).RESET_PASSWORD))},{default:l(()=>[w(S(e(a)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1}),t(e(y),null,{default:l(()=>[t(e(_),{type:"primary",class:"login--submit",loading:o.value,onClick:k},{default:l(()=>[w(S(e(a)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])),[[D,e(L)]])}});export{J as default};
