var me=Object.defineProperty,ge=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var ee=(e,o,l)=>o in e?me(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,p=(e,o)=>{for(var l in o||(o={}))he.call(o,l)&&ee(e,l,o[l]);if(x)for(var l of x(o))ye.call(o,l)&&ee(e,l,o[l]);return e},T=(e,o)=>ge(e,pe(o));var N=(e,o,l)=>new Promise((c,a)=>{var i=u=>{try{n(l.next(u))}catch(s){a(s)}},t=u=>{try{n(l.throw(u))}catch(s){a(s)}},n=u=>u.done?c(u.value):Promise.resolve(u.value).then(i,t);n((l=l.apply(e,o)).next())});import{as as Ce,e as te,_ as A,K as be,L as ve,Y as Me,x as Be,ah as He,a0 as $e,u as Fe,i as oe,ap as Te,ab as Ve,ad as ne,w as ke}from"./index.54cb4205.js";import{u as we}from"./useAttrs.e78ff19a.js";import{ad as De,z as Se,d as Re}from"./ex-pkg-element-plus.e1a09009.js";import{c2 as le,a as Pe}from"./ex-pkg-vendor.ab2d902e.js";import{y as L,a as h,l as M,w as j,Z as v,z as y,G as $,H as g,B as C,D as V,u as r,b as ae,q as Ee,an as Oe,U as k,a2 as We,I as Ae,A as Y,Y as Le,L as _,P as K,Q as G,O as I,a7 as je,R as w,K as U,F as Ie,m as Q,af as se,a3 as ze,ag as qe,ah as Ne,_ as re,ak as X}from"./ex-pkg-@vue.dfd8e273.js";import{u as Ye}from"./useWindowSizeFn.732207ab.js";import{f as _e}from"./ex-pkg-@vueuse.e5d644bd.js";const{t:Z}=te(),ie={showClose:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},helpMessage:{type:[String,Array],default:""}},ue={useWrapper:{type:Boolean,default:!0},footerOffset:{type:Number,default:0},loading:{type:Boolean,default:!1},loadingTip:{type:String,default:Z("common.loadingText")},modalHeaderHeight:{type:Number,default:56},modalFooterHeight:{type:Number,default:70}},ce={showFooter:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},cancelText:{type:String,default:Z("common.cancelText")},cancelButton:{type:Object},showConfirm:{type:Boolean,default:!0},confirmText:{type:String,default:Z("common.confirmText")},confirmButton:{type:Object}},de=T(p(p(p(p({},Ce),ie),ue),ce),{modelValue:{type:Boolean},draggable:{type:Boolean,default:!0},scrollTop:{type:Boolean,default:!0},closeFunc:Function,onOpen:Function,onOpened:Function,onClose:Function,onClosed:Function}),Ue=L({name:"BasicDialog",components:{ElDialog:De},inheritAttrs:!1,props:de,setup(e){const o=h(!1),l=we(),c=M(()=>{const a=p(p({},r(l)),e),i=le(a,["showFullscreen","helpMessage","useWrapper","footerOffset","loading","scrollTop","loadingTip","modalHeaderHeight","modalFooterHeight","showFooter","showCancel","cancelText","showConfirm","confirmText","closeFunc","draggable","confirmButton","cancelButton"]);return i.showClose=!1,i});return j(()=>{o.value=!!e.modelValue}),{visibleRef:o,getBindValue:c}}});function Xe(e,o,l,c,a,i){const t=v("ElDialog");return y(),$(t,V(e.getBindValue,{modelValue:e.visibleRef,"onUpdate:modelValue":o[0]||(o[0]=n=>e.visibleRef=n)}),{title:g(()=>[C(e.$slots,"title")]),footer:g(()=>[C(e.$slots,"footer")]),default:g(()=>[C(e.$slots,"default")]),_:3},16,["modelValue"])}var Ke=A(Ue,[["render",Xe]]);const fe=Symbol();function Ge(e){return be(e,fe)}function Ct(){return ve(fe)}const Qe=L({name:"ModalWrapper",components:{ScrollContainer:Me},inheritAttrs:!1,props:p({modelValue:{type:Boolean},fullscreen:{type:Boolean},customClass:{type:String}},ue),emits:["height-change","ext-height"],setup(e,{emit:o}){const l=h(null),c=h(null),a=h(0),i=h(0);let t=0;Ye(s.bind(null,!1)),_e(c,()=>{s()},{attributes:!0,subtree:!0}),Ge({redoModalHeight:s});const n=M(()=>({[e.fullscreen?"height":"maxHeight"]:`${r(a)}px`}));j(()=>{e.useWrapper&&s()}),ae(()=>e.fullscreen,f=>{s(),f?i.value=a.value:a.value=i.value}),Ee(()=>{const{modalHeaderHeight:f,modalFooterHeight:m}=e;o("ext-height",f+m)}),Oe(()=>{});function u(){return N(this,null,function*(){k(()=>{var m;const f=r(l);!f||(m=f==null?void 0:f.scrollTo)==null||m.call(f,0)})})}function s(){return N(this,null,function*(){if(!e.modelValue)return;const f=r(l);if(!f)return;const m=f.$el.parentElement;if(!!m){yield k();try{const B=m.parentElement;if(!B)return;const D=B.offsetTop;let H=window.innerHeight-D*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;D<40&&(H-=26),yield k();const F=r(c);if(!F)return;yield k(),t=F.scrollHeight,e.fullscreen?a.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:a.value=t>H?H:t,o("height-change",r(a))}catch(B){console.warn(B)}}})}return{wrapperRef:l,spinRef:c,spinStyle:n,scrollTop:u,setModalHeight:s}}}),Ze=["element-loading-text"];function Je(e,o,l,c,a,i){const t=v("ScrollContainer"),n=We("loading");return y(),$(t,{ref:"wrapperRef",class:_(e.customClass)},{default:g(()=>[Ae((y(),Y("div",{ref:"spinRef",style:Le(e.spinStyle),"element-loading-text":e.loadingTip},[C(e.$slots,"default")],12,Ze)),[[n,e.loading]])]),_:3},8,["class"])}var xe=A(Qe,[["render",Je]]);const et=L({name:"BasicModalFooter",components:{ElButton:Se},inheritAttrs:!1,props:T(p({},ce),{customClass:{type:String}}),emits:["ok","cancel"],setup(e,{emit:o}){function l(a){o("ok",a)}function c(a){o("cancel",a)}return{handleOk:l,handleCancel:c}}});function tt(e,o,l,c,a,i){var n,u;const t=v("ElButton");return e.showFooter?(y(),Y("div",{key:0,class:_(e.customClass)},[C(e.$slots,"insertFooter"),e.showCancel?(y(),$(t,V({key:0},e.cancelButton,{type:((n=e.cancelButton)==null?void 0:n.type)||"default",onClick:e.handleCancel}),{default:g(()=>[K(G(e.cancelText),1)]),_:1},16,["type","onClick"])):I("",!0),C(e.$slots,"centerFooter"),e.showConfirm?(y(),$(t,V({key:1},e.confirmButton,{type:((u=e.confirmButton)==null?void 0:u.type)||"primary",onClick:e.handleOk}),{default:g(()=>[K(G(e.confirmText),1)]),_:1},16,["type","onClick"])):I("",!0),C(e.$slots,"appendFooter")],2)):I("",!0)}var ot=A(et,[["render",tt]]);function nt(e){const o=(a,i)=>getComputedStyle(a)[i],l=a=>{if(!a)return;a.setAttribute("data-drag",r(e.draggable));const i=a.querySelector(".el-dialog__header"),t=a.querySelector(".el-dialog");!i||!t||!r(e.draggable)||(i.style.cursor="move",i.classList.add("is-drag"),i.onmousedown=n=>{if(!n)return;const u=n.clientX,s=n.clientY,f=document.body.clientWidth,m=document.documentElement.clientHeight,B=t.offsetWidth,D=t.offsetHeight,H=t.offsetLeft,F=f-t.offsetLeft-B,q=t.offsetTop,R=m-t.offsetTop-D,S=o(t,"left"),P=o(t,"top");let E=+S,O=+P;S.includes("%")?(E=+document.body.clientWidth*(+S.replace(/%/g,"")/100),O=+document.body.clientHeight*(+P.replace(/%/g,"")/100)):(E=+S.replace(/px/g,""),O=+P.replace(/px/g,"")),document.onmousemove=function(d){let b=d.clientX-u,W=d.clientY-s;-b>H?b=-H:b>F&&(b=F),-W>q?W=-q:W>R&&(W=R),t.style.cssText+=`;left:${b+E}px;top:${W+O}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},c=()=>{const a=document.querySelectorAll(".el-overlay");for(const i of Array.from(a)){if(!i)continue;const t=o(i,"display"),n=i.getAttribute("data-drag");t!=="none"&&(n===null||r(e.destroyOnClose))&&l(i)}};j(()=>{!r(e.modelValue)||!r(e.draggable)||Be(()=>{c()},30)})}const lt=L({name:"BasicModalHeader",components:{ElTooltip:Re,BasicTitle:He,SvgIcon:$e},inheritAttrs:!1,props:p({modelValue:{type:Boolean},destroyOnClose:{type:Boolean},fullscreen:{type:Boolean},draggable:{type:Boolean},customClass:{type:String},customTitle:{type:String}},ie),emits:["cancel","fullscreen"],setup(e,{emit:o}){const{t:l}=te(),{modelValue:c,draggable:a,destroyOnClose:i}=je(e);nt({modelValue:c,destroyOnClose:i,draggable:a});function t(s){!e.showFullscreen||(s.stopPropagation(),u(s))}function n(s){o("cancel",s)}function u(s){s==null||s.stopPropagation(),s==null||s.preventDefault(),o("fullscreen")}return{t:l,handleCancel:n,handleFullscreen:u,handleTitleDbClick:t}}});function at(e,o,l,c,a,i){const t=v("BasicTitle"),n=v("SvgIcon"),u=v("ElTooltip");return y(),Y("div",{class:_(e.customClass),onDblclick:o[3]||(o[3]=(...s)=>e.handleTitleDbClick&&e.handleTitleDbClick(...s))},[w(t,{helpMessage:e.helpMessage},{default:g(()=>[K(G(e.customTitle),1)]),_:1},8,["helpMessage"]),U("div",{class:_(`${e.customClass}__extra`)},[e.showFullscreen?(y(),Y(Ie,{key:0},[e.fullscreen?(y(),$(u,{key:0,content:e.t("component.modal.restore"),placement:"bottom"},{default:g(()=>[U("span",{onClick:o[0]||(o[0]=(...s)=>e.handleFullscreen&&e.handleFullscreen(...s))},[w(n,{name:"fullscreen-exit"})])]),_:1},8,["content"])):(y(),$(u,{key:1,content:e.t("component.modal.maximize"),placement:"bottom"},{default:g(()=>[U("span",{onClick:o[1]||(o[1]=(...s)=>e.handleFullscreen&&e.handleFullscreen(...s))},[w(n,{name:"fullscreen"})])]),_:1},8,["content"]))],64)):I("",!0),e.showClose?(y(),$(u,{key:1,content:e.t("component.modal.close"),placement:"bottom"},{default:g(()=>[U("span",{onClick:o[2]||(o[2]=(...s)=>e.handleCancel&&e.handleCancel(...s))},[w(n,{name:"close"})])]),_:1},8,["content"])):I("",!0)],2)],34)}var st=A(lt,[["render",at]]);const rt=L({name:"BasicModal",components:{Modal:Ke,ModalWrapper:xe,ModalFooter:ot,ModalHeader:st},inheritAttrs:!1,props:de,emits:["visible-change","height-change","cancel","ok","register","update:modelValue"],setup(e,{emit:o}){const l=h(!1),c=h(null),a=h(null),{prefixCls:i}=Fe("basic-modal"),t=h(!1),n=h(!1),u=h(0),s={setModalProps:R,emitVisible:void 0,redoModalHeight:()=>{k(()=>{r(a)&&r(a).setModalHeight()})}},f=Q();f&&o("register",s,f.uid);const m=M(()=>p(p({},e),r(c))),B=M(()=>T(p({},r(m)),{fullscreen:r(t),draggable:r(n),customClass:i})),D=M(()=>T(p({},r(m)),{fullscreen:r(t),modelValue:r(l),draggable:r(n),customClass:`${i}__header`,customTitle:r(m).title})),H=M(()=>T(p({},r(m)),{fullscreen:r(t),modelValue:r(l),customClass:`${i}__body`})),F=M(()=>T(p({},r(m)),{customClass:`${i}__footer`}));j(()=>{l.value=!!e.modelValue,t.value=!!e.fullscreen,n.value=!!e.draggable}),ae(()=>r(l),d=>{var b;o("visible-change",d),o("update:modelValue",d),f&&((b=s.emitVisible)==null||b.call(s,d,f.uid)),k(()=>{(e==null?void 0:e.scrollTop)&&d&&r(a)&&r(a).scrollTop()})},{immediate:!1});function q(d){return N(this,null,function*(){if(d==null||d.stopPropagation(),e.closeFunc&&oe(e.closeFunc)){const b=yield e.closeFunc();l.value=!b;return}l.value=!1,o("cancel",d)})}function R(d){c.value=Te(r(c)||{},d),Reflect.has(d,"modelValue")&&(l.value=!!d.modelValue),Reflect.has(d,"fullscreen")&&(t.value=!!d.fullscreen)}function S(d){o("ok",d)}function P(d){o("height-change",d)}function E(d){u.value=d}function O(){R({fullscreen:!r(t)})}return{prefixCls:i,handleCancel:q,getBaiscBindValue:B,getHeaderBindValue:D,getWrapperBindValue:H,getFooterBindValue:F,handleFullscreen:O,fullscreenRef:t,getMergeProps:m,handleOk:S,visibleRef:l,draggableRef:n,omit:le,modalWrapperRef:a,handleExtHeight:E,handleHeightChange:P}}});function it(e,o,l,c,a,i){const t=v("ModalHeader"),n=v("ModalFooter"),u=v("ModalWrapper"),s=v("Modal");return y(),$(s,V(e.getBaiscBindValue,{modelValue:e.visibleRef,"onUpdate:modelValue":o[0]||(o[0]=f=>e.visibleRef=f)}),se({default:g(()=>[w(u,V({ref:"modalWrapperRef"},e.getWrapperBindValue,{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:g(()=>[C(e.$slots,"default")]),_:3},16,["onExtHeight","onHeightChange"])]),_:2},[e.$slots.title?{name:"title",fn:g(()=>[C(e.$slots,"title")])}:{name:"title",fn:g(()=>[w(t,V(e.getHeaderBindValue,{onFullscreen:e.handleFullscreen,onCancel:e.handleCancel}),null,16,["onFullscreen","onCancel"])])},e.$slots.footer?{name:"footer",fn:g(()=>[C(e.$slots,"footer")])}:{name:"footer",fn:g(()=>[w(n,V(e.getFooterBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),se({_:2},[ze(Object.keys(e.$slots),f=>({name:f,fn:g(m=>[C(e.$slots,f,qe(Ne(m||{})))])}))]),1040,["onOk","onCancel"])])}]),1040,["modelValue"])}var ut=A(rt,[["render",it]]);const z=re({}),J=re({});function bt(){const e=h(null),o=h(!1),l=h("");function c(t,n){if(!Q())throw new Error("useModal() can only be used inside setup() or functional components!");l.value=n,!(r(o)&&Ve()&&t===r(e))&&(e.value=t,o.value=!0,t.emitVisible=(u,s)=>{J[s]=u})}const a=()=>{const t=r(e);return t||ne("useModal instance is undefined!"),t},i={setModalProps:t=>{var n;(n=a())==null||n.setModalProps(t)},getVisible:M(()=>J[~~r(l)]),redoModalHeight:()=>{var t,n;(n=(t=a())==null?void 0:t.redoModalHeight)==null||n.call(t)},openModal:(t=!0,n,u=!0)=>{var m;if((m=a())==null||m.setModalProps({modelValue:t}),!n)return;const s=r(l);if(u){z[s]=null,z[s]=X(n);return}Pe(X(z[s]),X(n))||(z[s]=X(n))},closeModal:()=>{var t;(t=a())==null||t.setModalProps({modelValue:!1})}};return[c,i]}const vt=e=>{const o=h(null),l=Q(),c=h(""),a=()=>{const t=r(o);return t||ne("useModalInner instance is undefined!"),t},i=(t,n)=>{c.value=n,o.value=t,l==null||l.emit("register",t,n)};return j(()=>{const t=z[r(c)];!t||!e||!oe(e)||k(()=>{e(t)})}),[i,{changeLoading:(t=!0)=>{var n;(n=a())==null||n.setModalProps({loading:t})},getVisible:M(()=>J[~~r(c)]),changeConfirmLoading:(t=!0)=>{var n;(n=a())==null||n.setModalProps({confirmButton:{loading:t}})},closeModal:()=>{var t;(t=a())==null||t.setModalProps({modelValue:!1})},setModalProps:t=>{var n;(n=a())==null||n.setModalProps(t)},redoModalHeight:()=>{var n;const t=(n=a())==null?void 0:n.redoModalHeight;t&&t()}}]},Mt=ke(ut);export{Mt as B,vt as a,bt as b,Ct as u};
