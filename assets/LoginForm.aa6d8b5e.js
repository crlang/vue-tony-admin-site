var S=(x,o,r)=>new Promise((d,m)=>{var c=a=>{try{u(r.next(a))}catch(i){m(i)}},f=a=>{try{u(r.throw(a))}catch(i){m(i)}},u=a=>a.done?d(a.value):Promise.resolve(a.value).then(c,f);u((r=r.apply(x,o)).next())});import{y as h,a as g,_ as F,l as I,u as e,I as C,J as D,z as N,G as B,H as l,R as t,a9 as K,P as y,Q as w,ak as M}from"./ex-pkg-@vue.dfd8e273.js";import{e as T,f as U,h as z}from"./index.54cb4205.js";import{u as P,a as $,L as E,b as G}from"./useLogin.9a138b63.js";import{f as b,I as k,F as j,J,z as V,D as O,K as A}from"./ex-pkg-element-plus.e1a09009.js";import"./ex-pkg-vendor.ab2d902e.js";import"./ex-pkg-mockjs.0bec78f1.js";import"./ex-pkg-@element-plus.e8ce6c8b.js";import"./ex-pkg-@vueuse.e5d644bd.js";import"./ex-pkg-@iconify.345c6dc9.js";import"./ex-pkg-@popperjs.f3a17871.js";const te=h({setup(x){const{t:o}=T(),{notification:r}=U(),d=z(),{setLoginState:m,getLoginState:c}=P(),{getFormRules:f}=$(),u=g(),a=g(!1),i=g(!1),n=F({account:"",password:""}),{validForm:_}=G(u),R=I(()=>e(c)===E.LOGIN);function v(){return S(this,null,function*(){if(!!(yield _()))try{a.value=!0;const s=yield d.login(M({password:n.password,username:n.account,mode:"none"}));s&&r.success({title:o("sys.login.loginSuccessTitle"),message:`${o("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3e3})}catch(s){r.error({title:o("sys.api.errorTip"),message:s.message||o("sys.api.networkExceptionMsg")})}finally{a.value=!1}})}return(L,s)=>C((N(),B(e(A),{model:e(n),rules:e(f),ref_key:"formRef",ref:u},{default:l(()=>[t(e(k),{prop:"account"},{default:l(()=>[t(e(b),{modelValue:e(n).account,"onUpdate:modelValue":s[0]||(s[0]=p=>e(n).account=p),placeholder:e(o)("sys.login.userNameEg")},null,8,["modelValue","placeholder"])]),_:1}),t(e(k),{prop:"password",class:"mb-1"},{default:l(()=>[t(e(b),{modelValue:e(n).password,"onUpdate:modelValue":s[1]||(s[1]=p=>e(n).password=p),placeholder:e(o)("sys.login.passwordEg"),onKeypress:K(v,["enter"])},null,8,["modelValue","placeholder","onKeypress"])]),_:1}),t(e(O),{class:"mt-3"},{default:l(()=>[t(e(j),{span:12},{default:l(()=>[t(e(J),{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=p=>i.value=p),size:"small"},{default:l(()=>[y(w(e(o)("sys.login.rememberMe")),1)]),_:1},8,["modelValue"])]),_:1}),t(e(j),{span:12,class:"text-right"},{default:l(()=>[t(e(V),{type:"text",onClick:s[3]||(s[3]=p=>e(m)(e(E).RESET_PASSWORD))},{default:l(()=>[y(w(e(o)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1}),t(e(k),null,{default:l(()=>[t(e(V),{type:"primary",class:"login--submit",loading:a.value,onClick:v},{default:l(()=>[y(w(e(o)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])),[[D,e(R)]])}});export{te as default};
