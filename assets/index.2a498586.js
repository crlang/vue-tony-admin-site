var ge=Object.defineProperty,pe=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var ee=(e,o,l)=>o in e?ge(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,p=(e,o)=>{for(var l in o||(o={}))ye.call(o,l)&&ee(e,l,o[l]);if(x)for(var l of x(o))Ce.call(o,l)&&ee(e,l,o[l]);return e},T=(e,o)=>pe(e,he(o));var N=(e,o,l)=>new Promise((u,a)=>{var i=d=>{try{n(l.next(d))}catch(s){a(s)}},t=d=>{try{n(l.throw(d))}catch(s){a(s)}},n=d=>d.done?u(d.value):Promise.resolve(d.value).then(i,t);n((l=l.apply(e,o)).next())});import{at as ve,e as te,_ as I,K as be,L as Me,Y as Be,x as He,ah as $e,Z as Fe,u as Te,i as oe,aq as Ve,ab as we,ad as ne,w as ke}from"./index.a180eed7.js";import{u as De}from"./useAttrs.f893c8ed.js";import{x as L,bW as Se,M as h,y as M,aj as j,X as b,z as y,Y as $,a2 as g,a3 as C,a0 as V,u as r,o as le,bX as Re,O as ae,V as Ee,af as se,W as w,bd as Pe,B as We,A as Y,S as Oe,G as _,aI as Ae,aa as K,F as G,a9 as q,a6 as Ie,R as Le,$ as k,D as X,a7 as je,ae as J,ac as re,ao as qe,aJ as ze,aK as Ne,I as ie,t as U,aY as Ye,ai as _e}from"./vendor.5e678e09.js";import{u as Xe}from"./useWindowSizeFn.c212c501.js";const{t:Z}=te(),ue={showClose:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},helpMessage:{type:[String,Array],default:""}},ce={useWrapper:{type:Boolean,default:!0},footerOffset:{type:Number,default:0},loading:{type:Boolean,default:!1},loadingTip:{type:String,default:Z("common.loadingText")},modalHeaderHeight:{type:Number,default:56},modalFooterHeight:{type:Number,default:70}},de={showFooter:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},cancelText:{type:String,default:Z("common.cancelText")},cancelButton:{type:Object},showConfirm:{type:Boolean,default:!0},confirmText:{type:String,default:Z("common.confirmText")},confirmButton:{type:Object}},fe=T(p(p(p(p({},ve),ue),ce),de),{modelValue:{type:Boolean},scrollTop:{type:Boolean,default:!0},closeFunc:Function,onOpen:Function,onOpened:Function,onClose:Function,onClosed:Function}),Ue=L({name:"BasicDialog",components:{ElDialog:Se},inheritAttrs:!1,props:fe,setup(e){const o=h(!1),l=De(),u=M(()=>{const a=p(p({},r(l)),e),i=le(a,["showFullscreen","helpMessage","useWrapper","footerOffset","loading","scrollTop","loadingTip","modalHeaderHeight","modalFooterHeight","showFooter","showCancel","cancelText","showConfirm","confirmText","closeFunc","draggable","confirmButton","cancelButton"]);return i.showClose=!1,i});return j(()=>{o.value=!!e.modelValue}),{visibleRef:o,getBindValue:u}}});function Ke(e,o,l,u,a,i){const t=b("ElDialog");return y(),$(t,V(e.getBindValue,{modelValue:e.visibleRef,"onUpdate:modelValue":o[0]||(o[0]=n=>e.visibleRef=n)}),{title:g(()=>[C(e.$slots,"title")]),footer:g(()=>[C(e.$slots,"footer")]),default:g(()=>[C(e.$slots,"default")]),_:3},16,["modelValue"])}var Ge=I(Ue,[["render",Ke]]);const me=Symbol();function Je(e){return be(e,me)}function ht(){return Me(me)}const Ze=L({name:"ModalWrapper",components:{ScrollContainer:Be},inheritAttrs:!1,props:p({modelValue:{type:Boolean},fullscreen:{type:Boolean},customClass:{type:String}},ce),emits:["height-change","ext-height"],setup(e,{emit:o}){const l=h(null),u=h(null),a=h(0),i=h(0);let t=0;Xe(s.bind(null,!1)),Re(u,()=>{s()},{attributes:!0,subtree:!0}),Je({redoModalHeight:s});const n=M(()=>({[e.fullscreen?"height":"maxHeight"]:`${r(a)}px`}));j(()=>{e.useWrapper&&s()}),ae(()=>e.fullscreen,f=>{s(),f?i.value=a.value:a.value=i.value}),Ee(()=>{const{modalHeaderHeight:f,modalFooterHeight:m}=e;o("ext-height",f+m)}),se(()=>{});function d(){return N(this,null,function*(){w(()=>{var m;const f=r(l);!f||(m=f==null?void 0:f.scrollTo)==null||m.call(f,0)})})}function s(){return N(this,null,function*(){if(!e.modelValue)return;const f=r(l);if(!f)return;const m=f.$el.parentElement;if(!!m){yield w();try{const B=m.parentElement;if(!B)return;const D=B.offsetTop;let H=window.innerHeight-D*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;D<40&&(H-=26),yield w();const F=r(u);if(!F)return;yield w(),t=F.scrollHeight,e.fullscreen?a.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:a.value=t>H?H:t,o("height-change",r(a))}catch(B){console.warn(B)}}})}return{wrapperRef:l,spinRef:u,spinStyle:n,scrollTop:d,setModalHeight:s}}}),Qe=["element-loading-text"];function xe(e,o,l,u,a,i){const t=b("ScrollContainer"),n=Pe("loading");return y(),$(t,{ref:"wrapperRef",class:_(e.customClass)},{default:g(()=>[We((y(),Y("div",{ref:"spinRef",style:Oe(e.spinStyle),"element-loading-text":e.loadingTip},[C(e.$slots,"default")],12,Qe)),[[n,e.loading]])]),_:3},8,["class"])}var et=I(Ze,[["render",xe]]);const tt=L({name:"BasicModalFooter",components:{ElButton:Ae},inheritAttrs:!1,props:T(p({},de),{customClass:{type:String}}),emits:["ok","cancel"],setup(e,{emit:o}){function l(a){o("ok",a)}function u(a){o("cancel",a)}return{handleOk:l,handleCancel:u}}});function ot(e,o,l,u,a,i){const t=b("ElButton");return e.showFooter?(y(),Y("div",{key:0,class:_(e.customClass)},[C(e.$slots,"insertFooter"),e.showCancel?(y(),$(t,V({key:0},e.cancelButton,{onClick:e.handleCancel}),{default:g(()=>[K(G(e.cancelText),1)]),_:1},16,["onClick"])):q("",!0),C(e.$slots,"centerFooter"),e.showConfirm?(y(),$(t,V({key:1},e.confirmButton,{onClick:e.handleOk}),{default:g(()=>[K(G(e.confirmText),1)]),_:1},16,["onClick"])):q("",!0),C(e.$slots,"appendFooter")],2)):q("",!0)}var nt=I(tt,[["render",ot]]);function lt(e){const o=(a,i)=>getComputedStyle(a)[i],l=a=>{if(!a)return;a.setAttribute("data-drag",r(e.draggable));const i=a.querySelector(".el-dialog__header"),t=a.querySelector(".el-dialog");!i||!t||!r(e.draggable)||(i.style.cursor="move",i.classList.add("is-drag"),i.onmousedown=n=>{if(!n)return;const d=n.clientX,s=n.clientY,f=document.body.clientWidth,m=document.documentElement.clientHeight,B=t.offsetWidth,D=t.offsetHeight,H=t.offsetLeft,F=f-t.offsetLeft-B,z=t.offsetTop,E=m-t.offsetTop-D,S=o(t,"left"),P=o(t,"top");let W=+S,O=+P;S.includes("%")?(W=+document.body.clientWidth*(+S.replace(/%/g,"")/100),O=+document.body.clientHeight*(+P.replace(/%/g,"")/100)):(W=+S.replace(/px/g,""),O=+P.replace(/px/g,"")),document.onmousemove=function(c){let v=c.clientX-d,A=c.clientY-s;-v>H?v=-H:v>F&&(v=F),-A>z?A=-z:A>E&&(A=E),t.style.cssText+=`;left:${v+W}px;top:${A+O}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},u=()=>{const a=document.querySelectorAll(".el-overlay");for(const i of Array.from(a)){if(!i)continue;const t=o(i,"display"),n=i.getAttribute("data-drag");t!=="none"&&(n===null||r(e.destroyOnClose))&&l(i)}};j(()=>{!r(e.modelValue)||!r(e.draggable)||He(()=>{u()},30)})}const at=L({name:"BasicModalHeader",components:{ElTooltip:Ie,BasicTitle:$e,SvgIcon:Fe},inheritAttrs:!1,props:p({modelValue:{type:Boolean},destroyOnClose:{type:Boolean},fullscreen:{type:Boolean},draggable:{type:Boolean},customClass:{type:String},customTitle:{type:String}},ue),emits:["cancel","fullscreen"],setup(e,{emit:o}){const{t:l}=te(),{modelValue:u,draggable:a,destroyOnClose:i}=Le(e);lt({modelValue:u,destroyOnClose:i,draggable:a});function t(s){!e.showFullscreen||(s.stopPropagation(),d(s))}function n(s){o("cancel",s)}function d(s){console.log("eee+++",s),s==null||s.stopPropagation(),s==null||s.preventDefault(),o("fullscreen")}return{t:l,handleCancel:n,handleFullscreen:d,handleTitleDbClick:t}}});function st(e,o,l,u,a,i){const t=b("BasicTitle"),n=b("SvgIcon"),d=b("ElTooltip");return y(),Y("div",{class:_(e.customClass),onDblclick:o[3]||(o[3]=(...s)=>e.handleTitleDbClick&&e.handleTitleDbClick(...s))},[k(t,{helpMessage:e.helpMessage},{default:g(()=>[K(G(e.customTitle),1)]),_:1},8,["helpMessage"]),X("div",{class:_(`${e.customClass}__extra`)},[e.showFullscreen?(y(),Y(je,{key:0},[e.fullscreen?(y(),$(d,{key:0,content:e.t("component.modal.restore"),placement:"bottom"},{default:g(()=>[X("span",{onClick:o[0]||(o[0]=(...s)=>e.handleFullscreen&&e.handleFullscreen(...s))},[k(n,{name:"fullscreen-exit"})])]),_:1},8,["content"])):(y(),$(d,{key:1,content:e.t("component.modal.maximize"),placement:"bottom"},{default:g(()=>[X("span",{onClick:o[1]||(o[1]=(...s)=>e.handleFullscreen&&e.handleFullscreen(...s))},[k(n,{name:"fullscreen"})])]),_:1},8,["content"]))],64)):q("",!0),e.showClose?(y(),$(d,{key:1,content:e.t("component.modal.close"),placement:"bottom"},{default:g(()=>[X("span",{onClick:o[2]||(o[2]=(...s)=>e.handleCancel&&e.handleCancel(...s))},[k(n,{name:"close"})])]),_:1},8,["content"])):q("",!0)],2)],34)}var rt=I(at,[["render",st]]);const it=L({name:"BasicModal",components:{Modal:Ge,ModalWrapper:et,ModalFooter:nt,ModalHeader:rt},inheritAttrs:!1,props:fe,emits:["visible-change","height-change","cancel","ok","register","update:modelValue"],setup(e,{emit:o}){const l=h(!1),u=h(null),a=h(null),{prefixCls:i}=Te("basic-modal"),t=h(!1),n=h(!1),d=h(0),s={setModalProps:E,emitVisible:void 0,redoModalHeight:()=>{w(()=>{r(a)&&r(a).setModalHeight()})}},f=J();f&&o("register",s,f.uid);const m=M(()=>p(p({},e),r(u))),B=M(()=>T(p({},r(m)),{fullscreen:r(t),draggable:r(n),customClass:i})),D=M(()=>T(p({},r(m)),{fullscreen:r(t),modelValue:r(l),draggable:r(n),customClass:`${i}__header`,customTitle:r(m).title})),H=M(()=>T(p({},r(m)),{fullscreen:r(t),modelValue:r(l),customClass:`${i}__body`})),F=M(()=>T(p({},r(m)),{customClass:`${i}__footer`}));j(()=>{l.value=!!e.modelValue,t.value=!!e.fullscreen,n.value=!!e.draggable}),ae(()=>r(l),c=>{var v;o("visible-change",c),o("update:modelValue",c),f&&((v=s.emitVisible)==null||v.call(s,c,f.uid)),w(()=>{(e==null?void 0:e.scrollTop)&&c&&r(a)&&r(a).scrollTop()})},{immediate:!1});function z(c){return N(this,null,function*(){if(c==null||c.stopPropagation(),e.closeFunc&&oe(e.closeFunc)){const v=yield e.closeFunc();l.value=!v;return}l.value=!1,o("cancel",c)})}function E(c){u.value=Ve(r(u)||{},c),Reflect.has(c,"modelValue")&&(l.value=!!c.modelValue),Reflect.has(c,"fullscreen")&&(t.value=!!c.fullscreen)}function S(c){o("ok",c)}function P(c){o("height-change",c)}function W(c){d.value=c}function O(){E({fullscreen:!r(t)})}return{prefixCls:i,handleCancel:z,getBaiscBindValue:B,getHeaderBindValue:D,getWrapperBindValue:H,getFooterBindValue:F,handleFullscreen:O,fullscreenRef:t,getMergeProps:m,handleOk:S,visibleRef:l,draggableRef:n,omit:le,modalWrapperRef:a,handleExtHeight:W,handleHeightChange:P}}});function ut(e,o,l,u,a,i){const t=b("ModalHeader"),n=b("ModalFooter"),d=b("ModalWrapper"),s=b("Modal");return y(),$(s,V(e.getBaiscBindValue,{modelValue:e.visibleRef,"onUpdate:modelValue":o[0]||(o[0]=f=>e.visibleRef=f)}),re({default:g(()=>[k(d,V({ref:"modalWrapperRef"},e.getWrapperBindValue,{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:g(()=>[C(e.$slots,"default")]),_:3},16,["onExtHeight","onHeightChange"])]),_:2},[e.$slots.title?{name:"title",fn:g(()=>[C(e.$slots,"title")])}:{name:"title",fn:g(()=>[k(t,V(e.getHeaderBindValue,{onFullscreen:e.handleFullscreen,onCancel:e.handleCancel}),null,16,["onFullscreen","onCancel"])])},e.$slots.footer?{name:"footer",fn:g(()=>[C(e.$slots,"footer")])}:{name:"footer",fn:g(()=>[k(n,V(e.getFooterBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),re({_:2},[qe(Object.keys(e.$slots),f=>({name:f,fn:g(m=>[C(e.$slots,f,ze(Ne(m||{})))])}))]),1040,["onOk","onCancel"])])}]),1040,["modelValue"])}var ct=I(it,[["render",ut]]);const R=ie({}),Q=ie({});function yt(){const e=h(null),o=h(!1),l=h("");function u(t,n){if(!J())throw new Error("useModal() can only be used inside setup() or functional components!");l.value=n,se(()=>{e.value=null,o.value=!1,R[r(l)]=null}),!(r(o)&&we()&&t===r(e))&&(e.value=t,o.value=!0,t.emitVisible=(d,s)=>{Q[s]=d})}const a=()=>{const t=r(e);return t||ne("useModal instance is undefined!"),t},i={setModalProps:t=>{var n;(n=a())==null||n.setModalProps(t)},getVisible:M(()=>Q[~~r(l)]),redoModalHeight:()=>{var t,n;(n=(t=a())==null?void 0:t.redoModalHeight)==null||n.call(t)},openModal:(t=!0,n,d=!0)=>{var m;if((m=a())==null||m.setModalProps({modelValue:t}),!n)return;const s=r(l);if(d){R[s]=null,R[s]=U(n);return}Ye(U(R[s]),U(n))||(R[s]=U(n))},closeModal:()=>{var t;(t=a())==null||t.setModalProps({modelValue:!1})}};return[u,i]}const Ct=e=>{const o=h(null),l=J(),u=h(""),a=()=>{const t=r(o);return t||ne("useModalInner instance is undefined!"),t},i=(t,n)=>{_e(()=>{o.value=null}),u.value=n,o.value=t,l==null||l.emit("register",t,n)};return j(()=>{const t=R[r(u)];!t||!e||!oe(e)||w(()=>{e(t)})}),[i,{changeLoading:(t=!0)=>{var n;(n=a())==null||n.setModalProps({loading:t})},getVisible:M(()=>Q[~~r(u)]),changeConfirmLoading:(t=!0)=>{var n;(n=a())==null||n.setModalProps({confirmButton:{loading:t}})},closeModal:()=>{var t;(t=a())==null||t.setModalProps({modelValue:!1})},setModalProps:t=>{var n;(n=a())==null||n.setModalProps(t)},redoModalHeight:()=>{var n;const t=(n=a())==null?void 0:n.redoModalHeight;t&&t()}}]},vt=ke(ct);export{vt as B,Ct as a,yt as b,ht as u};
