var $=Object.defineProperty,j=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var v=(t,e,i)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,w=(t,e)=>{for(var i in e||(e={}))D.call(e,i)&&v(t,i,e[i]);if(g)for(var i of g(e))S.call(e,i)&&v(t,i,e[i]);return t},k=(t,e)=>j(t,O(e));import{d as z,r as C,c as N,Y as P,R,ab as E,b as f,h as u,am as V,cB as A,l as B,dV as H,U}from"./index.b263d89e.js";import{I as W}from"./index.26dc116b.js";import{a as Y,E as q,b as F}from"./index.ac2e14a0.js";function T(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!A(t)}var X=z({name:"ContextMenu",props:{items:{type:Array,default(){return[]}},width:{type:Number,default:156},event:{type:Object,default:null},styles:Object,showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}}},setup(t){const e=C(null),i=C(!1),{prefixCls:p}=B("context-menu"),h=N(()=>{const{axis:o,items:n,styles:l,width:r}=t,{x:s,y:c}=o||{x:0,y:0},m=(n||[]).length*44,y=r,_=document.body,M=_.clientWidth<s+y?s-y:s,L=_.clientHeight<c+m?c-m:c;return k(w({},l),{width:`${r}px`,left:`${M+1}px`,top:`${L+1}px`})}),x=o=>{const{item:n,handler:l,showIcon:r}=o;return u("div",{class:`${p}__text`,onClick:l.bind(null,n)},[r&&n.icon&&u(W,{class:"mr-2",name:n.icon},null),u("span",null,[n.label])])};function b(o,n){const{handler:l,disabled:r}=o;r||(i.value=!1,n==null||n.stopPropagation(),n==null||n.preventDefault(),l==null||l())}function a(o){return o.map(n=>{const{disabled:l,label:r,children:s,divider:c=!1}=n,m={item:n,handler:b,showIcon:t.showIcon};return!s||s.length===0?u(V,null,[u(Y,{disabled:l,class:`${p}__item ${c?"is-divider":""}`,index:r},{default:()=>[u(x,m,null)]})]):f(i)?u(q,{index:r,disabled:l,"popper-class":`${p}__popup`},{title:()=>u(x,m,null),default:()=>a(s)}):null})}return P(()=>{R(()=>i.value=!0)}),E(()=>{const o=f(e);o&&document.body.removeChild(o)}),()=>{let o;if(!f(i))return null;const{items:n}=t;return u(F,{"default-active":"12",mode:"vertical",collapse:!0,"unique-opened":!0,"menu-trigger":"hover",class:p,ref:e,style:f(h)},T(o=a(n))?o:{default:()=>[o]})}}});const d={domList:[],resolve:()=>{}},G=function(t){const{event:e=null,showIcon:i=!0,styles:p={},items:h,width:x}=t||{};if(e&&(e==null||e.preventDefault()),typeof window!="undefined")return new Promise(b=>{const a=document.body,o=document.createElement("div"),n={event:e,styles:p,showIcon:i,items:h,width:x,axis:{x:(e==null?void 0:e.clientX)||0,y:(e==null?void 0:e.clientY)||0}},l=u(X,n);H(l,o);const r=function(){d.resolve("")};d.domList.push(o);const s=function(){d.domList.forEach(c=>{try{c&&a.removeChild(c)}catch(m){}}),a.removeEventListener("click",r),a.removeEventListener("scroll",r)};d.resolve=function(c){s(),b(c)},s(),a.appendChild(o),a.addEventListener("click",r),a.addEventListener("scroll",r)})},I=function(){d&&(d.resolve(""),d.domList=[])};function ee(t=!0){return U()&&t&&E(()=>{I()}),[G,I]}export{ee as u};
