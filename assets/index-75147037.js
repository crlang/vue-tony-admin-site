var k=Object.defineProperty,F=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var V=(e,t,s)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,b=(e,t)=>{for(var s in t||(t={}))T.call(t,s)&&V(e,s,t[s]);if(C)for(var s of C(t))I.call(t,s)&&V(e,s,t[s]);return e},B=(e,t)=>F(e,N(t));import{K as O,L,Z as S,M as A,n as P,$ as W,aS as $}from"./elementui-66980f2a.js";import{a5 as R,_ as M}from"./index-795cdaa0.js";import{E as G,W as J,b as U,f as g,X as q,ac as u,p as h,I as K,J as a,S as o,t as l,P as f,Q as _,q as w,R as Q,a7 as X}from"./vue-d691a816.js";const Z=G({components:{ElRow:O,ElCol:L,ElInput:S,ElCard:A,ElButton:P,ElTag:W},setup(){const e=J({server:"ws://localhost:3300/test",sendValue:"",recordList:[]}),{status:t,data:s,send:v,close:D,open:E}=$(e.server,{autoReconnect:!1,heartbeat:!0});U(()=>{if(s.value)try{const m=JSON.parse(s.value);e.recordList.push(m)}catch(m){e.recordList.push({res:s.value,id:Math.ceil(Math.random()*1e3),time:new Date().getTime()})}});const r=g(()=>t.value==="OPEN"),c=g(()=>r.value?"success":"danger"),p=g(()=>[...e.recordList].reverse());function d(){v(e.sendValue),e.sendValue=""}function i(){r.value?D():E()}return B(b({status:t,formatToDateTime:R},q(e)),{handlerSend:d,getList:p,toggle:i,getIsOpen:r,getTagColor:c})}}),j={class:"flex items-center"},z=l("span",{class:"mr-4"},"连接状态:",-1),H={class:"min-h-85 overflow-auto"},Y={class:"flex items-center"},x=l("span",{class:"mr-2 text-primary"},"收到消息:",-1);function ee(e,t,s,v,D,E){const r=u("el-tag"),c=u("el-button"),p=u("el-input"),d=u("el-card"),i=u("el-col"),m=u("el-row"),y=u("PageWrapper");return h(),K(y,{title:"WebSocket 示例"},{default:a(()=>[o(m,{gutter:24,class:"pb-4"},{default:a(()=>[o(i,{span:8},{default:a(()=>[o(d,{class:"mb-4"},{header:a(()=>[l("div",j,[z,o(r,{type:e.getTagColor},{default:a(()=>[f(_(e.status),1)]),_:1},8,["type"])])]),default:a(()=>[o(p,{modelValue:e.server,"onUpdate:modelValue":t[0]||(t[0]=n=>e.server=n),placeholder:"Please input",class:"input-with-select"},{prepend:a(()=>[f("服务地址")]),append:a(()=>[o(c,{type:e.getIsOpen?"danger":"primary",onClick:e.toggle,loading:e.status==="CONNECTING"},{default:a(()=>[f(_(e.getIsOpen?"关闭连接":e.status==="CONNECTING"?"连接中...":"开启连接"),1)]),_:1},8,["type","onClick","loading"])]),_:1},8,["modelValue"])]),_:1}),o(d,{header:"测试"},{default:a(()=>[o(p,{maxlength:"30",placeholder:"需要发送到服务器的内容",disabled:!e.getIsOpen,modelValue:e.sendValue,"onUpdate:modelValue":t[1]||(t[1]=n=>e.sendValue=n),"show-word-limit":"",rows:5,type:"textarea"},null,8,["disabled","modelValue"]),o(c,{type:"primary",block:"",class:"mt-4",disabled:!e.getIsOpen,onClick:e.handlerSend},{default:a(()=>[f("发送")]),_:1},8,["disabled","onClick"])]),_:1})]),_:1}),o(i,{span:16},{default:a(()=>[o(d,{header:"消息记录"},{default:a(()=>[l("div",H,[l("ul",null,[(h(!0),w(Q,null,X(e.getList,n=>(h(),w("li",{class:"mt-2",key:n.time},[l("div",Y,[x,l("span",null,_(e.formatToDateTime(n.time)),1)]),l("div",null,_(n.res),1)]))),128))])])]),_:1})]),_:1})]),_:1})]),_:1})}const le=M(Z,[["render",ee]]);export{le as default};
