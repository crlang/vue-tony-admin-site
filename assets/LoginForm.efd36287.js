var S=(w,o,r)=>new Promise((m,d)=>{var c=a=>{try{u(r.next(a))}catch(i){d(i)}},f=a=>{try{u(r.throw(a))}catch(i){d(i)}},u=a=>a.done?m(a.value):Promise.resolve(a.value).then(c,f);u((r=r.apply(w,o)).next())});import{y as h,a as g,_ as F,l as I,u as e,I as C,J as D,z as N,G as B,H as l,R as t,a9 as K,P as y,Q as x,ak as M}from"./ex-pkg-@vue.dfd8e273.js";import{e as T,f as U,h as z}from"./index.ec0491db.js";import{u as P,a as $,L as j,b as G}from"./useLogin.cea441e7.js";import{f as E,I as k,F as V,J,z as b,D as O,K as A}from"./ex-pkg-element-plus.7627c250.js";import"./ex-pkg-vendor.0d33d667.js";import"./ex-pkg-xlsx.9db082f2.js";import"./ex-pkg-mockjs.907334ba.js";import"./ex-pkg-@element-plus.e8ce6c8b.js";import"./ex-pkg-@vueuse.e5d644bd.js";import"./ex-pkg-@iconify.345c6dc9.js";import"./ex-pkg-@popperjs.f3a17871.js";const le=h({setup(w){const{t:o}=T(),{notification:r}=U(),m=z(),{setLoginState:d,getLoginState:c}=P(),{getFormRules:f}=$(),u=g(),a=g(!1),i=g(!1),n=F({account:"",password:""}),{validForm:_}=G(u),R=I(()=>e(c)===j.LOGIN);function v(){return S(this,null,function*(){if(!!(yield _()))try{a.value=!0;const s=yield m.login(M({password:n.password,username:n.account,mode:"none"}));s&&r.success({title:o("sys.login.loginSuccessTitle"),message:`${o("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3e3})}catch(s){r.error({title:o("sys.api.errorTip"),message:s.message||o("sys.api.networkExceptionMsg")})}finally{a.value=!1}})}return(L,s)=>C((N(),B(e(A),{model:e(n),rules:e(f),ref_key:"formRef",ref:u},{default:l(()=>[t(e(k),{prop:"account"},{default:l(()=>[t(e(E),{modelValue:e(n).account,"onUpdate:modelValue":s[0]||(s[0]=p=>e(n).account=p),placeholder:e(o)("sys.login.userNameEg")},null,8,["modelValue","placeholder"])]),_:1}),t(e(k),{prop:"password",class:"mb-1"},{default:l(()=>[t(e(E),{modelValue:e(n).password,"onUpdate:modelValue":s[1]||(s[1]=p=>e(n).password=p),placeholder:e(o)("sys.login.passwordEg"),onKeypress:K(v,["enter"])},null,8,["modelValue","placeholder","onKeypress"])]),_:1}),t(e(O),{class:"mt-3"},{default:l(()=>[t(e(V),{span:12},{default:l(()=>[t(e(J),{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=p=>i.value=p),size:"small"},{default:l(()=>[y(x(e(o)("sys.login.rememberMe")),1)]),_:1},8,["modelValue"])]),_:1}),t(e(V),{span:12,class:"text-right"},{default:l(()=>[t(e(b),{type:"text",onClick:s[3]||(s[3]=p=>e(d)(e(j).RESET_PASSWORD))},{default:l(()=>[y(x(e(o)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1}),t(e(k),null,{default:l(()=>[t(e(b),{type:"primary",class:"login--submit",loading:a.value,onClick:v},{default:l(()=>[y(x(e(o)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])),[[D,e(R)]])}});export{le as default};
