var p=(t,e,a)=>new Promise((o,u)=>{var r=n=>{try{s(a.next(n))}catch(i){u(i)}},l=n=>{try{s(a.throw(n))}catch(i){u(i)}},s=n=>n.done?o(n.value):Promise.resolve(n.value).then(r,l);s((a=a.apply(t,e)).next())});import{b as w,_ as g,I}from"./index-795cdaa0.js";import{r as f,u as d,E as V,f as v,b as S,w as y,ac as m,p as h,I as E,J as C,S as b,P as B,Q as $,G as _}from"./vue-d691a816.js";import{a4 as k,Z as N,n as A}from"./elementui-66980f2a.js";function R(t){const e=f(t),a=f(!1);let o;function u(){o&&window.clearInterval(o)}function r(){a.value=!1,u(),o=null}function l(){d(a)||o||(a.value=!0,o=setInterval(()=>{d(e)===1?(r(),e.value=t):e.value-=1},1e3))}function s(){e.value=t,r()}function n(){s(),l()}return k(()=>{s()}),{currentCount:e,isStart:a,start:l,reset:s,restart:n,clear:u,stop:r}}const T=V({name:"CountdownInput",components:{ElInput:N,ElButton:A},inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},emits:["change","update:modelValue"],setup(t,{emit:e}){const{prefixCls:a}=w("basic-countdown-input"),o=f(!1),u=f(),{currentCount:r,isStart:l,start:s}=R(t.count),n=v(()=>d(l)?`${d(r)}秒后重新获取`:"获取验证码");function i(){return p(this,null,function*(){const{sendCodeApi:c}=t;if(typeof c=="function"){o.value=!0;try{(yield c())&&s()}finally{o.value=!1}}else s()})}return S(()=>{u.value=t.modelValue||""}),y(()=>d(u),c=>{e("update:modelValue",c),e("change",c)}),{prefixCls:a,loading:o,isStart:l,innerValueRef:u,getButtonText:n,handleStart:i}}});function D(t,e,a,o,u,r){const l=m("ElButton"),s=m("ElInput");return h(),E(s,_(t.$attrs,{class:t.prefixCls,modelValue:t.innerValueRef,"onUpdate:modelValue":e[0]||(e[0]=n=>t.innerValueRef=n)}),{append:C(()=>[b(l,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading},{default:C(()=>[B($(t.getButtonText),1)]),_:1},8,["disabled","onClick","loading"])]),_:1},16,["class","modelValue"])}const P=g(T,[["render",D]]),O=I(P);export{O as C};
