var V=(n,i,p)=>new Promise((o,h)=>{var a=d=>{try{_(p.next(d))}catch(g){h(g)}},s=d=>{try{_(p.throw(d))}catch(g){h(g)}},_=d=>d.done?o(d.value):Promise.resolve(d.value).then(a,s);_((p=p.apply(n,i)).next())});import{d as H,o as C,f as S,g as r,h as f,b as e,r as w,dz as G,aR as W,bL as J,dq as P,eF as I,bO as Q,bD as X,R as j,c as L,w as Y,j as Z,i as F,s as z,n as m,E as ee,di as K,v as U,am as ne,bm as te,t as se,bK as oe,k as ae,as as le,b$ as re,l as ie,_ as ue,e as N}from"./index.a3be5a06.js";import{I as k}from"./index.4c86d7ee.js";import{g as ce,f as pe,C as de}from"./index.c639f020.js";import{u as fe}from"./index.2b6d2952.js";import{E as me}from"./index.f722e5a3.js";import"./index.f598c73b.js";import"./useWindowSizeFn.2567e0b4.js";import"./index.d49960e2.js";import"./_baseIsEqual.5fab7397.js";import"./_baseUniq.33ff9dfc.js";import"./index.877d1a1e.js";import"./index.6370a45c.js";import"./useTimeout.62b6f0c9.js";import"./index.5afdc983.js";import"./dropdown.817d847e.js";import"./index.019e5707.js";import"./drawer.470a0bec.js";import"./use-dialog.b591a60e.js";import"./index.99dc64d9.js";import"./refs.11e1edb5.js";import"./index.80d0f5e3.js";import"./index.acde674e.js";import"./lock.b9ded7d3.js";const he=r("span",null,"\u786E\u8BA4",-1),ve=r("span",null,"\u5207\u6362",-1),_e=r("span",null,"\u5173\u95ED",-1),ge=H({__name:"AppSearchFooter",setup(n){return(i,p)=>(C(),S("div",null,[r("div",null,[r("span",null,[f(e(k),{name:"uil:enter"})]),he]),r("div",null,[r("span",null,[f(e(k),{name:"ion:arrow-up-outline"})]),r("span",null,[f(e(k),{name:"ion:arrow-down-outline"})]),ve]),r("div",null,[r("span",null,[f(e(k),{name:"mdi:keyboard-esc"})]),_e])]))}});function $e(){const n=w([]);return G(()=>{n.value=[]}),[n,p=>o=>{n.value[p]=o}]}function we(n){return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(n)?`\\${n}`:n}function Me(n){const i=[...n].map(o=>we(o)),p=["",...i,""].join(".*");return new RegExp(p)}function Ce(n,i,p){const o=w([]),h=w(""),a=w(-1);let s=[];const _=W(),d=Q(g,200);J(()=>V(this,null,function*(){const l=yield ce();s=P(l)}));function g(l){if(h.value=l.trim(),!l){o.value=[];return}const u=Me(e(h)),c=X(s,t=>u.test(t.name)&&!t.hideMenu);o.value=R(c,u),a.value=0}function R(l,u,c){const t=[];return l.forEach(v=>{const{name:$,path:M,icon:O,children:b,hideMenu:q,meta:y}=v;!q&&u.test($)&&(!(b!=null&&b.length)||(y==null?void 0:y.hideChildrenInMenu))&&t.push({name:c!=null&&c.name?`${c.name} > ${$}`:$,path:M,icon:O}),!(y!=null&&y.hideChildrenInMenu)&&Array.isArray(b)&&b.length&&t.push(...R(b,u,v))}),t}function E(l){const u=l.target.dataset.index;a.value=Number(u)}function B(){!o.value.length||(a.value--,a.value<0&&(a.value=o.value.length-1),x())}function T(){!o.value.length||(a.value++,a.value>o.value.length-1&&(a.value=0),x())}function x(){const l=e(n);if(!l||!Array.isArray(l)||l.length===0||!e(i))return;const u=e(a),c=l[u];if(!c)return;const t=e(i);if(!t)return;const v=c.offsetTop+c.offsetHeight,$=t.offsetHeight,{start:M}=fe({el:t,duration:100,to:v-$});M()}function D(){return V(this,null,function*(){if(!o.value.length)return;const l=e(o),u=e(a);if(l.length===0||u<0)return;const c=l[u];A(),yield j(),_(c.path)})}function A(){o.value=[],p("close")}return I("Enter",D),I("ArrowUp",B),I("ArrowDown",T),I("Escape",A),{handleSearch:d,searchResult:o,keyword:h,activeIndex:a,handleMouseenter:E,handleEnter:D}}const be=["data-index"],ye=H({__name:"AppSearchModal",props:{visible:{type:Boolean}},emits:["close"],setup(n,{emit:i}){const p=n,o=w(null),h=w(null),a=w(""),{prefixCls:s}=ie("header-search-modal"),[_,d]=$e(),{getIsMobile:g}=pe(),{handleSearch:R,searchResult:E,keyword:B,activeIndex:T,handleEnter:x,handleMouseenter:D}=Ce(_,o,i),A=L(()=>!B||e(E).length===0),l=L(()=>[s,{[`${s}--mobile`]:e(g)}]);Y(()=>p.visible,c=>{c&&j(()=>{var t;a.value="",(t=e(h))==null||t.focus()})});function u(){E.value=[],i("close")}return(c,t)=>(C(),Z(re,{to:"body"},[f(le,{name:"zoom-fade",mode:"out-in"},{default:F(()=>[n.visible?(C(),S("div",{key:0,class:m(e(l)),onClick:t[3]||(t[3]=oe(()=>{},["stop"]))},[z((C(),S("div",{class:m(`${e(s)}-content`)},[r("div",{class:m(`${e(s)}-input__wrapper`)},[f(e(ee),{class:m(`${e(s)}-input`),placeholder:"\u641C\u7D22",ref_key:"inputRef",ref:h,clearable:"",modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=v=>a.value=v),onInput:e(R)},{prefix:F(()=>[f(e(K))]),_:1},8,["class","modelValue","onInput"]),r("span",{class:m(`${e(s)}-cancel`),onClick:u}," \u53D6\u6D88 ",2)],2),z(r("div",{class:m(`${e(s)}-nodata`)}," \u6682\u65E0\u641C\u7D22\u7ED3\u679C ",2),[[U,e(A)]]),z(r("ul",{class:m(`${e(s)}-list`),ref_key:"scrollWrap",ref:o},[(C(!0),S(ne,null,te(e(E),(v,$)=>(C(),S("li",{ref_for:!0,ref:e(d)($),key:v.path,"data-index":$,onMouseenter:t[1]||(t[1]=(...M)=>e(D)&&e(D)(...M)),onClick:t[2]||(t[2]=(...M)=>e(x)&&e(x)(...M)),class:m([`${e(s)}-list__item`,{[`${e(s)}-list__item--active`]:e(T)===$}])},[r("div",{class:m(`${e(s)}-list__item-icon`)},[f(e(k),{name:v.icon||"mdi:form-select",size:20},null,8,["name"])],2),r("div",{class:m(`${e(s)}-list__item-text`)},se(v.name),3),r("div",{class:m(`${e(s)}-list__item-enter`)},[f(e(k),{name:"uil:enter",size:20})],2)],42,be))),128))],2),[[U,!e(A)]]),f(ge,{class:m(`${e(s)}-footer`)},null,8,["class"])],2)),[[e(de),u]])],2)):ae("",!0)]),_:1})]))}}),Se=H({name:"AppSearch",components:{ElTooltip:me,AppSearchModal:ye,Search:K},setup(){return{showModal:w(!1)}}});function ke(n,i,p,o,h,a){const s=N("Search"),_=N("ElTooltip"),d=N("AppSearchModal");return C(),S("div",{onClick:i[1]||(i[1]=g=>n.showModal=!0)},[f(_,{effect:"dark",content:"\u641C\u7D22",placement:"bottom-end"},{default:F(()=>[r("span",null,[f(s)])]),_:1}),f(d,{onClose:i[0]||(i[0]=g=>n.showModal=!1),visible:n.showModal},null,8,["visible"])])}var Xe=ue(Se,[["render",ke]]);export{Xe as default};
