var me=Object.defineProperty,ge=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var ee=(e,o,a)=>o in e?me(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,p=(e,o)=>{for(var a in o||(o={}))he.call(o,a)&&ee(e,a,o[a]);if(x)for(var a of x(o))ye.call(o,a)&&ee(e,a,o[a]);return e},T=(e,o)=>ge(e,pe(o));var _=(e,o,a)=>new Promise((c,l)=>{var i=d=>{try{n(a.next(d))}catch(s){l(s)}},t=d=>{try{n(a.throw(d))}catch(s){l(s)}},n=d=>d.done?c(d.value):Promise.resolve(d.value).then(i,t);n((a=a.apply(e,o)).next())});import{as as Ce,e as te,_ as A,K as be,L as Me,Y as ve,x as Be,ah as He,a0 as $e,u as Fe,i as oe,ap as Te,ab as Ve,ad as ne,w as we}from"./index.ccefc80e.js";import{u as ke}from"./useAttrs.07e29e2e.js";import{x as L,bY as De,M as h,y as v,aj as I,X as M,z as y,Y as $,a2 as g,a3 as C,a0 as V,u as r,o as ae,bZ as Se,O as le,V as Re,af as Ee,W as w,bf as Pe,B as We,A as q,S as Oe,G as Y,aK as Ae,aa as K,F as G,a9 as j,a6 as Le,R as Ie,$ as k,D as X,a7 as je,ae as Z,ac as se,ao as ze,aL as Ne,aM as _e,I as re,t as U,a_ as qe}from"./vendor.edbe4fa8.js";import{u as Ye}from"./useWindowSizeFn.ba2f9a46.js";const{t:J}=te(),ie={showClose:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},helpMessage:{type:[String,Array],default:""}},ce={useWrapper:{type:Boolean,default:!0},footerOffset:{type:Number,default:0},loading:{type:Boolean,default:!1},loadingTip:{type:String,default:J("common.loadingText")},modalHeaderHeight:{type:Number,default:56},modalFooterHeight:{type:Number,default:70}},ue={showFooter:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},cancelText:{type:String,default:J("common.cancelText")},cancelButton:{type:Object},showConfirm:{type:Boolean,default:!0},confirmText:{type:String,default:J("common.confirmText")},confirmButton:{type:Object}},de=T(p(p(p(p({},Ce),ie),ce),ue),{modelValue:{type:Boolean},draggable:{type:Boolean,default:!0},scrollTop:{type:Boolean,default:!0},closeFunc:Function,onOpen:Function,onOpened:Function,onClose:Function,onClosed:Function}),Xe=L({name:"BasicDialog",components:{ElDialog:De},inheritAttrs:!1,props:de,setup(e){const o=h(!1),a=ke(),c=v(()=>{const l=p(p({},r(a)),e),i=ae(l,["showFullscreen","helpMessage","useWrapper","footerOffset","loading","scrollTop","loadingTip","modalHeaderHeight","modalFooterHeight","showFooter","showCancel","cancelText","showConfirm","confirmText","closeFunc","draggable","confirmButton","cancelButton"]);return i.showClose=!1,i});return I(()=>{o.value=!!e.modelValue}),{visibleRef:o,getBindValue:c}}});function Ue(e,o,a,c,l,i){const t=M("ElDialog");return y(),$(t,V(e.getBindValue,{modelValue:e.visibleRef,"onUpdate:modelValue":o[0]||(o[0]=n=>e.visibleRef=n)}),{title:g(()=>[C(e.$slots,"title")]),footer:g(()=>[C(e.$slots,"footer")]),default:g(()=>[C(e.$slots,"default")]),_:3},16,["modelValue"])}var Ke=A(Xe,[["render",Ue]]);const fe=Symbol();function Ge(e){return be(e,fe)}function pt(){return Me(fe)}const Ze=L({name:"ModalWrapper",components:{ScrollContainer:ve},inheritAttrs:!1,props:p({modelValue:{type:Boolean},fullscreen:{type:Boolean},customClass:{type:String}},ce),emits:["height-change","ext-height"],setup(e,{emit:o}){const a=h(null),c=h(null),l=h(0),i=h(0);let t=0;Ye(s.bind(null,!1)),Se(c,()=>{s()},{attributes:!0,subtree:!0}),Ge({redoModalHeight:s});const n=v(()=>({[e.fullscreen?"height":"maxHeight"]:`${r(l)}px`}));I(()=>{e.useWrapper&&s()}),le(()=>e.fullscreen,f=>{s(),f?i.value=l.value:l.value=i.value}),Re(()=>{const{modalHeaderHeight:f,modalFooterHeight:m}=e;o("ext-height",f+m)}),Ee(()=>{});function d(){return _(this,null,function*(){w(()=>{var m;const f=r(a);!f||(m=f==null?void 0:f.scrollTo)==null||m.call(f,0)})})}function s(){return _(this,null,function*(){if(!e.modelValue)return;const f=r(a);if(!f)return;const m=f.$el.parentElement;if(!!m){yield w();try{const B=m.parentElement;if(!B)return;const D=B.offsetTop;let H=window.innerHeight-D*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;D<40&&(H-=26),yield w();const F=r(c);if(!F)return;yield w(),t=F.scrollHeight,e.fullscreen?l.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:l.value=t>H?H:t,o("height-change",r(l))}catch(B){console.warn(B)}}})}return{wrapperRef:a,spinRef:c,spinStyle:n,scrollTop:d,setModalHeight:s}}}),Je=["element-loading-text"];function Qe(e,o,a,c,l,i){const t=M("ScrollContainer"),n=Pe("loading");return y(),$(t,{ref:"wrapperRef",class:Y(e.customClass)},{default:g(()=>[We((y(),q("div",{ref:"spinRef",style:Oe(e.spinStyle),"element-loading-text":e.loadingTip},[C(e.$slots,"default")],12,Je)),[[n,e.loading]])]),_:3},8,["class"])}var xe=A(Ze,[["render",Qe]]);const et=L({name:"BasicModalFooter",components:{ElButton:Ae},inheritAttrs:!1,props:T(p({},ue),{customClass:{type:String}}),emits:["ok","cancel"],setup(e,{emit:o}){function a(l){o("ok",l)}function c(l){o("cancel",l)}return{handleOk:a,handleCancel:c}}});function tt(e,o,a,c,l,i){const t=M("ElButton");return e.showFooter?(y(),q("div",{key:0,class:Y(e.customClass)},[C(e.$slots,"insertFooter"),e.showCancel?(y(),$(t,V({key:0},e.cancelButton,{onClick:e.handleCancel}),{default:g(()=>[K(G(e.cancelText),1)]),_:1},16,["onClick"])):j("",!0),C(e.$slots,"centerFooter"),e.showConfirm?(y(),$(t,V({key:1},e.confirmButton,{onClick:e.handleOk}),{default:g(()=>[K(G(e.confirmText),1)]),_:1},16,["onClick"])):j("",!0),C(e.$slots,"appendFooter")],2)):j("",!0)}var ot=A(et,[["render",tt]]);function nt(e){const o=(l,i)=>getComputedStyle(l)[i],a=l=>{if(!l)return;l.setAttribute("data-drag",r(e.draggable));const i=l.querySelector(".el-dialog__header"),t=l.querySelector(".el-dialog");!i||!t||!r(e.draggable)||(i.style.cursor="move",i.classList.add("is-drag"),i.onmousedown=n=>{if(!n)return;const d=n.clientX,s=n.clientY,f=document.body.clientWidth,m=document.documentElement.clientHeight,B=t.offsetWidth,D=t.offsetHeight,H=t.offsetLeft,F=f-t.offsetLeft-B,N=t.offsetTop,R=m-t.offsetTop-D,S=o(t,"left"),E=o(t,"top");let P=+S,W=+E;S.includes("%")?(P=+document.body.clientWidth*(+S.replace(/%/g,"")/100),W=+document.body.clientHeight*(+E.replace(/%/g,"")/100)):(P=+S.replace(/px/g,""),W=+E.replace(/px/g,"")),document.onmousemove=function(u){let b=u.clientX-d,O=u.clientY-s;-b>H?b=-H:b>F&&(b=F),-O>N?O=-N:O>R&&(O=R),t.style.cssText+=`;left:${b+P}px;top:${O+W}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},c=()=>{const l=document.querySelectorAll(".el-overlay");for(const i of Array.from(l)){if(!i)continue;const t=o(i,"display"),n=i.getAttribute("data-drag");t!=="none"&&(n===null||r(e.destroyOnClose))&&a(i)}};I(()=>{!r(e.modelValue)||!r(e.draggable)||Be(()=>{c()},30)})}const at=L({name:"BasicModalHeader",components:{ElTooltip:Le,BasicTitle:He,SvgIcon:$e},inheritAttrs:!1,props:p({modelValue:{type:Boolean},destroyOnClose:{type:Boolean},fullscreen:{type:Boolean},draggable:{type:Boolean},customClass:{type:String},customTitle:{type:String}},ie),emits:["cancel","fullscreen"],setup(e,{emit:o}){const{t:a}=te(),{modelValue:c,draggable:l,destroyOnClose:i}=Ie(e);nt({modelValue:c,destroyOnClose:i,draggable:l});function t(s){!e.showFullscreen||(s.stopPropagation(),d(s))}function n(s){o("cancel",s)}function d(s){s==null||s.stopPropagation(),s==null||s.preventDefault(),o("fullscreen")}return{t:a,handleCancel:n,handleFullscreen:d,handleTitleDbClick:t}}});function lt(e,o,a,c,l,i){const t=M("BasicTitle"),n=M("SvgIcon"),d=M("ElTooltip");return y(),q("div",{class:Y(e.customClass),onDblclick:o[3]||(o[3]=(...s)=>e.handleTitleDbClick&&e.handleTitleDbClick(...s))},[k(t,{helpMessage:e.helpMessage},{default:g(()=>[K(G(e.customTitle),1)]),_:1},8,["helpMessage"]),X("div",{class:Y(`${e.customClass}__extra`)},[e.showFullscreen?(y(),q(je,{key:0},[e.fullscreen?(y(),$(d,{key:0,content:e.t("component.modal.restore"),placement:"bottom"},{default:g(()=>[X("span",{onClick:o[0]||(o[0]=(...s)=>e.handleFullscreen&&e.handleFullscreen(...s))},[k(n,{name:"fullscreen-exit"})])]),_:1},8,["content"])):(y(),$(d,{key:1,content:e.t("component.modal.maximize"),placement:"bottom"},{default:g(()=>[X("span",{onClick:o[1]||(o[1]=(...s)=>e.handleFullscreen&&e.handleFullscreen(...s))},[k(n,{name:"fullscreen"})])]),_:1},8,["content"]))],64)):j("",!0),e.showClose?(y(),$(d,{key:1,content:e.t("component.modal.close"),placement:"bottom"},{default:g(()=>[X("span",{onClick:o[2]||(o[2]=(...s)=>e.handleCancel&&e.handleCancel(...s))},[k(n,{name:"close"})])]),_:1},8,["content"])):j("",!0)],2)],34)}var st=A(at,[["render",lt]]);const rt=L({name:"BasicModal",components:{Modal:Ke,ModalWrapper:xe,ModalFooter:ot,ModalHeader:st},inheritAttrs:!1,props:de,emits:["visible-change","height-change","cancel","ok","register","update:modelValue"],setup(e,{emit:o}){const a=h(!1),c=h(null),l=h(null),{prefixCls:i}=Fe("basic-modal"),t=h(!1),n=h(!1),d=h(0),s={setModalProps:R,emitVisible:void 0,redoModalHeight:()=>{w(()=>{r(l)&&r(l).setModalHeight()})}},f=Z();f&&o("register",s,f.uid);const m=v(()=>p(p({},e),r(c))),B=v(()=>T(p({},r(m)),{fullscreen:r(t),draggable:r(n),customClass:i})),D=v(()=>T(p({},r(m)),{fullscreen:r(t),modelValue:r(a),draggable:r(n),customClass:`${i}__header`,customTitle:r(m).title})),H=v(()=>T(p({},r(m)),{fullscreen:r(t),modelValue:r(a),customClass:`${i}__body`})),F=v(()=>T(p({},r(m)),{customClass:`${i}__footer`}));I(()=>{a.value=!!e.modelValue,t.value=!!e.fullscreen,n.value=!!e.draggable}),le(()=>r(a),u=>{var b;o("visible-change",u),o("update:modelValue",u),f&&((b=s.emitVisible)==null||b.call(s,u,f.uid)),w(()=>{(e==null?void 0:e.scrollTop)&&u&&r(l)&&r(l).scrollTop()})},{immediate:!1});function N(u){return _(this,null,function*(){if(u==null||u.stopPropagation(),e.closeFunc&&oe(e.closeFunc)){const b=yield e.closeFunc();a.value=!b;return}a.value=!1,o("cancel",u)})}function R(u){c.value=Te(r(c)||{},u),Reflect.has(u,"modelValue")&&(a.value=!!u.modelValue),Reflect.has(u,"fullscreen")&&(t.value=!!u.fullscreen)}function S(u){o("ok",u)}function E(u){o("height-change",u)}function P(u){d.value=u}function W(){R({fullscreen:!r(t)})}return{prefixCls:i,handleCancel:N,getBaiscBindValue:B,getHeaderBindValue:D,getWrapperBindValue:H,getFooterBindValue:F,handleFullscreen:W,fullscreenRef:t,getMergeProps:m,handleOk:S,visibleRef:a,draggableRef:n,omit:ae,modalWrapperRef:l,handleExtHeight:P,handleHeightChange:E}}});function it(e,o,a,c,l,i){const t=M("ModalHeader"),n=M("ModalFooter"),d=M("ModalWrapper"),s=M("Modal");return y(),$(s,V(e.getBaiscBindValue,{modelValue:e.visibleRef,"onUpdate:modelValue":o[0]||(o[0]=f=>e.visibleRef=f)}),se({default:g(()=>[k(d,V({ref:"modalWrapperRef"},e.getWrapperBindValue,{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:g(()=>[C(e.$slots,"default")]),_:3},16,["onExtHeight","onHeightChange"])]),_:2},[e.$slots.title?{name:"title",fn:g(()=>[C(e.$slots,"title")])}:{name:"title",fn:g(()=>[k(t,V(e.getHeaderBindValue,{onFullscreen:e.handleFullscreen,onCancel:e.handleCancel}),null,16,["onFullscreen","onCancel"])])},e.$slots.footer?{name:"footer",fn:g(()=>[C(e.$slots,"footer")])}:{name:"footer",fn:g(()=>[k(n,V(e.getFooterBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),se({_:2},[ze(Object.keys(e.$slots),f=>({name:f,fn:g(m=>[C(e.$slots,f,Ne(_e(m||{})))])}))]),1040,["onOk","onCancel"])])}]),1040,["modelValue"])}var ct=A(rt,[["render",it]]);const z=re({}),Q=re({});function ht(){const e=h(null),o=h(!1),a=h("");function c(t,n){if(!Z())throw new Error("useModal() can only be used inside setup() or functional components!");a.value=n,!(r(o)&&Ve()&&t===r(e))&&(e.value=t,o.value=!0,t.emitVisible=(d,s)=>{Q[s]=d})}const l=()=>{const t=r(e);return t||ne("useModal instance is undefined!"),t},i={setModalProps:t=>{var n;(n=l())==null||n.setModalProps(t)},getVisible:v(()=>Q[~~r(a)]),redoModalHeight:()=>{var t,n;(n=(t=l())==null?void 0:t.redoModalHeight)==null||n.call(t)},openModal:(t=!0,n,d=!0)=>{var m;if((m=l())==null||m.setModalProps({modelValue:t}),!n)return;const s=r(a);if(d){z[s]=null,z[s]=U(n);return}qe(U(z[s]),U(n))||(z[s]=U(n))},closeModal:()=>{var t;(t=l())==null||t.setModalProps({modelValue:!1})}};return[c,i]}const yt=e=>{const o=h(null),a=Z(),c=h(""),l=()=>{const t=r(o);return t||ne("useModalInner instance is undefined!"),t},i=(t,n)=>{c.value=n,o.value=t,a==null||a.emit("register",t,n)};return I(()=>{const t=z[r(c)];!t||!e||!oe(e)||w(()=>{e(t)})}),[i,{changeLoading:(t=!0)=>{var n;(n=l())==null||n.setModalProps({loading:t})},getVisible:v(()=>Q[~~r(c)]),changeConfirmLoading:(t=!0)=>{var n;(n=l())==null||n.setModalProps({confirmButton:{loading:t}})},closeModal:()=>{var t;(t=l())==null||t.setModalProps({modelValue:!1})},setModalProps:t=>{var n;(n=l())==null||n.setModalProps(t)},redoModalHeight:()=>{var n;const t=(n=l())==null?void 0:n.redoModalHeight;t&&t()}}]},Ct=we(ct);export{Ct as B,yt as a,ht as b,pt as u};
