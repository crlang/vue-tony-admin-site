var N=(n,l,p)=>new Promise((s,h)=>{var a=d=>{try{v(p.next(d))}catch(_){h(_)}},o=d=>{try{v(p.throw(d))}catch(_){h(_)}},v=d=>d.done?s(d.value):Promise.resolve(d.value).then(a,o);v((p=p.apply(n,l)).next())});import{r as $,dy as J,aR as O,bK as W,dp as q,eA as R,bN as P,b as e,by as Q,R as K,d as j,o as M,f as k,g as i,h as f,bJ as y,c as z,w as X,j as Y,i as U,v as V,n as m,E as Z,x as F,am as ee,bB as ne,t as te,bI as se,k as oe,as as ae,c0 as re,l as le,_ as ie,e as H}from"./index.61be89a1.js";import{g as ue,f as ce,C as pe}from"./index.e14673d0.js";import{u as de}from"./index.9574a6b4.js";import{E as fe}from"./index.91f8c4ba.js";import"./lock.63bbbced.js";import"./index.ee8c97d5.js";import"./index.21f47639.js";import"./index.e5719e3f.js";import"./useTimeout.0d66b90d.js";import"./_baseUniq.8c6df5cb.js";import"./_baseIsEqual.3f9a7929.js";import"./index.a6a2ff86.js";import"./dropdown.7e7b7d81.js";import"./index.c00c0978.js";import"./useWindowSizeFn.a3ba0925.js";import"./index.37ecb140.js";import"./index.5e1ef5ac.js";import"./drawer.0f38de7e.js";import"./use-dialog.8207f305.js";import"./index.3df10ae2.js";import"./refs.a78f8491.js";import"./index.00e0b22a.js";import"./index.4e3bc3e4.js";function me(){const n=$([]);return J(()=>{n.value=[]}),[n,p=>s=>{n.value[p]=s}]}function he(n){return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(n)?`\\${n}`:n}function ve(n){const l=[...n].map(s=>he(s)),p=["",...l,""].join(".*");return new RegExp(p)}function _e(n,l,p){const s=$([]),h=$(""),a=$(-1);let o=[];const v=O(),d=P(_,200);W(()=>N(this,null,function*(){const r=yield ue();o=q(r)}));function _(r){if(h.value=r.trim(),!r){s.value=[];return}const u=ve(e(h)),c=Q(o,t=>u.test(t.name)&&!t.hideMenu);s.value=I(c,u),a.value=0}function I(r,u,c){const t=[];return r.forEach(g=>{const{name:w,path:C,icon:L,children:S,hideMenu:G,meta:b}=g;!G&&u.test(w)&&(!(S!=null&&S.length)||(b==null?void 0:b.hideChildrenInMenu))&&t.push({name:c!=null&&c.name?`${c.name} > ${w}`:w,path:C,icon:L}),!(b!=null&&b.hideChildrenInMenu)&&Array.isArray(S)&&S.length&&t.push(...I(S,u,g))}),t}function E(r){const u=r.target.dataset.index;a.value=Number(u)}function B(){!s.value.length||(a.value--,a.value<0&&(a.value=s.value.length-1),x())}function T(){!s.value.length||(a.value++,a.value>s.value.length-1&&(a.value=0),x())}function x(){const r=e(n);if(!r||!Array.isArray(r)||r.length===0||!e(l))return;const u=e(a),c=r[u];if(!c)return;const t=e(l);if(!t)return;const g=c.offsetTop+c.offsetHeight,w=t.offsetHeight,{start:C}=de({el:t,duration:100,to:g-w});C()}function A(){return N(this,null,function*(){if(!s.value.length)return;const r=e(s),u=e(a);if(r.length===0||u<0)return;const c=r[u];D(),yield K(),v(c.path)})}function D(){s.value=[],p("close")}return R("Enter",A),R("ArrowUp",B),R("ArrowDown",T),R("Escape",D),{handleSearch:d,searchResult:s,keyword:h,activeIndex:a,handleMouseenter:E,handleEnter:A}}const ge=i("span",null,"\u786E\u8BA4",-1),we=i("span",null,"\u5207\u6362",-1),$e=i("span",null,"ESC",-1),Ce=j({__name:"AppSearchFooter",setup(n){return(l,p)=>(M(),k("div",null,[i("div",null,[i("span",null,[f(e(y),{name:"enter"})]),ge]),i("div",null,[i("span",null,[f(e(y),{name:"arrowup"})]),i("span",null,[f(e(y),{name:"arrowdown"})]),we]),i("div",null,[i("span",null,[f(e(y),{name:"close"})]),$e])]))}});const Me=["data-index"],ye=j({__name:"AppSearchModal",props:{visible:{type:Boolean}},emits:["close"],setup(n,{emit:l}){const p=n,s=$(null),h=$(null),a=$(""),{prefixCls:o}=le("header-search-modal"),[v,d]=me(),{getIsMobile:_}=ce(),{handleSearch:I,searchResult:E,keyword:B,activeIndex:T,handleEnter:x,handleMouseenter:A}=_e(v,s,l),D=z(()=>!B||e(E).length===0),r=z(()=>[o,{[`${o}--mobile`]:e(_)}]);X(()=>p.visible,c=>{c&&K(()=>{var t;a.value="",(t=e(h))==null||t.focus()})});function u(){E.value=[],l("close")}return(c,t)=>(M(),Y(re,{to:"body"},[f(ae,{name:"zoom-fade",mode:"out-in"},{default:U(()=>[n.visible?(M(),k("div",{key:0,class:m(e(r)),onClick:t[3]||(t[3]=se(()=>{},["stop"]))},[V((M(),k("div",{class:m(`${e(o)}-content`)},[i("div",{class:m(`${e(o)}-input__wrapper`)},[f(e(Z),{class:m(`${e(o)}-input`),placeholder:"\u641C\u7D22",ref_key:"inputRef",ref:h,clearable:"",modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=g=>a.value=g),onInput:e(I)},{prefix:U(()=>[f(e(y),{name:"search"})]),_:1},8,["class","modelValue","onInput"]),i("span",{class:m(`${e(o)}-cancel`),onClick:u},"\u53D6\u6D88",2)],2),V(i("div",{class:m(`${e(o)}-nodata`)},"\u6682\u65E0\u641C\u7D22\u7ED3\u679C",2),[[F,e(D)]]),V(i("ul",{class:m(`${e(o)}-list`),ref_key:"scrollWrap",ref:s},[(M(!0),k(ee,null,ne(e(E),(g,w)=>(M(),k("li",{ref_for:!0,ref:e(d)(w),key:g.path,"data-index":w,onMouseenter:t[1]||(t[1]=(...C)=>e(A)&&e(A)(...C)),onClick:t[2]||(t[2]=(...C)=>e(x)&&e(x)(...C)),class:m([`${e(o)}-list__item`,{[`${e(o)}-list__item--active`]:e(T)===w}])},[i("div",{class:m(`${e(o)}-list__item-text`)},te(g.name),3),i("div",{class:m(`${e(o)}-list__item-enter`)},[f(e(y),{name:"enter",size:20})],2)],42,Me))),128))],2),[[F,!e(D)]]),f(Ce,{class:m(`${e(o)}-footer`)},null,8,["class"])],2)),[[e(pe),u]])],2)):oe("",!0)]),_:1})]))}}),Se=j({name:"AppSearch",components:{ElTooltip:fe,AppSearchModal:ye,SvgIcon:y},setup(){return{showModal:$(!1)}}});function be(n,l,p,s,h,a){const o=H("SvgIcon"),v=H("ElTooltip"),d=H("AppSearchModal");return M(),k("div",{onClick:l[1]||(l[1]=_=>n.showModal=!0)},[f(v,{effect:"dark",content:"\u641C\u7D22",placement:"bottom-end"},{default:U(()=>[i("span",null,[f(o,{name:"search"})])]),_:1}),f(d,{onClose:l[0]||(l[0]=_=>n.showModal=!1),visible:n.showModal},null,8,["visible"])])}var Qe=ie(Se,[["render",be]]);export{Qe as default};
