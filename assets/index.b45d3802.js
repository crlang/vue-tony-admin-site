import{r as v,dm as K,aW as G,bD as O,eV as q,gy as R,bH as J,b as e,bt as P,U as L,d as U,o as w,f as b,g as r,h as p,bC as $,c as F,w as Q,k as X,i as N,n as d,b9 as Y,v as V,E as Z,x as z,al as ee,bw as ne,t as te,l as se,bF as oe,bW as ae,m as re,_ as le,e as H}from"./index.a812ffa9.js";import{g as ie,f as ue,C as ce}from"./index.bb96a6b7.js";import{u as pe}from"./index.ba82fa59.js";import{E as de}from"./index.48be7fd2.js";import"./lock.f9dff9cb.js";import"./index.c229c7c5.js";import"./index.2271c5c3.js";import"./index.e4429517.js";import"./useTimeout.3debf569.js";import"./drawer.55be0fb4.js";import"./_baseIsEqual.bce9394a.js";import"./index.c7ff1079.js";import"./dropdown.01d4c192.js";import"./index.e07eb570.js";import"./useWindowSizeFn.1725b147.js";import"./index.fb19ae5d.js";import"./index.6bf5f43d.js";import"./use-dialog.8523a096.js";import"./index.f3e99c90.js";import"./refs.7c70278f.js";import"./index.00e0b22a.js";import"./index.3f8d4f49.js";import"./strings.2b325842.js";function fe(){const t=v([]);return K(()=>{t.value=[]}),[t,f=>s=>{t.value[f]=s}]}function me(t){return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(t)?`\\${t}`:t}function he(t){const f=["",...[...t].map(s=>me(s)),""].join(".*");return new RegExp(f)}function ve(t,c,f){const s=v([]),_=v(""),l=v(-1);let o=[];const y=G(),S=J(k,200);O(async()=>{const a=await ie();o=q(a)});function k(a){if(_.value=a.trim(),!a){s.value=[];return}const i=he(e(_)),u=P(o,n=>i.test(n.name)&&!n.hideMenu);s.value=I(u,i),l.value=0}function I(a,i,u){const n=[];return a.forEach(m=>{const{name:h,path:g,icon:W,children:C,hideMenu:j,meta:M}=m;!j&&i.test(h)&&(!(C!=null&&C.length)||(M==null?void 0:M.hideChildrenInMenu))&&n.push({name:u!=null&&u.name?`${u.name} > ${h}`:h,path:g,icon:W}),!(M!=null&&M.hideChildrenInMenu)&&Array.isArray(C)&&C.length&&n.push(...I(C,i,m))}),n}function E(a){const i=a.target.dataset.index;l.value=Number(i)}function B(){!s.value.length||(l.value--,l.value<0&&(l.value=s.value.length-1),x())}function T(){!s.value.length||(l.value++,l.value>s.value.length-1&&(l.value=0),x())}function x(){const a=e(t);if(!a||!Array.isArray(a)||a.length===0||!e(c))return;const i=e(l),u=a[i];if(!u)return;const n=e(c);if(!n)return;const m=u.offsetTop+u.offsetHeight,h=n.offsetHeight,{start:g}=pe({el:n,duration:100,to:m-h});g()}async function A(){if(!s.value.length)return;const a=e(s),i=e(l);if(a.length===0||i<0)return;const u=a[i];D(),await L(),y(u.path)}function D(){s.value=[],f("close")}return R("Enter",A),R("ArrowUp",B),R("ArrowDown",T),R("Escape",D),{handleSearch:S,searchResult:s,keyword:_,activeIndex:l,handleMouseenter:E,handleEnter:A}}const _e=r("span",null,"\u786E\u8BA4",-1),ge=r("span",null,"\u5207\u6362",-1),we=r("span",null,"ESC",-1),$e=U({__name:"AppSearchFooter",setup(t){return(c,f)=>(w(),b("div",null,[r("div",null,[r("span",null,[p(e($),{name:"enter"})]),_e]),r("div",null,[r("span",null,[p(e($),{name:"arrowup"})]),r("span",null,[p(e($),{name:"arrowdown"})]),ge]),r("div",null,[r("span",null,[p(e($),{name:"close"})]),we])]))}});const Ce=["data-index"],Me=U({__name:"AppSearchModal",props:{visible:{type:Boolean}},emits:["close"],setup(t,{emit:c}){const f=t,s=v(null),_=v(null),l=v(""),{prefixCls:o}=re("header-search-modal"),[y,S]=fe(),{getIsMobile:k}=ue(),{handleSearch:I,searchResult:E,keyword:B,activeIndex:T,handleEnter:x,handleMouseenter:A}=ve(y,s,c),D=F(()=>!B||e(E).length===0),a=F(()=>[o,{[`${o}--mobile`]:e(k)}]);Q(()=>f.visible,u=>{u&&L(()=>{var n;l.value="",(n=e(_))==null||n.focus()})});function i(){E.value=[],c("close")}return(u,n)=>(w(),X(ae,{to:"body"},[p(oe,{name:"zoom-fade",mode:"out-in"},{default:N(()=>[t.visible?(w(),b("div",{key:0,class:d(e(a)),onClick:n[3]||(n[3]=Y(()=>{},["stop"]))},[V((w(),b("div",{class:d(`${e(o)}-content`)},[r("div",{class:d(`${e(o)}-input__wrapper`)},[p(e(Z),{class:d(`${e(o)}-input`),placeholder:"\u641C\u7D22",ref_key:"inputRef",ref:_,clearable:"",modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=m=>l.value=m),onInput:e(I)},{prefix:N(()=>[p(e($),{name:"search"})]),_:1},8,["class","modelValue","onInput"]),r("span",{class:d(`${e(o)}-cancel`),onClick:i},"\u53D6\u6D88",2)],2),V(r("div",{class:d(`${e(o)}-nodata`)},"\u6682\u65E0\u641C\u7D22\u7ED3\u679C",2),[[z,e(D)]]),V(r("ul",{class:d(`${e(o)}-list`),ref_key:"scrollWrap",ref:s},[(w(!0),b(ee,null,ne(e(E),(m,h)=>(w(),b("li",{ref_for:!0,ref:e(S)(h),key:m.path,"data-index":h,onMouseenter:n[1]||(n[1]=(...g)=>e(A)&&e(A)(...g)),onClick:n[2]||(n[2]=(...g)=>e(x)&&e(x)(...g)),class:d([`${e(o)}-list__item`,{[`${e(o)}-list__item--active`]:e(T)===h}])},[r("div",{class:d(`${e(o)}-list__item-text`)},te(m.name),3),r("div",{class:d(`${e(o)}-list__item-enter`)},[p(e($),{name:"enter",size:20})],2)],42,Ce))),128))],2),[[z,!e(D)]]),p($e,{class:d(`${e(o)}-footer`)},null,8,["class"])],2)),[[e(ce),i]])],2)):se("",!0)]),_:1})]))}}),be=U({name:"AppSearch",components:{ElTooltip:de,AppSearchModal:Me,SvgIcon:$},setup(){return{showModal:v(!1)}}});function ye(t,c,f,s,_,l){const o=H("SvgIcon"),y=H("ElTooltip"),S=H("AppSearchModal");return w(),b("div",{onClick:c[1]||(c[1]=k=>t.showModal=!0)},[p(y,{effect:"dark",content:"\u641C\u7D22",placement:"bottom-end"},{default:N(()=>[r("span",null,[p(o,{name:"search"})])]),_:1}),p(S,{onClose:c[0]||(c[0]=k=>t.showModal=!1),visible:t.showModal},null,8,["visible"])])}const Je=le(be,[["render",ye]]);export{Je as default};
