var q=Object.defineProperty,G=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var L=(t,r,d)=>r in t?q(t,r,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[r]=d,x=(t,r)=>{for(var d in r||(r={}))Q.call(r,d)&&L(t,d,r[d]);if(I)for(var d of I(r))U.call(r,d)&&L(t,d,r[d]);return t},A=(t,r)=>G(t,K(r));import{d as X,s as j,r as E,c as _,w as k,aA as Y,b as f,h,l as z,bJ as ee,aB as te,aC as Z}from"./index.61be89a1.js";import{g as W}from"./tsxHelper.e74009f7.js";import{u as se}from"./useTimeout.0d66b90d.js";const H={modelValue:{type:Boolean,default:!1},isSlot:{type:Boolean,default:!1},text:{type:String,default:"\u8BF7\u6309\u4F4F\u6ED1\u5757\u62D6\u52A8"},successText:{type:String,default:"\u9A8C\u8BC1\u901A\u8FC7"},height:{type:Number,default:40},width:{type:Number,default:220},circle:{type:Boolean,default:!1},wrapStyle:{type:Object,default:{}},contentStyle:{type:Object,default:{}},barStyle:{type:Object,default:{}},actionStyle:{type:Object,default:{}}},ne=A(x({},H),{src:{type:String},imgSize:{type:Number,default:260},imgWrapStyle:{type:Object,default:{}},minDegree:{type:Number,default:90},maxDegree:{type:Number,default:270},diffDegree:{type:Number,default:20}});var J=X({name:"BasicDragVerify",props:H,emits:["success","update:modelValue","change","start","move","end"],setup(t,{emit:r,slots:d,expose:B}){const s=j({isMoving:!1,isPassing:!1,moveDistance:0,toLeft:!1,startTime:0,endTime:0}),n=E(null),y=E(null),R=E(null),S=E(null),{prefixCls:T}=z("basic-drag-verify");document.addEventListener("mouseup",()=>{s.isMoving&&p()});const O=_(()=>{const{height:e,actionStyle:i}=t,c=`${e}px`;return x({left:0,width:c,height:c},i)}),P=_(()=>{const{height:e,width:i,circle:c,wrapStyle:a}=t,l=e,m=`${i}px`;return x({width:m,height:`${l}px`,lineHeight:`${l}px`,borderRadius:c?`${l/2}px`:0},a)}),C=_(()=>{const{height:e,circle:i,barStyle:c}=t,a=e;return x({height:`${a}px`,borderRadius:i?`${a/2}px 0 0 ${a/2}px`:0},c)}),V=_(()=>{const{height:e,width:i,contentStyle:c}=t,a=`${e}px`,l=`${i}px`;return x({height:a,width:l},c)});k(()=>s.isPassing,e=>{if(e){const{startTime:i,endTime:c}=s,a=(c-i)/1e3;r("success",{isPassing:e,time:a.toFixed(1)}),r("update:modelValue",e),r("change",e)}}),Y(()=>{s.isPassing=!!t.modelValue});function $(e){return e.pageX||e.touches[0].pageX}function o(e){if(s.isPassing)return;const i=f(S);!i||(r("start",e),s.moveDistance=$(e)-parseInt(i.style.left.replace("px",""),10),s.startTime=new Date().getTime(),s.isMoving=!0)}function u(e){const i=parseInt(e.style.width),{width:c}=t,a=c;return{offset:a-i-6,widthNum:a,actionWidth:i}}function g(e){const{isMoving:i,moveDistance:c}=s;if(i){const a=f(S),l=f(y);if(!a||!l)return;const{offset:m,widthNum:b,actionWidth:M}=u(a),w=$(e)-c;r("move",{event:e,moveDistance:c,moveX:w}),w>0&&w<=m?(a.style.left=`${w}px`,l.style.width=`${w+M/2}px`):w>m&&(a.style.left=`${b-M}px`,l.style.width=`${b-M/2}px`,t.isSlot||D())}}function v(e){const{isMoving:i,isPassing:c,moveDistance:a}=s;if(i&&!c){r("end",e);const l=f(S),m=f(y);if(!l||!m)return;const b=$(e)-a,{offset:M,widthNum:w,actionWidth:N}=u(l);b<M?t.isSlot?setTimeout(()=>{if(!t.modelValue)p();else{const F=f(R);F&&(F.style.width=`${parseInt(m.style.width)}px`)}},0):p():(l.style.left=`${w-N}px`,m.style.width=`${w-N/2}px`,D()),s.isMoving=!1}}function D(){if(t.isSlot){p();return}s.endTime=new Date().getTime(),s.isPassing=!0,s.isMoving=!1}function p(){s.isMoving=!1,s.isPassing=!1,s.moveDistance=0,s.toLeft=!1,s.startTime=0,s.endTime=0;const e=f(S),i=f(y),c=f(R);!e||!i||!c||(s.toLeft=!0,setTimeout(()=>{s.toLeft=!1,e.style.left="0",i.style.width="0"},300),c.style.width=f(V).width)}return B({resume:p}),()=>{const e=()=>{const a=[`${T}-bar`];return s.toLeft&&a.push("to-left"),h("div",{class:a,ref:y,style:f(C)},null)},i=()=>{const a=[`${T}-content`],{isPassing:l}=s,{text:m,successText:b}=t;return l&&a.push("success"),h("div",{class:a,ref:R,style:f(V)},[W(d,"text",l)||(l?b:m)])},c=()=>{const a=[`${T}-action`],{toLeft:l,isPassing:m}=s;return l&&a.push("to-left"),h("div",{class:a,onMousedown:o,onTouchstart:o,style:f(O),ref:S},[W(d,"actionIcon",m)||h(ee,{class:`${T}-action__icon`,name:`${m?"check":"doubleright"}`},null)])};return h("div",{class:T,ref:n,style:f(P),onMousemove:g,onTouchmove:g,onMouseleave:v,onMouseup:v,onTouchend:v},[e(),i(),c()])}}});var ae=X({name:"RotateDragVerify",inheritAttrs:!1,props:ne,emits:["success","change","update:modelValue"],setup(t,{emit:r,attrs:d,expose:B}){const s=E(null),n=j({showTip:!1,isPassing:!1,imgStyle:{},randomRotate:0,currentRotate:0,toOrigin:!1,startTime:0,endTime:0,draged:!1}),{prefixCls:y}=z("basic-img-verify"),R=_(()=>{const{imgWrapStyle:o,imgSize:u}=t;return x({width:`${u}px`,height:`${u}px`},o)}),S=_(()=>{const{minDegree:o,maxDegree:u}=t;return o===u?Math.floor(1+Math.random()*1)/10+1:1});function T(){n.startTime=new Date().getTime()}function O(o){n.draged=!0;const{imgSize:u,height:g,maxDegree:v}=t,{moveX:D}=o,p=Math.ceil(D/(u-g)*v*f(S));n.currentRotate=p,n.imgStyle={transform:`rotateZ(${n.randomRotate-p}deg)`}}function P(){const{minDegree:o,maxDegree:u}=t,g=Math.floor(o+Math.random()*(u-o));n.randomRotate=g,n.imgStyle={transform:`rotateZ(${g}deg)`}}function C(){const{randomRotate:o,currentRotate:u}=n,{diffDegree:g}=t;Math.abs(o-u)>=(g||20)?(n.imgStyle={transform:`rotateZ(${o}deg)`},n.toOrigin=!0,se(()=>{n.toOrigin=!1,n.showTip=!0},300)):V(),n.showTip=!0}function V(){n.isPassing=!0,n.endTime=new Date().getTime()}function $(){n.showTip=!1;const o=f(s);!o||(n.isPassing=!1,o.resume(),P())}return B({resume:$}),k(()=>n.isPassing,o=>{if(o){const{startTime:u,endTime:g}=n,v=(g-u)/1e3;r("success",{isPassing:o,time:v.toFixed(1)}),r("change",o),r("update:modelValue",o)}}),()=>{const{src:o,width:u}=t,{toOrigin:g,isPassing:v,startTime:D,endTime:p}=n,e=[];g&&e.push("to-origin");const i=(p-D)/1e3;return h("div",{class:`${y}`},[h("div",{class:`${y}-img__wrap`,style:f(R)},[h("img",{src:o,onLoad:P,width:u,class:e,style:n.imgStyle,onClick:()=>{$()},alt:"verify"},null),n.showTip&&h("span",{class:[`${y}-img__tip`,n.isPassing?"success":"error"]},[n.isPassing?`\u9A8C\u8BC1\u6821\u9A8C\u6210\u529F,\u8017\u65F6${i.toFixed(1)}\u79D2\uFF01`:"\u9A8C\u8BC1\u5931\u8D25\uFF01"]),!n.showTip&&!n.draged&&h("span",{class:[`${y}-img__tip`,"normal"]},["\u70B9\u51FB\u56FE\u7247\u53EF\u5237\u65B0"])]),h(J,te({class:`${y}-drag__bar`,onMove:O,onEnd:C,onStart:T,ref:s},x(x({},d),t),{modelValue:v,isSlot:!0}),null)])}}});const le=Z(J),ue=Z(ae);export{le as B,ue as R};
