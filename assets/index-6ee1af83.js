var se=Object.defineProperty,ae=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var Y=(e,t,l)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,g=(e,t)=>{for(var l in t||(t={}))ie.call(t,l)&&Y(e,l,t[l]);if(X)for(var l of X(t))ce.call(t,l)&&Y(e,l,t[l]);return e},R=(e,t)=>ae(e,re(t));var _=(e,t,l)=>new Promise((d,u)=>{var i=o=>{try{n(l.next(o))}catch(a){u(a)}},s=o=>{try{n(l.throw(o))}catch(a){u(a)}},n=o=>o.done?d(o.value):Promise.resolve(o.value).then(i,s);n((l=l.apply(e,t)).next())});import{w as ue,_ as z,q as de,s as fe,b as pe,U as N,V as he,I as ge}from"./index-795cdaa0.js";import{c as me}from"./index-e82f403d.js";import{B as Ce}from"./index-9c67be75.js";import{w as ye,a5 as Be,aB as Me,n as ve,o as be,an as $e,a4 as He}from"./elementui-66980f2a.js";import{E as K,ac as v,p as y,q as S,S as w,J as C,R as A,P as L,Q as U,F as M,t as G,I as H,O as D,L as I,r as m,f as $,u as c,b as J,w as x,n as V,ap as ke,K as we,Z as Ve,g as Q,ai as Te,G as F,W as ee,a8 as O,a as Fe}from"./vue-d691a816.js";import{u as Se}from"./useWindowSizeFn-f51aba85.js";import{S as Pe}from"./index-22989de9.js";const ne={showClose:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},helpMessage:{type:[String,Array],default:""}},oe={dyncHeight:{type:Boolean,default:!0},loading:Boolean,loadingText:{type:String,default:"加载中..."}},Ee={showConfirmBtn:{type:Boolean,default:!0},confirmOptions:{type:Object,default:{btnText:"确定",type:"primary"}},showCancelBtn:{type:Boolean,default:!0},cancelOptions:{type:Object,default:{btnText:"取消",type:"default"}}},te=R(g(g(g({modelValue:Boolean},ne),oe),Ee),{showFooter:{type:Boolean,default:!0},scrollTop:{type:Boolean,default:!0},closeFn:Function}),Re=R(g(g({},me),te),{appendToBody:{type:Boolean,default:!0},onOpen:Function,onOpened:Function,onClose:Function,onClosed:Function}),_e=K({name:"BasicModalHeader",components:{ElTooltip:ye,BasicTitle:Ce,SvgIcon:ue},inheritAttrs:!1,props:g({fullscreen:Boolean,prefixCls:String,title:String},ne),emits:["cancel","fullscreen"],setup(e,{emit:t}){function l(i){e.showFullscreen&&(i.stopPropagation(),u(i))}function d(i){t("cancel",i)}function u(i){i==null||i.stopPropagation(),i==null||i.preventDefault(),t("fullscreen")}return{handleCancel:d,handleFullscreen:u,handleTitleDbClick:l}}});function Oe(e,t,l,d,u,i){const s=v("BasicTitle"),n=v("SvgIcon"),o=v("ElTooltip");return y(),S("div",{class:I(e.prefixCls),onDblclick:t[0]||(t[0]=(...a)=>e.handleTitleDbClick&&e.handleTitleDbClick(...a))},[w(s,{helpMessage:e.helpMessage},{default:C(()=>[e.title?(y(),S(A,{key:0},[L(U(e.title),1)],64)):M(e.$slots,"header",{key:1})]),_:3},8,["helpMessage"]),G("div",{class:I(`${e.prefixCls}__extra`)},[e.showFullscreen?(y(),S(A,{key:0},[e.fullscreen?(y(),H(o,{key:0,content:"还原",placement:"bottom"},{default:C(()=>[w(n,{onClick:e.handleFullscreen,name:"shrink"},null,8,["onClick"])]),_:1})):(y(),H(o,{key:1,content:"最大化",placement:"bottom"},{default:C(()=>[w(n,{onClick:e.handleFullscreen,name:"arrowsalt"},null,8,["onClick"])]),_:1}))],64)):D("",!0),e.showClose?(y(),H(o,{key:1,content:"关闭",placement:"bottom"},{default:C(()=>[w(n,{onClick:e.handleCancel,name:"close"},null,8,["onClick"])]),_:1})):D("",!0)],2)],34)}const De=z(_e,[["render",Oe]]),le=Symbol();function Ie(e){return de(e,le)}function nn(){return fe(le)}const We=K({name:"ModalWrapper",components:{ScrollContainer:Pe},directives:{loading:Be.directive},inheritAttrs:!1,props:g({modelValue:Boolean,fullscreen:Boolean,prefixCls:String},oe),emits:["height-change"],setup(e,{emit:t}){const l=m(null),d=m(null),u=m(null),i=m(0),s=$(()=>{const{dyncHeight:a}=e;return a?{height:`${c(i)}px`}:{height:"auto",padding:"1rem"}});function n(){return _(this,null,function*(){V(()=>{var h;const a=c(l);a&&((h=a==null?void 0:a.scrollTo)==null||h.call(a,0))})})}function o(){return _(this,null,function*(){var T,E;if(!e.modelValue||!e.dyncHeight)return;const a=c(d);if(!a)return;yield V();const h=a.parentElement;if(!h)return;const p=c(u);if(!p)return;const P=(p==null?void 0:p.clientHeight)||0;yield V();try{const b=h.parentElement;if(!b)return;const W=((T=b.querySelector(".el-dialog__header"))==null?void 0:T.clientHeight)||0,q=((E=b.querySelector(".el-dialog__footer"))==null?void 0:E.clientHeight)||0,r=b.offsetTop;let f=window.innerHeight-r*2-q-W;P<f&&(f=P),i.value=f>100?f:100,t("height-change",c(i))}catch(b){}})}return Se(o.bind(null,!1)),Ie({redoModalHeight:o}),J(()=>{e.dyncHeight&&o()}),x(()=>e.fullscreen,()=>{o()}),{wrapperRef:l,spinRef:d,innerRef:u,spinStyle:s,scrollTop:n,setModalHeight:o}}}),qe=["element-loading-text"],Ne={ref:"innerRef"};function Ae(e,t,l,d,u,i){const s=v("ScrollContainer"),n=ke("loading");return we((y(),S("div",{ref:"spinRef",style:Ve(e.spinStyle),"element-loading-text":e.loadingText},[e.dyncHeight?(y(),H(s,{key:0,ref:"wrapperRef",class:I(e.prefixCls)},{default:C(()=>[G("div",Ne,[M(e.$slots,"default")],512)]),_:3},8,["class"])):M(e.$slots,"default",{key:1})],12,qe)),[[n,e.loading]])}const Le=z(We,[["render",Ae]]),Ue=K({name:"BasicModal",components:{ElDialog:Me,ElButton:ve,ModalWrapper:Le,ModalHeader:De},inheritAttrs:!1,props:Re,emits:["visible-change","height-change","cancel","confirm","register","update:modelValue"],setup(e,{emit:t}){const l=m(!1),d=m(null),u=m(null),{prefixCls:i}=pe("basic-modal"),s=m(!1),n={setModalProps:T,emitVisible:void 0,redoModalHeight:()=>{V(()=>{c(u)&&c(u).setModalHeight()})}},o=Q();o&&t("register",n,o.uid);const a=$(()=>g(g({},e),c(d))),h=$(()=>{const r=R(g({},c(a)),{fullscreen:c(s)}),f=`${i} ${(r==null?void 0:r.customClass)||""} ${i}-${o==null?void 0:o.uid}`;r.class=f,r.customClass=f;const B=Object.keys(te);return be(r,B)}),p=$(()=>{const{showFullscreen:r,showClose:f,helpMessage:B,title:Z}=c(a);return{title:Z,showFullscreen:r,showClose:f,helpMessage:B,fullscreen:c(s),prefixCls:`${i}-header`}}),P=$(()=>{const{dyncHeight:r,loading:f,loadingText:B}=c(a);return{dyncHeight:r,loading:f,loadingText:B,fullscreen:c(s),modelValue:c(l),prefixCls:`${i}__body`}});function T(r){d.value=g(g({},c(d)),r),Reflect.has(r,"modelValue")&&(l.value=!!r.modelValue),Reflect.has(r,"fullscreen")&&(s.value=!!r.fullscreen)}function E(r){return _(this,null,function*(){r==null||r.stopPropagation();const{closeFn:f}=c(a);if(typeof f=="function"){const B=yield f();l.value=!B;return}else l.value=!1;t("cancel",r)})}function b(r){t("confirm",r)}function W(r){t("height-change",r)}function q(){T({fullscreen:!c(s)})}return J(()=>{l.value=!!e.modelValue,s.value=!!e.fullscreen}),x(()=>c(l),r=>{var f;t("visible-change",r),t("update:modelValue",r),o&&((f=n.emitVisible)==null||f.call(n,r,o.uid)),V(()=>{var B;e!=null&&e.scrollTop&&r&&c(u)&&((B=c(u))==null||B.scrollTop(0))})},{immediate:!1}),{prefixCls:i,getBindValues:h,getHeaderBindValues:p,getWrapperBindValue:P,visibleRef:l,fullscreenRef:s,getProps:a,modalWrapperRef:u,handleFullscreen:q,handleCancel:E,handleConfirm:b,handleHeightChange:W}}});function je(e,t,l,d,u,i){const s=v("ModalHeader"),n=v("ModalWrapper"),o=v("ElButton"),a=v("ElDialog");return y(),H(a,F(e.getBindValues,{showClose:!1,modelValue:e.visibleRef,"onUpdate:modelValue":t[0]||(t[0]=h=>e.visibleRef=h)}),Te({header:C(()=>[w(s,F(e.getHeaderBindValues,{onFullscreen:e.handleFullscreen,onCancel:e.handleCancel}),{header:C(()=>[M(e.$slots,"header")]),_:3},16,["onFullscreen","onCancel"])]),default:C(()=>[w(n,F({ref:"modalWrapperRef"},e.getWrapperBindValue,{onHeightChange:e.handleHeightChange}),{default:C(()=>[M(e.$slots,"default")]),_:3},16,["onHeightChange"])]),_:2},[e.showFooter?{name:"footer",fn:C(()=>{var h;return[G("div",{class:I(`${e.prefixCls}-footer`)},[e.$slots.footer?M(e.$slots,"footer",{key:0}):(y(),S(A,{key:1},[M(e.$slots,"prependFooter"),e.showCancelBtn?(y(),H(o,F({key:0},e.cancelOptions,{onClick:e.handleCancel}),{default:C(()=>{var p;return[L(U(((p=e.cancelOptions)==null?void 0:p.btnText)||"Cancel"),1)]}),_:1},16,["onClick"])):D("",!0),M(e.$slots,"centerFooter"),e.showConfirmBtn?(y(),H(o,F({key:1},e.confirmOptions,{loading:(h=e.getProps.confirmOptions)==null?void 0:h.loading,onClick:e.handleConfirm}),{default:C(()=>{var p;return[L(U(((p=e.confirmOptions)==null?void 0:p.btnText)||"OK"),1)]}),_:1},16,["loading","onClick"])):D("",!0),M(e.$slots,"appendFooter")],64))],2)]}),key:"0"}:void 0]),1040,["modelValue"])}const ze=z(Ue,[["render",je]]),k=ee({}),j=ee({});function on(){const e=m(null),t=m(!1),l=m("");function d(s,n){Q()||N("useModal() can only be used inside setup() or functional components!"),l.value=n,Fe(()=>{e.value=null,t.value=!1,k[c(l)]=null}),!(c(t)&&he()&&s===c(e))&&(e.value=s,t.value=!0,s.emitVisible=(o,a)=>{j[a]=o})}const u=()=>{const s=c(e);return s||N("The modal instance has not been obtained, please make sure the instance is rendered when performing the instance operation!"),s},i={setModalProps:s=>{var n;(n=u())==null||n.setModalProps(s)},getVisible:$(()=>j[~~c(l)]),redoModalHeight:()=>{var s,n;(n=(s=u())==null?void 0:s.redoModalHeight)==null||n.call(s)},openModal:(s=!0,n,o=!0)=>{var p;if((p=u())==null||p.setModalProps({modelValue:s}),!n)return;const a=c(l);if(o){k[a]=null,k[a]=O(n);return}$e(O(k[a]),O(n))||(k[a]=O(n))},closeModal:()=>{var s;(s=u())==null||s.setModalProps({modelValue:!1})}};return[d,i]}const tn=e=>{const t=m(null),l=Q(),d=m(""),u=()=>{const n=c(t);return n||N("useModalInner instance is undefined!"),n},i=(n,o)=>{He(()=>{t.value=null}),d.value=o,t.value=n,l==null||l.emit("register",n,o)},s={changeLoading:(n=!0)=>{var o;(o=u())==null||o.setModalProps({loading:n})},getVisible:$(()=>j[~~c(d)]),changeConfirmLoading:(n=!0)=>{var o;(o=u())==null||o.setModalProps({confirmButton:{loading:n}})},closeModal:()=>{var n;(n=u())==null||n.setModalProps({modelValue:!1})},setModalProps:n=>{var o;(o=u())==null||o.setModalProps(n)},redoModalHeight:()=>{var o;const n=(o=u())==null?void 0:o.redoModalHeight;n&&n()}};return J(()=>{const n=k[c(d)];n&&(!e||typeof e!="function"||V(()=>{e(n)}))}),[i,s]},ln=ge(ze);export{ln as B,on as a,tn as b,nn as u};
