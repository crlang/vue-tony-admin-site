var S=(x,o,r)=>new Promise((m,d)=>{var c=a=>{try{u(r.next(a))}catch(i){d(i)}},f=a=>{try{u(r.throw(a))}catch(i){d(i)}},u=a=>a.done?m(a.value):Promise.resolve(a.value).then(c,f);u((r=r.apply(x,o)).next())});import{y as h,a as g,_ as C,l as F,u as e,I as D,J as I,z as N,G as B,H as l,R as t,a9 as M,P as y,Q as w,ak as T}from"./ex-pkg-@vue.dfd8e273.js";import{e as U,f as z,h as G}from"./index.b3c9ad7f.js";import{u as K,a as P,L as E,b as $}from"./useLogin.3e155596.js";import{C as j,D as k,z as V,F as O,u as _,y as A,G as H}from"./ex-pkg-element-plus.1726aa79.js";import"./ex-pkg-vendor.002cab22.js";import"./ex-pkg-mockjs.d050e972.js";import"./ex-pkg-@element-plus.3c8245e2.js";import"./ex-pkg-@vueuse.e5d644bd.js";import"./ex-pkg-@iconify.345c6dc9.js";import"./ex-pkg-@popperjs.f3a17871.js";const te=h({setup(x){const{t:o}=U(),{notification:r}=z(),m=G(),{setLoginState:d,getLoginState:c}=K(),{getFormRules:f}=P(),u=g(),a=g(!1),i=g(!1),n=C({account:"",password:""}),{validForm:b}=$(u),R=F(()=>e(c)===E.LOGIN);function v(){return S(this,null,function*(){if(!!(yield b()))try{a.value=!0;const s=yield m.login(T({password:n.password,username:n.account,mode:"none"}));s&&r.success({title:o("sys.login.loginSuccessTitle"),message:`${o("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3e3})}catch(s){r.error({title:o("sys.api.errorTip"),message:s.message||o("sys.api.networkExceptionMsg")})}finally{a.value=!1}})}return(L,s)=>D((N(),B(e(H),{model:e(n),rules:e(f),ref_key:"formRef",ref:u},{default:l(()=>[t(e(k),{prop:"account"},{default:l(()=>[t(e(j),{modelValue:e(n).account,"onUpdate:modelValue":s[0]||(s[0]=p=>e(n).account=p),placeholder:e(o)("sys.login.userNameEg")},null,8,["modelValue","placeholder"])]),_:1}),t(e(k),{prop:"password",class:"mb-1"},{default:l(()=>[t(e(j),{modelValue:e(n).password,"onUpdate:modelValue":s[1]||(s[1]=p=>e(n).password=p),placeholder:e(o)("sys.login.passwordEg"),onKeypress:M(v,["enter"])},null,8,["modelValue","placeholder","onKeypress"])]),_:1}),t(e(A),{class:"mt-3"},{default:l(()=>[t(e(V),{span:12},{default:l(()=>[t(e(O),{modelValue:i.value,"onUpdate:modelValue":s[2]||(s[2]=p=>i.value=p),size:"small"},{default:l(()=>[y(w(e(o)("sys.login.rememberMe")),1)]),_:1},8,["modelValue"])]),_:1}),t(e(V),{span:12,class:"text-right"},{default:l(()=>[t(e(_),{type:"text",onClick:s[3]||(s[3]=p=>e(d)(e(E).RESET_PASSWORD))},{default:l(()=>[y(w(e(o)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1}),t(e(k),null,{default:l(()=>[t(e(_),{type:"primary",class:"login--submit",loading:a.value,onClick:v},{default:l(()=>[y(w(e(o)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])),[[I,e(R)]])}});export{te as default};
